apiVersion: v1
kind: Secret
metadata:
  name: rocky-ssh
type: Opaque
data:
  authorized_keys: c3NoLXJzYSBBQUFBQjNOemFDMXljMkVBQUFBREFRQUJBQUFCQVFDdG1yQmZPRkxGOHRVQnlaTU5iUmtoQ3FyTHhQc2NJMUlBdnYvd2pKdXN0REVzdm40VzBXeHg3VUlzU0doQmJSa0JFM3BNanlOSnlseXFsa0ZpeHQ5b25HVGRTVk1kTnVBeEhTVHFWN241QjRaWFhtdVNUR25sMkRTS1lnT1NsZUNwYWtBSzE1VEJDbFBtMWFCMGMzUmh2c2Q2aXlNZlREOU1LR1hFTml0cG9rVG9PMFhTSk1VL25qcUVraEpjd1hUR0hYenRwaXRxc1ZuWEkvNEJVWXlhNlpZc21LQVNGd2FQbXBqdmpySThWMmVWVFM5YmFqRGg3QXA4WFM5ZDk2TlFZcUNVMkl1dGFZZXFNNy8wUzlWL2FDR2szTStLNXVsVkVwd2I1YnUyZmpkMUdURzBXYURQZHhaMThEYlhCWkVZcDJ3TmdZcHRSeDhEL0FNMzloVFQ=
---
apiVersion: v1
kind: Secret
metadata:
  name: rocky-kubectl
type: Opaque
data:
  config: YXBpVmVyc2lvbjogdjEKY2x1c3RlcnM6Ci0gY2x1c3RlcjoKICAgIGNlcnRpZmljYXRlLWF1dGhvcml0eS1kYXRhOiBMUzB0TFMxQ1JVZEpUaUJEUlZKVVNVWkpRMEZVUlMwdExTMHRDazFKU1VNMWVrTkRRV01yWjBGM1NVSkJaMGxDUVVSQlRrSm5hM0ZvYTJsSE9YY3dRa0ZSYzBaQlJFRldUVkpOZDBWUldVUldVVkZFUlhkd2NtUlhTbXdLWTIwMWJHUkhWbnBOUWpSWVJGUkplRTFVUlhoT1ZFRTFUVlJuTUUxV2IxaEVWRTE0VFZSRmVFMTZRVFZOVkdjd1RWWnZkMFpVUlZSTlFrVkhRVEZWUlFwQmVFMUxZVE5XYVZwWVNuVmFXRkpzWTNwRFEwRlRTWGRFVVZsS1MyOWFTV2gyWTA1QlVVVkNRbEZCUkdkblJWQkJSRU5EUVZGdlEyZG5SVUpCUzFsSENtVnhXVkppVkZWdlpVaHhaVkpsVjJObVlXazVSV0ZTVjBjclZFOHphWEJRUm1KTmFESlpRbTQzTUhOb05tODBkVmRtU0dSSk1VaGliVnB2YVU1SFVqWUtSRmx3UzNkUWJtSlRjbGxCVjJaV1VWWnlMM0pWYm5od1QwSXpNblpyU1daQlZuSTFVa2hvUWxjNFExUm5MM2wwVEZGR1JVMW5jRU5HUXk5eFNtSnJWd3BUSzB4dmFUWjZORmxSV0V0NmFYSnRlSGhwVG01ck1HazJjMlZWTW1aVlp5dGtjMGhrTDFkeWRWUnBOM2R3VW5sS056Vk9NbTlLYlZaMFkwcGtRMDFXQ25sTldWSXdUM2N3VkRjeVkwRkhOM0pZVFRaeVJVbHhhV3hLUXpkc1ZDdFBkbkpCTDB4NGJpOWpORzVzYUd0MlF6SlBLM1JqTVZWclJ6QkxTa3RrYlZFS1JUbHVSRTVWY0c1aFQxcHVVakpOYW10bk1GUktZbGhRUm1aelFTOVNPRzlNVURJd1JVaFpSbTkzTlhGclltcFhhVzR6VG1Od1ZVZFFRbmxvTW1oSllRcFRTRFpvT1VaNloyMW9hMGRIU1hFMGNWRkZRMEYzUlVGQllVNURUVVZCZDBSbldVUldVakJRUVZGSUwwSkJVVVJCWjB0clRVRTRSMEV4VldSRmQwVkNDaTkzVVVaTlFVMUNRV1k0ZDBoUldVUldVakJQUWtKWlJVWkhNMGsyUkRsYVFVZGxMMjRyYUd0a2FEbDFXVEpQVTBWWGVpOU5RVEJIUTFOeFIxTkpZak1LUkZGRlFrTjNWVUZCTkVsQ1FWRkNLMkZOY1VoQ1kzZE9TV1VyVWk4d2RrOXBSM3B0TWxGa2VXNUhkRU56WlVOck5DOVVRVGxDYjJvclEwVTVOMUJFU1FwTU1WaHNUM2syYTNsa1JtVnllWGhZYmpCdWVWQlRjWEJOT0U0MGN5czNWMHN2YWs5SGVrOVhlR0ZPYml0a05HRXlaaTk2V2xSUVJsUkNNR28wWVVKTUNtVnFSSGhYYlhSWWFsaFdWRmQ0SzJ0bFFtMUliRVYzYml0T2VFbzBZV05CUWtKVVRGZDFXa3ByVDBvNFRXRjRVME5SUmpaaU1YcGtXbU5EZEdGRWRXMEtkMUF3TjBSWFRGQndXbWRQTjJOMFRVbHFZekZRTjJSNFFtMTRNMjVoZUVSRk9ISTJaRmg2TWpCb2RVdEZNbTV3WkU5UGFtWk9SSEJXV0haT05WSlZhQXBZTlRabU5qaFpkR040Vm5WbWRXUmlLMHBsVDFSclNXNWtXWGR3VEhwdmJuRmpkVWRoTUc1bmEwNXpSbUUxZVZoMVpreGhVV2hNV25FNGFtTlNWbWhVQ21WNk5ubEVTRlJFYVZCMFduSTBaMmcyS3l0T1FrTTJWbWRuYW14U1ozTjVXWGNyVXdvdExTMHRMVVZPUkNCRFJWSlVTVVpKUTBGVVJTMHRMUzB0Q2c9PQogICAgc2VydmVyOiBodHRwczovLzEwLjIzMC43LjEwOjY0NDMKICBuYW1lOiBrdWJlcm5ldGVzCmNvbnRleHRzOgotIGNvbnRleHQ6CiAgICBjbHVzdGVyOiBrdWJlcm5ldGVzCiAgICB1c2VyOiBrdWJlcm5ldGVzLWFkbWluCiAgbmFtZToga3ViZXJuZXRlcy1hZG1pbkBrdWJlcm5ldGVzCmN1cnJlbnQtY29udGV4dDoga3ViZXJuZXRlcy1hZG1pbkBrdWJlcm5ldGVzCmtpbmQ6IENvbmZpZwpwcmVmZXJlbmNlczoge30KdXNlcnM6Ci0gbmFtZToga3ViZXJuZXRlcy1hZG1pbgogIHVzZXI6CiAgICBjbGllbnQtY2VydGlmaWNhdGUtZGF0YTogTFMwdExTMUNSVWRKVGlCRFJWSlVTVVpKUTBGVVJTMHRMUzB0Q2sxSlNVUkpWRU5EUVdkdFowRjNTVUpCWjBsSlltSXpVR0V6VEdGc2VVbDNSRkZaU2t0dldrbG9kbU5PUVZGRlRFSlJRWGRHVkVWVVRVSkZSMEV4VlVVS1FYaE5TMkV6Vm1sYVdFcDFXbGhTYkdONlFXVkdkekI1VFZSRmVFMVVWWGRQVkVVMFRrUkdZVVozTUhwTlZFVjRUVlJOZDA5VVJUUk9SRkpoVFVSUmVBcEdla0ZXUW1kT1ZrSkJiMVJFYms0MVl6TlNiR0pVY0hSWldFNHdXbGhLZWsxU2EzZEdkMWxFVmxGUlJFVjRRbkprVjBwc1kyMDFiR1JIVm5wTVYwWnJDbUpYYkhWTlNVbENTV3BCVGtKbmEzRm9hMmxIT1hjd1FrRlJSVVpCUVU5RFFWRTRRVTFKU1VKRFowdERRVkZGUVhkS2VUZ3pRUzlqVjFBMVRVczRVMWtLTW01WFlYVmtTbEJPYXpJcmFreEZjR3RvTDNsaFkyeHNhM1ZWU0VOMUx6SnlhbHB4YVRoNmFsbE5hQ3QzSzFjM1dGTkxSVUlyY2xFelRtWjBNVGR5Wmdwek9WSmtLMHQ1ZDFwNWNqaDFWSHBTVjJGTFZubDNjVGRQYm1aT1EwMUtRa1J0YUVSUmVYWm1ka0kwU2xobGIwZERXVTlzWkhKd05rVnJkV3RLUVU4ckNsaEllR1J2Tmtrd05rMWlXV3BDWWxOWU1pdHNVVTlIYWpoaU9WaERVbWRxY1ZkRVVIaFZaRGxyYnpVMlkyeEdOMjAwZUNzNFltaFpNVnBXVTFGV05tb0tUWEY0VFU1a1dtSk9NSGh2ZWpaWVJqVnhXa3RtVURKcllUVXplWE5WZFVFMFNIQjVObEJHZFRCVmQweFNObXA0YmtsM2RIbFNWSEp6Y1hveEwydGhTUXA2VG5Cc1YwcGpSbHAxZW5admMxQm9iak15WTNGT1ptVTNkVzh3Tm5SNFZXTldabmxhZG10eWNVVlpTa2hYT0UxVlYxTmFkbUZvV1doUVJFdzFTeXRJQ2tGQlZXdGxVVWxFUVZGQlFtOHhXWGRXUkVGUFFtZE9Wa2hST0VKQlpqaEZRa0ZOUTBKaFFYZEZkMWxFVmxJd2JFSkJkM2REWjFsSlMzZFpRa0pSVlVnS1FYZEpkMFJCV1VSV1VqQlVRVkZJTDBKQlNYZEJSRUZtUW1kT1ZraFRUVVZIUkVGWFowSlNkSGxQWnk5WFVVSnVkalV2YjFwSVdXWmliVTVxYTJoR2N3b3Zla0ZPUW1kcmNXaHJhVWM1ZHpCQ1FWRnpSa0ZCVDBOQlVVVkJWbnBHUnpOaWJIZExlbW8wUmpScmVITTFWRVk1VkZWMk5IRlZSbEV4WVRkRldEUlVDalpGV0U5VVdTdEpSbmh0Vm0xVVowcGhXV3hMYkdWUlUxQnZSR2x5UWpsT2VXUmFWbmRUWmxjNFJrOHhTekpLY0RNemNYRk1PVVpOU25CM2RFOWxUR3NLZDNCeFpEWTVNbmxYV1VWd04wMTZXVmg1VVcxUk1IaG5abUY2ZFZWNE5YRk5SRGRGYlZFNGJubzVWelJJYkd4VksyTjJSVE5MYm5kaE1GbzRaRmt4VEFwWlUwaG5RVzVLZEZOemFYY3dTM0IzYjJZMlpubDVTV2RyYUVoeFJEVktTMnRDZUc4MFVubDBSVU5STUdsclVIVTRVemN5WkVOMVRsTlVSVlprZDBOR0NrTTBVRXQ2UzNSRlEyODJkRkUwTWxoWkswNUpOamxTTDJoUlRXY3hXbTlMWTFCV1pEVkpTbGhVVjJ4bFkxVlFOVVpIUlhWcFZWUnROU3RpY3l0R2EwZ0tOVms0Wm1GMGFFTnViekpvVEN0RWRXb3ljMEpoZUhwUWQydERaWFZLZVZoSmRHb3ZlR3hvYzNCcU5rMTBaa0pITjNjOVBRb3RMUzB0TFVWT1JDQkRSVkpVU1VaSlEwRlVSUzB0TFMwdENnPT0KICAgIGNsaWVudC1rZXktZGF0YTogTFMwdExTMUNSVWRKVGlCU1UwRWdVRkpKVmtGVVJTQkxSVmt0TFMwdExRcE5TVWxGY0ZGSlFrRkJTME5CVVVWQmQwcDVPRE5CTDJOWFVEVk5TemhUV1RKdVYyRjFaRXBRVG1zeUsycE1SWEJyYUM5NVlXTnNiR3QxVlVoRGRTOHlDbkpxV25GcE9IcHFXVTFvSzNjclZ6ZFlVMHRGUWl0eVVUTk9ablF4TjNKbWN6bFNaQ3RMZVhkYWVYSTRkVlI2VWxkaFMxWjVkM0UzVDI1bVRrTk5Ta0lLUkcxb1JGRjVkbVoyUWpSS1dHVnZSME5aVDJ4a2NuQTJSV3QxYTBwQlR5dFlTSGhrYnpaSk1EWk5ZbGxxUW1KVFdESXJiRkZQUjJvNFlqbFlRMUpuYWdweFYwUlFlRlZrT1d0dk5UWmpiRVkzYlRSNEt6aGlhRmt4V2xaVFVWWTJhazF4ZUUxT1pGcGlUakI0YjNvMldFWTFjVnBMWmxBeWEyRTFNM2x6VlhWQkNqUkljSGsyVUVaMU1GVjNURkkyYW5odVNYZDBlVkpVY25OeGVqRXZhMkZKZWs1d2JGZEtZMFphZFhwMmIzTlFhRzR6TW1OeFRtWmxOM1Z2TURaMGVGVUtZMVptZVZwMmEzSnhSVmxLU0ZjNFRWVlhVMXAyWVdoWmFGQkVURFZMSzBoQlFWVnJaVkZKUkVGUlFVSkJiMGxDUVZGRGEweHFXbEozYm1SS2NVZElXQXBSVUc5c05VODRhR2tyU1ZoWlRXVlhPVFJDS3pOU2NIVkVPSGt3U0U5TlZ6aEtjWFIyZUdGek1tUllUR0p5ZFZoVmFVTlhZamxDY0ZNd1FVUnlNRGdyQ21aNk1HdzVWbE4zYm5OeGVUbG9TamM1ZUhCblRrWldTWGRJYmpscFdtSk5OalJCTW5aeGNuVXJPWFl6V25kalJ6bFhPVEU1Y2tFME9YaFZUWFZWZEU0S2J6VTVSa05KUm5NNVRuWjVkVEpTYTJKVFQyWlZMMUpvZWt4U1NsbENkR1pMVTFwNmNqRk9aM04yTlVkc2NERlZMemhaZDBkbVpYZ3lXa1Z6UmsxV01ncERRMFZGZVN0UGFuWlBjSEJCT1M5cGMwWmtiMFpJZUdac2NuZEhibk5zYkZadlFVNU1hRFp5U21aS1VUVm9WVzByTm1VNFdsZE9UVlJKYTNoNmNGVTFDaloyVm5SaE5tcGpTRnBXV2tKUVZFUm1TRFpNUkN0WlpXcFpUMVpqYW5KR1NGaDNUVGxTYld4TE4yUXpRV1pvV1dkd2MxSk5jemwyYm5sQ2JrRnRTR1FLVFZSVWRGaE1VWGhCYjBkQ1FVMDRha1FyZUdGamNqbEZSbkpLUTBoUldHUnFZMjQwU1VaMGFrbzJhMVZOTVVwMlVFdFBjR1p0SzJkMEt5czNkMHRUT1FwcVZXVmxialJpUVVkYVZXSlBNQzlxUjNOTVNuQTBXRkZLYXpGeWFqZFllSEJhZDA5cU9IVnJiRTE1U0djMVFrcGlWM1ZtU0VOMGFrWjZkQzgxTkVsWUNqbEhlVEY2U1ZwVmVsSlVjRVZWV1hsak4zRXdiSFJpYVZjeWFXYzRkelJ4Tm5GWlRVcG9jblZETDBKa2JDOXJVR1pUUTNJMlpWbE9RVzlIUWtGUE5FMEthVWhXWVdWeE1rc3pUMUZKTnpac2FWVllhVVJCYW01U0swWlFVamhrYlROcmREVk9hVzlXU0hoQ1MweENVek5IYm14dlRXdEJWMUpNTkhZNE1rUnVNZ3BzYW5WRVZFZzNRVVE0VW1oTk5URlpOVGxLUWpGNFZVUmxOM0V3TVhOaVdIQkxjM1EwUTFaVlRucHRZMVpRY1dKcE5GUlpSMlk0Y21wdFRtZFpUbVp5Q21wbFUzWk5jbmhvYkdKM1YxVlJhMlJYWmtZMllsSjVWV2R5Y25aRmNtc3pkMWREYkRWcGEyUkJiMGRCWVhkallqWkRNVWxGZVc5VllrTkZZa3N2WlhnS2JITldaSFZ5Y1N0UFNFRlhiMHRoV0dRMU1WSnNhelFyU0VkSmQwSlRPVzlQTjFKeWFUQXphRXRvYXpkRFYyczBXRFpQWjNGMFZFWndZMVpLUzFkTWJRcENiaTlFY25nMmIxRkNTbHBYV1cxSVVEQXJhMVkwY2trMk1XRkpaMk5FY3pZcmNqTTVaMVZHVUhGUE5qWkZSMVJoVFhBNVJXbFZPWGhCT0RrMU0ydHVDbUUwY214bFdUWTRibTlPVG5wclVrSnFSWE51TDFaVlEyZFpSVUZ3YWt4b05IVXdNREJaTUhWQk5XVndia0l3YTNaSWNtSlNkbk4wTkZobGJUTXhZVzRLYkRoWFZHWk9Ta3RPY0dkU1IxcERaVnByYUROR1UzWXdaMnQzV25WMk5VdHFWM0I1VFdSNGRVcGlSMjVyTm1aTE1IRldaRkZVUzFwYVFsWXlSRzlZYndwV1ozUkdaakJ3TkRsRFVVNTNTbkIzYjIxTmRWa3hWa3B4UjBKV2RrOXhZM1Z3YTBoV2VtSmhhaXROVlRKTlVrSlZOMDFwUlhRMGRFWTROWEY1UWpSQ0NsTlVWVXR4U2tWRFoxbEZRWFJHV1VVM1FVUlFUMjFuV21SUFEwUnpVMGhUVVU4emJtSnFZM3B3VVhSSk1ETnhialJYV0dSdmRWcEJjbGd3T0dsVlMzY0tVR3N5YVVaMVZYbExaM2hwWW5Wa0wwbzBiR1ExZFRObWFYWjVlV2N5VW5vNVJWRmFORmhuTVVGQmJHSkhja1JCY0RONVJHTXpibGQwVDJSeE1EUlllUXBIUW1sTmNWWkNNVnBxTDJKelZVeDNjV1JyY0ZBdmVsbG5iRGRhUVhGeWRYQk5jVkJMVEZaT2FFUTFlRk5XU1ZVelZuQlRXa3RWUFFvdExTMHRMVVZPUkNCU1UwRWdVRkpKVmtGVVJTQkxSVmt0TFMwdExRbz0=
---
apiVersion: v1
kind: Service
metadata:
  name: rocky-ssh-service
  labels:
    name: rocky-ssh
spec:
  type: NodePort
  ports:
    - name: rocky-ssh
      port: 22
      targetPort: 22
      nodePort: 30022
  selector:
    name: rocky-ssh
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: rocky-ssh
spec:
  replicas: 1
  strategy:
    type: RollingUpdate
  selector:
    matchLabels:
      name: rocky-ssh
  template:
    metadata:
      labels:
        name: rocky-ssh
    spec:
      volumes:
        - name: ssh
          secret:
            secretName: rocky-ssh
            defaultMode: 384
        - name: kubectl
          secret:
            secretName: rocky-kubectl
            defaultMode: 384
      containers:
        - name: rocky-ssh
          image: sjwayrhz/rocky-8.4:kubectl
          imagePullPolicy: IfNotPresent
          volumeMounts:
            - name: ssh
              mountPath: "/root/.ssh/authorized_keys"
              subPath: authorized_keys
              readOnly: true
            - name: kubectl
              mountPath: "/root/.kube/config"
              subPath: config
              readOnly: true
          resources:
            requests:
              memory: "512Mi"
              cpu: "500m"
            limits:
              memory: "1Gi"
              cpu: "1000m"
          ports:
            - containerPort: 22