apiVersion: v1
kind: Secret
metadata:
  name: rocky-ssh
type: Opaque
data:
  authorized_keys: c3NoLXJzYSBBQUFBQjNOemFDMXljMkVBQUFBREFRQUJBQUFCQVFDdG1yQmZPRkxGOHRVQnlaTU5iUmtoQ3FyTHhQc2NJMUlBdnYvd2pKdXN0REVzdm40VzBXeHg3VUlzU0doQmJSa0JFM3BNanlOSnlseXFsa0ZpeHQ5b25HVGRTVk1kTnVBeEhTVHFWN241QjRaWFhtdVNUR25sMkRTS1lnT1NsZUNwYWtBSzE1VEJDbFBtMWFCMGMzUmh2c2Q2aXlNZlREOU1LR1hFTml0cG9rVG9PMFhTSk1VL25qcUVraEpjd1hUR0hYenRwaXRxc1ZuWEkvNEJVWXlhNlpZc21LQVNGd2FQbXBqdmpySThWMmVWVFM5YmFqRGg3QXA4WFM5ZDk2TlFZcUNVMkl1dGFZZXFNNy8wUzlWL2FDR2szTStLNXVsVkVwd2I1YnUyZmpkMUdURzBXYURQZHhaMThEYlhCWkVZcDJ3TmdZcHRSeDhEL0FNMzloVFQ=
---
apiVersion: v1
kind: Secret
metadata:
  name: rocky-kubectl
type: Opaque
data:
  authorized_keys: YXBpVmVyc2lvbjogdjEKY2x1c3RlcnM6Ci0gY2x1c3RlcjoKICAgIGNlcnRpZmljYXRlLWF1dGhvcml0eS1kYXRhOiBMUzB0TFMxQ1JVZEpUaUJEUlZKVVNVWkpRMEZVUlMwdExTMHRDazFKU1VNMWVrTkRRV01yWjBGM1NVSkJaMGxDUVVSQlRrSm5hM0ZvYTJsSE9YY3dRa0ZSYzBaQlJFRldUVkpOZDBWUldVUldVVkZFUlhkd2NtUlhTbXdLWTIwMWJHUkhWbnBOUWpSWVJGUkplRTFVUlhkUFZFbDZUVVJqZVU1R2IxaEVWRTE0VFZSRmQwNTZTWHBOUkdONVRrWnZkMFpVUlZSTlFrVkhRVEZWUlFwQmVFMUxZVE5XYVZwWVNuVmFXRkpzWTNwRFEwRlRTWGRFVVZsS1MyOWFTV2gyWTA1QlVVVkNRbEZCUkdkblJWQkJSRU5EUVZGdlEyZG5SVUpCU21NekNqbFdOak14VjNsa2NtbDRNR0pIUlRCd1pqQjRaVWt3UTBkclNVVkJRWEJGUWs1RE1uaExNMlkxZEhKdVF6WlBNSHBYZWxkWFNXUktaRlpLU1ZrM04yY0tXWEI2V1hCWmNWSTBhMjEyY2tsbWVGVXJWVEpLY0c1bVZXODJVa1JUWmpGMWNFc3piVFoxWlV0bmRYTnpMMUIwY1RjMlNsRlRiRUZpV2xSNFYzQlNRZ3AyYW0wM2JtRkxRblZLZDFoUU0wRjRORlJqU2psQ1UzaGhUMVlyVlRNcmNVdFdOVTVyWTJ4cWJHOW1OMDFYUmtKSFRXdHlRM1pUWm10U01EVnFVV0k0Q25aMk1tNVVTMmRQVEhWUVRGbFFSREZ6TXpnM1kwZFpZM0U1VDNOUlpYTmFPWEIyVm01eVEyWnZNV2huWm5CVk1HSnBPRmhVSzNOUFlrVnNTV3R5YWtZS2JGbzJkRTlrTlZwSU1HcGlaRTVhUW1WNFRGUlRMMHh1U2xKNFMyUlFkak41VjJ0Q1dEVkNORVJRVDNKd2RqbHFkemRET1VsS1p6aEdNV012VlVSb2F3bzVUblU0WVZjeVp6bFpTVE5yZUUwNGVWbFZRMEYzUlVGQllVNURUVVZCZDBSbldVUldVakJRUVZGSUwwSkJVVVJCWjB0clRVRTRSMEV4VldSRmQwVkNDaTkzVVVaTlFVMUNRV1k0ZDBoUldVUldVakJQUWtKWlJVWkhSREFyYms0MlZGTnRPWFpyZEUxNWNUQkJlRXBvVGtaa1NVVk5RVEJIUTFOeFIxTkpZak1LUkZGRlFrTjNWVUZCTkVsQ1FWRkJiVkpoVFVOUk9UTXdWVWg2YUVoaFpqa3dXWGxZY0dSa2NDdGhVR3RFTDA1d1ZscFJkSEZ5WlhoemNHMDBjM05CUlFwRU1HOXljbVZoUmk5aGJVMU1UMmxtYkN0TmJYTkJNM0JVYlRCcmRHeG9LMXBVZVdWcGFEa3dUMko2YzJWb05uWjRWbkJuTUZRelJUSnVNbGRaYjNkWkNpOVViRU5rTkVwek9HWlpSR3BXVGt4dmFHSnhVM1pxY1cxU1pESXpURXhaT1VOU05YQlpORlo1V0ZOSEwzUllOMHRvYjFsUloxTmpVRmQxYldaUWJ6Y0tkWG8yUVVWbE9FZFBSelZ1TjBabk0zVmFRa3RSVHpScU56aGxNSEp5WVZJeVEwUkNUMlIzTkRoa1NITkdlVzluVmtWNmJFbHdNVkZDTWt0S1NVMVRVQXBSY1drekx5OUZZMUZXZUdaMk1FZG5kMjlEZEhkVVdVMVNjM05YVWxWWWFtZEhXR28zUVUxMFpFWXpPRWNyWXpBNGRHWXhZVFphTkU1eVVXZDVUVUZwQ2xJMFNuVTNPV2x5TlhaRVV6RmpVMHRhTjFjMFdIUjVUVmRSZEdSR00yWlBZelJJVndvdExTMHRMVVZPUkNCRFJWSlVTVVpKUTBGVVJTMHRMUzB0Q2c9PQogICAgc2VydmVyOiBodHRwczovLzEwLjIyMC42Mi4yNDA6NjQ0MwogIG5hbWU6IGt1YmVybmV0ZXMKY29udGV4dHM6Ci0gY29udGV4dDoKICAgIGNsdXN0ZXI6IGt1YmVybmV0ZXMKICAgIHVzZXI6IGt1YmVybmV0ZXMtYWRtaW4KICBuYW1lOiBrdWJlcm5ldGVzLWFkbWluQGt1YmVybmV0ZXMKY3VycmVudC1jb250ZXh0OiBrdWJlcm5ldGVzLWFkbWluQGt1YmVybmV0ZXMKa2luZDogQ29uZmlnCnByZWZlcmVuY2VzOiB7fQp1c2VyczoKLSBuYW1lOiBrdWJlcm5ldGVzLWFkbWluCiAgdXNlcjoKICAgIGNsaWVudC1jZXJ0aWZpY2F0ZS1kYXRhOiBMUzB0TFMxQ1JVZEpUaUJEUlZKVVNVWkpRMEZVUlMwdExTMHRDazFKU1VSSlZFTkRRV2R0WjBGM1NVSkJaMGxKVms4ck5sQkJRbVZrWWtGM1JGRlpTa3R2V2tsb2RtTk9RVkZGVEVKUlFYZEdWRVZVVFVKRlIwRXhWVVVLUVhoTlMyRXpWbWxhV0VwMVdsaFNiR042UVdWR2R6QjVUVlJGZUUxRWEzbE5la0V6VFdwU1lVWjNNSHBOVkVWNFRVUnJkMDVxUlhwTlZGcGhUVVJSZUFwR2VrRldRbWRPVmtKQmIxUkViazQxWXpOU2JHSlVjSFJaV0U0d1dsaEtlazFTYTNkR2QxbEVWbEZSUkVWNFFuSmtWMHBzWTIwMWJHUkhWbnBNVjBackNtSlhiSFZOU1VsQ1NXcEJUa0puYTNGb2EybEhPWGN3UWtGUlJVWkJRVTlEUVZFNFFVMUpTVUpEWjB0RFFWRkZRVFl5ZGxwMFRXeHlVSFV4VDJkWFJFOEtNRlV6VUhVM1NtVkdOMWw0ZDJRdlduaG5aMEkwZG5sYVVHUlVjakJSZVVOTmVIaHNVbXAxVlVjNFN6bDBlRFZWVEM5SlExbG5PVUY2Y2xoSlFsaFhSUXAyVjIwdlVuRnZaR1p5ZWpncmFEYzRaekpNZGs5a2VVdHBMeXRUVDJoRmRFeG1lRE50TWsxemNpdERVSGhxY1hoVGNWaDNjRkZKYjBaUGNIQjJiRzB6Q25KNlYyOUpaRGg1V0Zkdk5FdFdZMDk1U2pZck1HRTBMM0UxYVhRMFRVeHJOelZFYmxoVVlrSTVZbU4wYldWNVYxVlhTR3gwU21kbFVrSnlOSE5hTmpJS1pXdG9SbGt5Y0V4YWJGZEhVMUZEZVZGWFdqRkVZVlZUU25JdlFtNTVLMUZEZFZCWWJuWnFTRXhrYVN0SlowbE5LMW96TDA0MFpIUmFUMUZZYjBJM2N3cE1RWGxVWXpGalluWm5VVVYxUTNSUmIxZEhTRnBxTjJoa1NHcENOakJ0ZDBzdlYzWnRXVmRqWW01RWNuQkZlSEZRY1M5MlZtTXdUVlFyYzFrMVExbFJDbE5IVG0xc1VVbEVRVkZCUW04eFdYZFdSRUZQUW1kT1ZraFJPRUpCWmpoRlFrRk5RMEpoUVhkRmQxbEVWbEl3YkVKQmQzZERaMWxKUzNkWlFrSlJWVWdLUVhkSmQwUkJXVVJXVWpCVVFWRklMMEpCU1hkQlJFRm1RbWRPVmtoVFRVVkhSRUZYWjBKU1p6bFFjSHBsYXpCd2RtSTFURlJOY1hSQlRWTlpWRkpZVXdwQ1JFRk9RbWRyY1docmFVYzVkekJDUVZGelJrRkJUME5CVVVWQlFuQkNTRmRDVEZwVU4yRXJURXRtUTJZNWFHOXFRa1JCYkVwMFYybFNNRk5hY1hKQkNqUkJTMDVhY0dsNFVqUlBaVTF4TUhWbFprOHlWMlF2TDBOdFRFeFFhSEJHVVhBd2FUaGtlalpsTTNWTVIzQkRUeXN3ZVc1a1psWjRlbHBrVG5oSVpWVUtWbGh1Ym1SbU9USkpRM1o2WVdGclVHdEJZamQxVXpGTlJtNW5LM1JMUTFWaFdtRnBXRGhvVWpCcE5WQlRjbUYzVmtremJqQm9hVmxuZVZaT0swOTRUZ3BFYzNScVkyNW9kRk15WmpSM1kydzRjSGwyTWxVMFMxVldhM0ZNYTFsUVVrcDNSVkI2VUdkME5WVlNWRmM1TW1adVVVdzJVVGRXY0VrdmVIUjBSRzlDQ2tkTUsweE1lREpNTVdZck5UQXpSR0ZLWlVaaFNrTnFORlEzYlZGYWJpdDJRVFZ1YjBOVFEyTnhZVlZHTDJWUWRYbGFjbGxTVGpsaFdIZHhObm93TUZvS2QwWm9kVzVxVFNzemVXaEtjbUoyZG5ORU1WaExUbmM1ZFVKWE4yRTFZV3N3UmpCUVUxcFZPVE4yUlZSTWRIaGlTRUU5UFFvdExTMHRMVVZPUkNCRFJWSlVTVVpKUTBGVVJTMHRMUzB0Q2c9PQogICAgY2xpZW50LWtleS1kYXRhOiBMUzB0TFMxQ1JVZEpUaUJTVTBFZ1VGSkpWa0ZVUlNCTFJWa3RMUzB0TFFwTlNVbEZjRkZKUWtGQlMwTkJVVVZCTmpKMlduUk5iSEpRZFRGUFoxZEVUekJWTTFCMU4wcGxSamRaZUhka0wxcDRaMmRDTkhaNVdsQmtWSEl3VVhsRENrMTRlR3hTYW5WVlJ6aExPWFI0TlZWTUwwbERXV2M1UVhweVdFbENXRmRGZGxkdEwxSnhiMlJtY25vNEsyZzNPR2N5VEhaUFpIbExhUzhyVTA5b1JYUUtUR1o0TTIweVRYTnlLME5RZUdweGVGTnhXSGR3VVVsdlJrOXdjSFpzYlROeWVsZHZTV1E0ZVZoWGJ6UkxWbU5QZVVvMkt6QmhOQzl4TldsME5FMU1hd28zTlVSdVdGUmlRamxpWTNSdFpYbFhWVmRJYkhSS1oyVlNRbkkwYzFvMk1tVnJhRVpaTW5CTVdteFhSMU5SUTNsUlYxb3hSR0ZWVTBweUwwSnVlU3RSQ2tOMVVGaHVkbXBJVEdScEswbG5TVTByV2pNdlRqUmtkRnBQVVZodlFqZHpURUY1VkdNeFkySjJaMUZGZFVOMFVXOVhSMGhhYWpkb1pFaHFRall3YlhjS1N5OVhkbTFaVjJOaWJrUnljRVY0Y1ZCeEwzWldZekJOVkN0eldUVkRXVkZUUjA1dGJGRkpSRUZSUVVKQmIwbENRVkZEVGxoQ01VWmhVWGd3Y0VwdVdBcEtaMGxLZFN0a1dXeFRibUZ2ZUZGT2FtaFNPWHBMUlZaWmQyWkNSVkJFYjJaa1NsRlViVk5vV0ROVU0yeHNMMFZpVUcxM1RVZHJkRFpIY2twMFJ6RXJDbTFoYjNrNGFWSm5hMmhXVkROTVkzRnRVME5YTkM5cmVHcFVVRVZFU205S1RTOWpheTlqZGpCRFowUjZUM0YzWVVrelVVSnNkRXRCZDIxTEt6ZEhURU1LV1dGNmFVVkNNemdyVFVOT1VuaExhVUZDZUc5aGNXMDFlbWc1T1UxUVJqTjFOM0J0ZWtFMmVFTkZVV3c1ZEROTU4zVnpWekp0YlVaWVlVeEhaR2RRWndwcFQxWnVWa3hzU25WMGIyTnRZbkpzU1M5S1pFZFNhVGQyVVhoM1IzZzFZMWxwTW5VMGIwcG9UWFpqWTBwd1NrTmFUMHB5T0U1UFMzWXpRblZMTms0MkNuWXJWVzVFVVhsWmJrNHhLM1V3U0V0aU1qbFBSSGxyVnpoRU4wcFBkM3B5Y1VsVWNFdElSMjlrV1hCaVRubHZSRzQxYVd4WFdIUTVjazg1UXpadWRXMEtiV1ZPZERKNlMyaEJiMGRDUVU4d2EyTTJlSEpxUlZvMk9UZFVjVU5xWVRoMVRsRnVhVE5tZVhoU2VreGFRVGN2VUcxa2QxaDJlbHAxU0RVeFZtSk5VZ3BWVG1rNE4xWmFUbE5LVWk5WFF6bG1hVkZrVWtkVFZFcFdNSGQzVlhOMlIyRmpNMUp3V2pORVRrdGlZekI1THpOWU5tNWhSelZ2WTBVeFMyMUtlRTExQ25oelNWQkhPWFF6VlZCTmMzWm1VRkJGYlM5cFNYcFFUbGhFU0VGcmRuVllWRGR3VWtsRE1HTlBlRzlEUmtvMmJFUnNZVXREUjIxWVFXOUhRa0ZRTkdzS1dFdEtUbWxtY1hSVk1FMVVOMnMxVldwMlJ5dDZVbmhRY0dGNlpqbHVOazF4Ym5aTVZqTlNaVkV6T0VwV1NuUklWSEpCT1d0WFRHeGxORWhxVkhnM05RbzVhR2Q2YmpWc1FqSkllbkk0Y0RrdmREbDFTMVEwUlZONGJrcFlXVkpsTUd3d2NHdDRSRGRKUm1KQlNtWnZhWFpWZDBoUWNFSldWbEJOY0ROQ2JVazNDblF2VFhwdVpsRnhNVlpzUzNSM1kwcEpRbTVPYzI5VFkyZEdUR3h2ZEhkMlVFVjRNR0ZVTm5wQmIwZENRVXR5ZUZoa2FuRmFaVWhuWm01TlVsTnRLMDhLZEhkV2JuaERaV2N2ZFc0d2VUVnVjamhKV1UxQlRYcDJMMUZvWW1WSU1YVm1RVXhuYmxreFlXaEliRmhIY2tJM1p6UkhZM1ZwTVVWWVowNTZlV2gwVHdwWFlrdGtOekkyTnpac1dtMVdSek01VDJnMWMwNVFNWGRSTlZkUFdrSm9NVE5hZWtJeU1tcHRjRFZ1UkhCUFNEbFpUMHcxT1dwdkwxUk1aMjluTUhWT0NrWldTRkJpVVhoWWFqRnlLMHRRVERkT1JYazFhamR5WkVGdlIwRkpTVUZNTjB0SFdETktkbVozZG5SQmFGaHVaekJrSzBKdldGazJSRXhMVkdScWJVMEtOemh1WjFKRWVIUjVNR2R3VEhKYVpYaE5SVXN6Tm1aVVRrcG5ZVWhUT0VGSWNsbDZWMk5yUnpReWNsWkhlbkZrUXpWR1ZHVTBSVzlMWVZWMFFVaG5Vd3A0VDNaQlFWQjBZbU54YVRCTGMzbHdRVGxzUnpsWlpIZ3ZOelZoTjJGTlVHTnBWMDkwU2xCd2RITkxUVkl6VlU5VGREVTBWSFZqYjNKbVJUVTROR2xEQ2pSS1FXVnBWM05EWjFsRlFXZFBVSEprZFdOV0wySlNkbXR5TVhoWGRGWkVjV3hEUm5Ga2NtWjBValpvUkV0TVQzbHJabVpSZGt0bmMxaG1hRVV4TmtzS1ZIQnNNRUpHWW1SeVlsSmxibVJYSzJzd2EwNUtiMFU0UTFsU1dtc3pla2RhU1U5cmQyTnJOMGRwYVRWWWVXWlFSVE5JU1ZGVE1TdFpkbEZSYlhGdVFncG5Vamg2VkZkbmVXNVBSall6V2xCeFVFRm5RVTB2UTNwVWJYQkxXbGxqTWpSQmVUSnFRbWh6V0RsTmREZE9XVE01V0VoYVdVeEJQUW90TFMwdExVVk9SQ0JTVTBFZ1VGSkpWa0ZVUlNCTFJWa3RMUzB0TFFvPQ==
---
apiVersion: v1
kind: Service
metadata:
  name: rocky-ssh-service
  labels:
    name: rocky-ssh
spec:
  type: NodePort
  ports:
    - name: rocky-ssh
      port: 22
      targetPort: 22
      nodePort: 30022
  selector:
    name: rocky-ssh
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: rocky-ssh
spec:
  replicas: 1
  strategy:
    type: RollingUpdate
  selector:
    matchLabels:
      name: rocky-ssh
  template:
    metadata:
      labels:
        name: rocky-ssh
    spec:
      volumes:
        - name: ssh
          secret:
            secretName: rocky-ssh
            defaultMode: 384
        - name: kubectl
          secret:
            secretName: rocky-kubectl
            defaultMode: 384
      containers:
        - name: rocky-ssh
          image: sjwayrhz/rocky-8.4:kubectl
          imagePullPolicy: IfNotPresent
          volumeMounts:
            - name: ssh
              mountPath: "/root/.ssh/authorized_keys"
              subPath: authorized_keys
              readOnly: true
            - name: kubectl
              mountPath: "/root/.kube/config"
              subPath: config
              readOnly: true
          resources:
            requests:
              memory: "512Mi"
              cpu: "500m"
            limits:
              memory: "1Gi"
              cpu: "1000m"
          ports:
            - containerPort: 22