apiVersion: v1
kind: Secret
metadata:
  name: rocky-ssh
type: Opaque
data:
  authorized_keys: c3NoLXJzYSBBQUFBQjNOemFDMXljMkVBQUFBREFRQUJBQUFCQVFDdG1yQmZPRkxGOHRVQnlaTU5iUmtoQ3FyTHhQc2NJMUlBdnYvd2pKdXN0REVzdm40VzBXeHg3VUlzU0doQmJSa0JFM3BNanlOSnlseXFsa0ZpeHQ5b25HVGRTVk1kTnVBeEhTVHFWN241QjRaWFhtdVNUR25sMkRTS1lnT1NsZUNwYWtBSzE1VEJDbFBtMWFCMGMzUmh2c2Q2aXlNZlREOU1LR1hFTml0cG9rVG9PMFhTSk1VL25qcUVraEpjd1hUR0hYenRwaXRxc1ZuWEkvNEJVWXlhNlpZc21LQVNGd2FQbXBqdmpySThWMmVWVFM5YmFqRGg3QXA4WFM5ZDk2TlFZcUNVMkl1dGFZZXFNNy8wUzlWL2FDR2szTStLNXVsVkVwd2I1YnUyZmpkMUdURzBXYURQZHhaMThEYlhCWkVZcDJ3TmdZcHRSeDhEL0FNMzloVFQ=
---
apiVersion: v1
kind: Secret
metadata:
  name: rocky-kubectl
type: Opaque
data:
  authorized_keys: YXBpVmVyc2lvbjogdjEKY2x1c3RlcnM6Ci0gY2x1c3RlcjoKICAgIGNlcnRpZmljYXRlLWF1dGhvcml0eS1kYXRhOiBMUzB0TFMxQ1JVZEpUaUJEUlZKVVNVWkpRMEZVUlMwdExTMHRDazFKU1VNMWVrTkRRV01yWjBGM1NVSkJaMGxDUVVSQlRrSm5hM0ZvYTJsSE9YY3dRa0ZSYzBaQlJFRldUVkpOZDBWUldVUldVVkZFUlhkd2NtUlhTbXdLWTIwMWJHUkhWbnBOUWpSWVJGUkplRTFVUlhkT1JFVjRUV3BuTUU0eGIxaEVWRTE0VFZSRmQwMXFSWGhOYW1jd1RqRnZkMFpVUlZSTlFrVkhRVEZWUlFwQmVFMUxZVE5XYVZwWVNuVmFXRkpzWTNwRFEwRlRTWGRFVVZsS1MyOWFTV2gyWTA1QlVVVkNRbEZCUkdkblJWQkJSRU5EUVZGdlEyZG5SVUpCVEU4MUNsTjVXU3RyTW05TFRrRTVSRXhrTHpWYWNrRmlOMFV3ZUhCVVlYTkNjbUZMWVRjMmJuSTRSbTg0T1ZKVE1qQm5VRXBoTUcxMVlrMHlWRVYzUlZBM1ZGY0tjRk16YkdaTVRuaElWM2RXUkcwd2FEUkJOV2xaY0RJdlpsSnFWMk5OWTBobVRYSTNkVVl2ZDBScWFGcEZZVnBUYm10UU1WWnJOemhzVkRsV2REZDBiZ293Ymtkc2RIRmhWa1pWUkROamNVRjZXV1Y1VG1sdk5YRTFTblpNYnk5V2NrOVZOMlZZVkdodVZuRlRlRGczYjJOcVZrSnNPSFZtYjFCd1RFTkZVeXRwQ21oRWJFSkhjRUZqUzNaUlprMTRkMDQ0VFVwQmRYaHNiR1J0Y1VnMFpYZHhiR1pYTVhNeVNWSTNTRUZDUW1ORVJUTlZNV1Z6Y0ZnMGRrWXZSMmd3UWlzS1l6RlBWbWxRYUZOdFZGbHliQzgyV0ZRMGEycEtiUzgwT1VWQmFXTlpjSE5yT0ZOa2RURkNXRU5HYWtkV1JYbDRWVXhRTjFNMVNsVkZjazlDU0dSNmF3cG9ha0ZvZEZoeVdYQkNTRlF3UWtGa1UwTmpRMEYzUlVGQllVNURUVVZCZDBSbldVUldVakJRUVZGSUwwSkJVVVJCWjB0clRVRTRSMEV4VldSRmQwVkNDaTkzVVVaTlFVMUNRV1k0ZDBoUldVUldVakJQUWtKWlJVWktXbTlCTVVWSlQzcGhNbGRDT0cxRWIxSTJaRE5OU1ZKNVpEWk5RVEJIUTFOeFIxTkpZak1LUkZGRlFrTjNWVUZCTkVsQ1FWRkNSa05qTmxNMWVHRkVVM3BrZUZkQlREazNZbkJxYUVOMVQweEJOR1kxWm5seVYxSXZZM05xUmxwclpEYzJPR1F5TVFwMllYWkVkV1oyZDFOUFYzUmxhRTQzVTJjMmJVMTZORGhMYW1KS1NYbHRSbVJoZUZkNk1XSk9RMkl5VVRGNU0wcE1SUzgwUWl0a1IwTnRaems1UjBkd0NpdDRZVlozZDI1bWJFODVXa2wwU0dWTWJGWnNUM1kxY0dGbFJWaHNUekV2Y2tkWllrWk5kamhTVEUweFdEZGhiVzQyUzNCaVpVUlFUVkJ0YlhWc2JFd0tORXh3VlZseFltdFBVMFpOYUcxa2NEWnFOazk0WTNCS1VIUnVkMWN6VjJWcGQyNTFUMmhpT0U5bU1GbEZURVJUUm1wTE9HMU9UeXRLZDAxbmJqaERhd3BKT1V0MlJtdDVNMk5QV25Sck5Hb3hTWHBzUldGT1ExSnVkbkp1UjNJM1psVTVVblIwWmt4YUsxVXljbFZyVURoRVdISlBiV1IzZGxKclZsRTJja2dyQ2tneGMyRkVaVXhMWjA4M1JEQnJRbE15VWl0bGJtdExURWMyVWpKM2IwaEZWMGh4VEFvdExTMHRMVVZPUkNCRFJWSlVTVVpKUTBGVVJTMHRMUzB0Q2c9PQogICAgc2VydmVyOiBodHRwczovLzEwLjIzMC43LjEwOjY0NDMKICBuYW1lOiBrdWJlcm5ldGVzCmNvbnRleHRzOgotIGNvbnRleHQ6CiAgICBjbHVzdGVyOiBrdWJlcm5ldGVzCiAgICB1c2VyOiBrdWJlcm5ldGVzLWFkbWluCiAgbmFtZToga3ViZXJuZXRlcy1hZG1pbkBrdWJlcm5ldGVzCmN1cnJlbnQtY29udGV4dDoga3ViZXJuZXRlcy1hZG1pbkBrdWJlcm5ldGVzCmtpbmQ6IENvbmZpZwpwcmVmZXJlbmNlczoge30KdXNlcnM6Ci0gbmFtZToga3ViZXJuZXRlcy1hZG1pbgogIHVzZXI6CiAgICBjbGllbnQtY2VydGlmaWNhdGUtZGF0YTogTFMwdExTMUNSVWRKVGlCRFJWSlVTVVpKUTBGVVJTMHRMUzB0Q2sxSlNVUkpWRU5EUVdkdFowRjNTVUpCWjBsSldIQm9WVEpDV2pnMGN6QjNSRkZaU2t0dldrbG9kbU5PUVZGRlRFSlJRWGRHVkVWVVRVSkZSMEV4VlVVS1FYaE5TMkV6Vm1sYVdFcDFXbGhTYkdONlFXVkdkekI1VFZSRmVFMUVVWGhOVkVrMFRrUmtZVVozTUhwTlZFVjRUVVJKZUUxVVZUQk5hazVoVFVSUmVBcEdla0ZXUW1kT1ZrSkJiMVJFYms0MVl6TlNiR0pVY0hSWldFNHdXbGhLZWsxU2EzZEdkMWxFVmxGUlJFVjRRbkprVjBwc1kyMDFiR1JIVm5wTVYwWnJDbUpYYkhWTlNVbENTV3BCVGtKbmEzRm9hMmxIT1hjd1FrRlJSVVpCUVU5RFFWRTRRVTFKU1VKRFowdERRVkZGUVRscFJrZFlVM2RhTTB4U2QzRTJXWE1LTVRGblFuZEZUVkpvYkROaVYzUlhhRk5DTjBOelZsY3lRMWN6V2xoNWJsQktNbUpHU25VeWNHVnFOa3BQZW5SdFJWUnRhSEZNTmtOcWNEbEtXWEZIVHdwWldreHphVkp4ZUU1SGNFRmxNblpEU3pKVWQyZ3dVREp0VmswME1FWnRNRTVPVW5abGNXc3dNREJRU3l0V1ZrbFJZWFp4YVd0YVlUWm5NRFZsZEZSR0Nsa3lTa1IxVGpSVUwxcFljbXhCZEVnM1YySmFMMFJ0Wkd4NU9HTktVWGt5VFRobWRrSkpXSE4xYTFOVWJXaElWbWhHUkhWVVZ6azROa3BUZEZsdlZEQUtiUzlYTjFKTWJYZFBVek52ZEd0bmRqZHdZazlCU0Uxc1NIVm5XblJaTkVKcGRVcEVVVkJxTkhWVE0yNXJUVUppV0Rrd1lVd3JNRmxOZEdsMVZrOURMd3BTVW1KMlJURnFhVlJsVG5GQ2RWbHZXblp3WnpSa2FXRnlORGRIYzI0MmFWcE9Ra2hHY1UxWVp6Z3ZSbmhRTVVsaFFVRkhkMUUxYjJoUVFWbDJaMlJ4Q2s5UFZERjJVVWxFUVZGQlFtOHhXWGRXUkVGUFFtZE9Wa2hST0VKQlpqaEZRa0ZOUTBKaFFYZEZkMWxFVmxJd2JFSkJkM2REWjFsSlMzZFpRa0pSVlVnS1FYZEpkMFJCV1VSV1VqQlVRVkZJTDBKQlNYZEJSRUZtUW1kT1ZraFRUVVZIUkVGWFowSlRWMkZCVGxKRFJITXlkR3huWmtwbk5rVmxibVI2UTBWamJncGxha0ZPUW1kcmNXaHJhVWM1ZHpCQ1FWRnpSa0ZCVDBOQlVVVkJSMkpMVFdrclpYRkhWSEpKUkVOWlFWTTRja3g0TVRCcVUyNW9aak5hU25wMVVUQnZDbk0xTkUxM1MwdFFTWGhwTmpWNlFrVjNiMlpZWVdaM2NWTnplak4zTVhobE5EQlhVVmxxYWpkUmJYVXpZbTl3Y0dSb1ZuVnNWbGxDUlhodlowb3JWbEFLUzB4SWFHVTVOSFY1Y2pjelYyRlNiR2hzZUdWNGRuQjJZWFpSWmpoUVEwZFpVakJwTjJKMk5FNXNVemN6V0RkU2FVWllNbHBwV0hOME1FOXJWMnB4V1FwdU4xRTVNamd4ZGpSdFdVWlRMMnh0TlVSTFkxbHhkbE56V2xZNVdtbHRlamxKT1ZCdFZWaExiVXd3V1dweGJDdEJZbFZqTUVkS0t6Y3ZjbXBXYzBzNENuQmpiQzkyVG1wR1ozTm9jV1Z1VjJ0a2RrNTVTRGsxWlhwalZUaDRabWxZZDJvelZHWmtWbXhwSzNaMldGVkhWR05JTUVRM1dIWkdiVEZNVms0eU4wa0tOalZOWVVwaFFYbHNiMlUzYkRsalZVcERVaXR1YldWRmVFVndZbUpOVDBKMWJsbG1UVU4zY1UxclZ6UlNVMGx4SzBFOVBRb3RMUzB0TFVWT1JDQkRSVkpVU1VaSlEwRlVSUzB0TFMwdENnPT0KICAgIGNsaWVudC1rZXktZGF0YTogTFMwdExTMUNSVWRKVGlCU1UwRWdVRkpKVmtGVVJTQkxSVmt0TFMwdExRcE5TVWxGY0ZGSlFrRkJTME5CVVVWQk9XbEdSMWhUZDFvelRGSjNjVFpaY3pFeFowSjNSVTFTYUd3ellsZDBWMmhUUWpkRGMxWlhNa05YTTFwWWVXNVFDa295WWtaS2RUSndaV28yU2s5NmRHMUZWRzFvY1V3MlEycHdPVXBaY1VkUFdWcE1jMmxTY1hoT1IzQkJaVEoyUTBzeVZIZG9NRkF5YlZaTk5EQkdiVEFLVGs1U2RtVnhhekF3TUZCTEsxWldTVkZoZG5GcGExcGhObWN3TldWMFZFWlpNa3BFZFU0MFZDOWFXSEpzUVhSSU4xZGlXaTlFYldSc2VUaGpTbEY1TWdwTk9HWjJRa2xZYzNWclUxUnRhRWhXYUVaRWRWUlhPVGcyU2xOMFdXOVVNRzB2VnpkU1RHMTNUMU16YjNSclozWTNjR0pQUVVoTmJFaDFaMXAwV1RSQ0NtbDFTa1JSVUdvMGRWTXpibXROUW1KWU9UQmhUQ3N3V1UxMGFYVldUME12VWxKaWRrVXhhbWxVWlU1eFFuVlpiMXAyY0djMFpHbGhjalEzUjNOdU5ta0tXazVDU0VaeFRWaG5PQzlHZUZBeFNXRkJRVWQzVVRWdmFGQkJXWFpuWkhGUFQxUXhkbEZKUkVGUlFVSkJiMGxDUVZGRFRFUmxNbFpCYVRsNVZUZGpPQXBKZEhjcmNGbG5TSFZXZVZSVWVqazBjVU14UVdNM1EwaFJLMlJsYlVkTmQzTnZlRWwwU0ZVMlRYaGxSelozU0ZwS2QzWmFUek5uY25ZNFdTOUZXbk5EQ2xWRlowTjBSMFpUWWtoUmJFdHpjRmhqUmk4ME5rVlNSVUkwSzNkMlExaHFRVWR6YUZaamRrNTJkamhNVWsxbVRqWm1TM2wwTlVGQmIzaE5SMGhKWVZjS09FNUxOeTlYTlVwaFdqVmtja2NyTVRac1IzVjJSMkl6WVhjeWRuUlhRa0Z5TWtJckswRmFhekJCZWpOT1ptdEJiRU0yY1VKbmQwOWFNMnRzWjI5emRBcEVNMHBzU2pGTE1XeHpXbXN3VDFoaU1taFdSbUUyTVZkS1NpOXZRbWgyWVdaYWNIWlBSMjlTZGk4d1ZEZzFkV05MV0V0dmN6UlVORkJxU2paYVYzVTRDams0WW1KSGNVcFpNMGgwUTJGNU5ISlNZVk54UWxoeGRqaEZVR051Y0ZWUkwyMVVhR1JYY0ZKV1VqTm1TMDh2YWpsWlNGcHdNREJKV1ZsUmExWmxiRTBLZUdwNWVsRm5TalZCYjBkQ1FWQXJiV3Q0WmxsUFkzWXlkMEptYW1aM2MydzBjVGQwZURORmVWWk9NRXBMY2sxbFlUZHBaM0l5ZG5wNWFVeFBNMjFoVmdvclNuaHFZMHhGY2pnMVlYTldiVEo0U210R1JGbFJiakp3WmpNNFQxZEVORW93T0V0aVQweENOVTFGUm5abFQwdHNSVFJMYWpkc2JUYzBiaTltZWk5aENuSkJSbTlJVFVKNWNucFhURnBVY2taUVFWVnBPRnBWYXpscUx6VkVRMnBzYkRoc2QydDVWRXRtWlZVd1dFUjBlSFU1TVZaMVdGRXZRVzlIUWtGUVdqTUtXSEppTkVwRGJXaFdSaXRMVWtwcloyTnNlRk50T0VaT2JFaFJUemxSY2xOTVdqZHVXRlJZVFVKbU4yUk1OR2d3VkdGSU1IUk5hM2sxZWt0dE5rbHhRZ28zVldod1ZtaHNTMlZrUldoT1JUTlpNbGw2TlhsTmJUQnFPRGxGT0dVellrUkVNVlJYYld0TldtOHdSRkpvZVROQlpXNTFNSFpzYUdSNGVFbzBaVU55Q2tnNFJXdGlXVTU1TkVFeVVrUlBSak4yY25KeGVtd3lPWEZJU1dkdWR6Tk9XbU41T0ZCVFkwUkJiMGRDUVZBM05UQkVUVEJCVmtWbldsTTFkVkU0VDBjS2IySlFLMmszUTIxc2JWWjFVWGgzY1RsNE1VcG9hWGxTUm1OWWNIUllPWHBxUjFoT0swSk9PREZ3U1hOcFNHTlhMME5UVkZsNlJtZDNkVmQ1Y21wbE9BcDVUbVpaWldkclptZFdkbE56YWxaRVptVTNiMDFpYVd0d1luaHdRM2t4VVd3NFZTOWFXVEkzTVVkMkt5ODFVRU5MTnpacWRqTmpWbE5zVlRkMU5Xb3JDbWhKYW5kemNFVTNUa294Y0hZMlR6WktOMm94VTNWYVdrRnZSMEpCVEZjNGJtRXlhbGRrT0Uxd1FUbDZRVVpST1ZaaVdqTXZNM1pTVUdWak5scEVkMllLWTFJMVkwVnBTWEZIUkRKMlZWYzFNeTlCY1hoVE1rZFZNVWRDU1V4UE5UbEZZaXN3VmtwV0wydHJXRUZEZWxwbU9GVk1MM0ZMZGpkS1drODNhbVl4U3dvMlZVdE1TbEEyVXpnd1pVWnZNM2h1UVdSV1EydHVWSEpDYnpWdlpVWk9XRTgyYjB0ME1tOVlSMlJzU0VoTk1XZHZPVnB0WWpsak1Xc3pSR05XZDNkNENtRmhRa2hMV0hsTVFXOUhRVUpCUkVKYU1FVnlaRkpHUlROcmVEbFhkalZtYlVoVllVSnJZU3ROUzBaaWVHbHpNMDE1UnpCQ2FqaEViR0ZGYlhCNVNXUUtORGRUV0ZGb1ZEQnVkVXRSZG1sQ1dWaGxUR1F3YzFkeVozUXJXSGxaTVRJdk5YTmxPRlkxY21weFVTOTVLM2hGU0dwUE5qSmlSRmMyYkRCeldWbERRd3BOWms4MllYWmhLelZUUmtwRFdVOUJOa1ZhWlhZdlRVOUhaa2R2YjJJNFpUUXJSRmRGUVhSMUsxcE5UM0Z5UmxKU1IwSkZSamRaUFFvdExTMHRMVVZPUkNCU1UwRWdVRkpKVmtGVVJTQkxSVmt0TFMwdExRbz0=
---
apiVersion: v1
kind: Service
metadata:
  name: rocky-ssh-service
  labels:
    name: rocky-ssh
spec:
  type: NodePort
  ports:
    - name: rocky-ssh
      port: 22
      targetPort: 22
      nodePort: 30022
  selector:
    name: rocky-ssh
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: rocky-ssh
spec:
  replicas: 1
  strategy:
    type: RollingUpdate
  selector:
    matchLabels:
      name: rocky-ssh
  template:
    metadata:
      labels:
        name: rocky-ssh
    spec:
      volumes:
        - name: ssh
          secret:
            secretName: rocky-ssh
            defaultMode: 384
        - name: kubectl
          secret:
            secretName: rocky-kubectl
            defaultMode: 384
      containers:
        - name: rocky-ssh
          image: sjwayrhz/rocky-8.4:kubectl
          imagePullPolicy: IfNotPresent
          volumeMounts:
            - name: ssh
              mountPath: "/root/.ssh/authorized_keys"
              subPath: authorized_keys
              readOnly: true
          volumeMounts:
            - name: kubectl
              mountPath: "/root/.kube/config"
              subPath: config
              readOnly: true
          resources:
            requests:
              memory: "512Mi"
              cpu: "500m"
            limits:
              memory: "1Gi"
              cpu: "1000m"
          ports:
            - containerPort: 22