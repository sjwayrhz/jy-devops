apiVersion: v1
kind: Secret
metadata:
  name: rocky-ssh
type: Opaque
data:
  authorized_keys: c3NoLXJzYSBBQUFBQjNOemFDMXljMkVBQUFBREFRQUJBQUFCQVFDdG1yQmZPRkxGOHRVQnlaTU5iUmtoQ3FyTHhQc2NJMUlBdnYvd2pKdXN0REVzdm40VzBXeHg3VUlzU0doQmJSa0JFM3BNanlOSnlseXFsa0ZpeHQ5b25HVGRTVk1kTnVBeEhTVHFWN241QjRaWFhtdVNUR25sMkRTS1lnT1NsZUNwYWtBSzE1VEJDbFBtMWFCMGMzUmh2c2Q2aXlNZlREOU1LR1hFTml0cG9rVG9PMFhTSk1VL25qcUVraEpjd1hUR0hYenRwaXRxc1ZuWEkvNEJVWXlhNlpZc21LQVNGd2FQbXBqdmpySThWMmVWVFM5YmFqRGg3QXA4WFM5ZDk2TlFZcUNVMkl1dGFZZXFNNy8wUzlWL2FDR2szTStLNXVsVkVwd2I1YnUyZmpkMUdURzBXYURQZHhaMThEYlhCWkVZcDJ3TmdZcHRSeDhEL0FNMzloVFQ=
---
apiVersion: v1
kind: Secret
metadata:
  name: rocky-kubectl
type: Opaque
data:
  config: YXBpVmVyc2lvbjogdjEKY2x1c3RlcnM6Ci0gY2x1c3RlcjoKICAgIGNlcnRpZmljYXRlLWF1dGhvcml0eS1kYXRhOiBMUzB0TFMxQ1JVZEpUaUJEUlZKVVNVWkpRMEZVUlMwdExTMHRDazFKU1VNMWVrTkRRV01yWjBGM1NVSkJaMGxDUVVSQlRrSm5hM0ZvYTJsSE9YY3dRa0ZSYzBaQlJFRldUVkpOZDBWUldVUldVVkZFUlhkd2NtUlhTbXdLWTIwMWJHUkhWbnBOUWpSWVJGUkplRTFVU1hkTmFrVTBUbFJOTVU1V2IxaEVWRTE0VFZSRmVrMUVSVFJPVkUweFRsWnZkMFpVUlZSTlFrVkhRVEZWUlFwQmVFMUxZVE5XYVZwWVNuVmFXRkpzWTNwRFEwRlRTWGRFVVZsS1MyOWFTV2gyWTA1QlVVVkNRbEZCUkdkblJWQkJSRU5EUVZGdlEyZG5SVUpCVGtST0NubFZaekpKTTFZNFppdDRWRTlpTWxvNGJIUjNSazFhUlZsUVpXWk9hSFJ0WjFGNk1ERnJNR1JOTURkVlF6QTFhMFpKVjI1SVFqZEZUR0Y0VEdoc1RGb0tiR2N3UXpaaldraEZRVGR5WVVOeGFXMXpWamRYT1RCbGVrMUxNSEJMYkM5VVRUaDRkRlEzTHpWWGJHdGtSbWt4V0cxRE1IWlpLMHhZV1M5Ulp5dHNUZ3BLUW1FMFVETkhOMmczZEdKcFl6SkJORzlzTUhwRGFFcHNVVk4zTjBacU9VOUlNbU01VDFKMk1WTm1WMGh6WVdVd1kySmxabkZLZHpkeFRXbzRUbk5DQ2xJM1owdEJhRE13TDBwU1VsWjNaMFJDZVZWSE1FWTJhMHhwZVd0cFZVUjBjR1ZXYzBveWRIUmxSMHhDZEdKU1EzSnVORXR6VEdjclRVaHFSM3BrTTNNS1RVVk9Ta05DU25kRVVEVm1RMUZOYVU4M1kyWXhMMjB6WlVwRlVqUXZTRVJXZDJWVlJrSnBVbVZOUjJWVGRWWXdZV2RaZFdwTVIwaEtUbE0yVDNab2VncDBVSGxVZFcxNFdGbHlXRlJVYTJSdU1EVk5RMEYzUlVGQllVNURUVVZCZDBSbldVUldVakJRUVZGSUwwSkJVVVJCWjB0clRVRTRSMEV4VldSRmQwVkNDaTkzVVVaTlFVMUNRV1k0ZDBoUldVUldVakJQUWtKWlJVWkhkMDFVWld0MlRsZEZVMkZ0YTNnNWNrRkNXWGxxV2pNeVNHdE5RVEJIUTFOeFIxTkpZak1LUkZGRlFrTjNWVUZCTkVsQ1FWRkRaWHB2YlhsRE5GWkhPWFF5TTNKbk9FazRkWFJhYlZGU2RYaEdlbW8yVmt4RFVUWkRXa1p1YW1aSE1WVm1XRTF4TWdwTVJVTlpkR3BFVWpkWllVVjRVbEJFTlVORU1rZDZVazh4WjJSYU5UaG1iRUpTUlZSTFZHSkJVMEV3V21KblRtcHJNVGg1U25waVNtRjFSalo1VFdreUNuTkNXR1ZDY3pZNU1YbGlPVzR4VWtFeksxQXJaR2h0VkZOWWR6Rm9WMHBVU0hsak0wMWxibVJTVkRsV1F6QkxXalIzYkhsSmMxQXhZMVl2UWxsWFJ6TUtXRUZ2V1ZsVlkzRklWSFp0THpOblVXaENZVTAxVTBJdlYzTTVVRU4zY2pBME1XcE1aalpzVm05UWRXTnFVVVpLYTBaVmRrMXVOemhYUTNCbFpFcElad3BIYldaeVdGTmpkbkV6V0U1WmN6TTRlWEZVZUd0U1NYWk5WMlZqU0VFcmJHcHBVVGt6Wm5CeE9Va3dlRzVqTVVneWJtMU9hMEpPZVd4b05tZFRRMmt4Q2xncldrdDVXWEZSVVRWNVQxTlVhRXhqT0c1VVVXRXJZWGR5WWpoamIwUk1ibHBIZGdvdExTMHRMVVZPUkNCRFJWSlVTVVpKUTBGVVJTMHRMUzB0Q2c9PQogICAgc2VydmVyOiBodHRwczovLzEwLjIyNS42My41MDo2NDQzCiAgbmFtZToga3ViZXJuZXRlcwpjb250ZXh0czoKLSBjb250ZXh0OgogICAgY2x1c3Rlcjoga3ViZXJuZXRlcwogICAgdXNlcjoga3ViZXJuZXRlcy1hZG1pbgogIG5hbWU6IGt1YmVybmV0ZXMtYWRtaW5Aa3ViZXJuZXRlcwpjdXJyZW50LWNvbnRleHQ6IGt1YmVybmV0ZXMtYWRtaW5Aa3ViZXJuZXRlcwpraW5kOiBDb25maWcKcHJlZmVyZW5jZXM6IHt9CnVzZXJzOgotIG5hbWU6IGt1YmVybmV0ZXMtYWRtaW4KICB1c2VyOgogICAgY2xpZW50LWNlcnRpZmljYXRlLWRhdGE6IExTMHRMUzFDUlVkSlRpQkRSVkpVU1VaSlEwRlVSUzB0TFMwdENrMUpTVVJKVkVORFFXZHRaMEYzU1VKQlowbEpZVlJqVVhJMWFtNVFhVkYzUkZGWlNrdHZXa2xvZG1OT1FWRkZURUpSUVhkR1ZFVlVUVUpGUjBFeFZVVUtRWGhOUzJFelZtbGFXRXAxV2xoU2JHTjZRV1ZHZHpCNVRWUkZlVTFFU1hoUFJGVjZUbFJXWVVaM01IcE5WRVY0VFhwQmVFOUVWWHBPVkdoaFRVUlJlQXBHZWtGV1FtZE9Wa0pCYjFSRWJrNDFZek5TYkdKVWNIUlpXRTR3V2xoS2VrMVNhM2RHZDFsRVZsRlJSRVY0UW5Ka1YwcHNZMjAxYkdSSFZucE1WMFpyQ21KWGJIVk5TVWxDU1dwQlRrSm5hM0ZvYTJsSE9YY3dRa0ZSUlVaQlFVOURRVkU0UVUxSlNVSkRaMHREUVZGRlFYVmthbFl5WlN0VUsyOUpSbmwyTm1nS1NXeHZjbGR6WmpJd1puRTBXRUozTWpKNU5VSlZVekZwV1RKd1JEWkdkRVJITVhBNVFrYzBVMVZVWjBSR1pVTlZXakJ1UTFGNVVXTTRXbFZWUlZWbFJBcE1TWG94TkZkWVN6aHNkRlp5YURWMVUxbEVUMnd5TmxGRGVGazVlRVJXVkdOaWNsZ3hMMVoyVEdrdk5YcEdNR2hyTUdwRU1qQkxSbmhCYm1ZMlQzWXlDbkpDV1dwQ2VXWndkbGxXTUhONWJGbDZkSEZ4ZVhJMVRtaEhia0ZqSzNsdFowSjRjMnRUVlRZd1dEZzVLMjUyU0U1dlFtVkVURVJ0U2tWMWIwWk5VMlVLVDJOcVNucGxibXBRZFRKbVEwNXpPSFJNYkZGVFYyUXhjV3BvV1VGUVVtSm9lVEk1VHpKd1JsUmFlWGszVFZsSVZuVndiMGRJWW01UmVEbHdlR3cwV0FwTU9VaFBjemxPUzFKVGQyWk5OalJyZGpGSFlVNHpjRmhQTWxKQmFsSmFjRVo2UVdab0sxZFdWR1JxVEdWcWFWVkpaVW94TXpkak4ydDROM0kyVGtWNkNqVjFOMVJVVVVsRVFWRkJRbTh4V1hkV1JFRlBRbWRPVmtoUk9FSkJaamhGUWtGTlEwSmhRWGRGZDFsRVZsSXdiRUpCZDNkRFoxbEpTM2RaUWtKUlZVZ0tRWGRKZDBSQldVUldVakJVUVZGSUwwSkJTWGRCUkVGbVFtZE9Wa2hUVFVWSFJFRlhaMEpTYzBSRk0zQk1lbFpvUlcxd2NFMW1ZWGRCVjAxdk1tUTVhQW8xUkVGT1FtZHJjV2hyYVVjNWR6QkNRVkZ6UmtGQlQwTkJVVVZCU1Voa1RXeG5SbU5WY0d0eFIwa3dZMGhYTlN0WUsweHpSVkpDTkdoQ1JpOUtUVkJ0Q25wT09FRnhjMFZVZW1jeGRuQjVNMnRNT0RocGVpdFZhRFZpVG1ac1psZHlhME0xVEVWWVl6ZEVjVk5sT0ZSRU5WbE5Nbk5JV2k5NU9EY3pUM2N4WkRRS1RYbFhaMmhxWVdkWmJtOXNUMnRMZG0xU2VIUkJNMnBWVjJSQk5YSnRPV293YjBOQ1pVMVdXRXRNZVdOblJVUkZXVlo1ZVZwbmFIQjJZek5WUmpsR1dBbzNiRzB6VTNkcE55c3dZelpGWjFKT2FqWjZiak5vUm5oaE1rWnhkMDQ0V1VFdmIwOTBWVXBoUVU5MVNqVjVkelpSZEhKcllXWnZTMVpqVDFGTFRERmlDbTlKWXpKM1JubExUVVZCVG1kNlIwZEVkR1F5Tm5FcloydDBhVEIzVlZWMmMwRlZUbEJxYVdNM2RsVmFjbE0zYVhjMFdYQnZTRzlqZW10MFNWbFViV0lLVjJ4cFZWVnpjR1JhUnpGSFdEVXJURWRqWWpoWmMzZHZMME5QZEdKTmJsUkpTMGgzV2tjeU4zRkhUWFpXZERSdVdtYzlQUW90TFMwdExVVk9SQ0JEUlZKVVNVWkpRMEZVUlMwdExTMHRDZz09CiAgICBjbGllbnQta2V5LWRhdGE6IExTMHRMUzFDUlVkSlRpQlNVMEVnVUZKSlZrRlVSU0JMUlZrdExTMHRMUXBOU1VsRmIzZEpRa0ZCUzBOQlVVVkJkV1JxVmpKbEsxUXJiMGxHZVhZMmFFbHNiM0pYYzJZeU1HWnhORmhDZHpJeWVUVkNWVk14YVZreWNFUTJSblJFQ2tjeGNEbENSelJUVlZSblJFWmxRMVZhTUc1RFVYbFJZemhhVlZWRlZXVkVURWw2TVRSWFdFczRiSFJXY21nMWRWTlpSRTlzTWpaUlEzaFpPWGhFVmxRS1kySnlXREV2Vm5aTWFTODFla1l3YUdzd2FrUXlNRXRHZUVGdVpqWlBkakp5UWxscVFubG1jSFpaVmpCemVXeFplblJ4Y1hseU5VNW9SMjVCWXl0NWJRcG5Rbmh6YTFOVk5qQllPRGtyYm5aSVRtOUNaVVJNUkcxS1JYVnZSazFUWlU5amFrcDZaVzVxVUhVeVprTk9jemgwVEd4UlUxZGtNWEZxYUZsQlVGSmlDbWg1TWpsUE1uQkdWRnA1ZVRkTldVaFdkWEJ2UjBoaWJsRjRPWEI0YkRSWVREbElUM001VGt0U1UzZG1UVFkwYTNZeFIyRk9NM0JZVHpKU1FXcFNXbkFLUm5wQlptZ3JWMVpVWkdwTVpXcHBWVWxsU2pFek4yTTNhM2czY2paT1JYbzFkVGRVVkZGSlJFRlJRVUpCYjBsQ1FWRkRjVkZDWW1kUFJtRkRhRmg0VkFwRmRVdEJUM05SSzNaTVRFTmtORVpQWlVaYVZXZGtTVFpWUnpSNWFuQlhOVVpYYlhKa1JVUlZkbmhWZFhKRVdTOVpNbGgzU0ZOVVIwcDRORkYyWWxsT0NtZHJjVXhzU0VwdVZYSTBVazlXVTB4V2NuUklkMHRWUWtkeWMwRlFVbUpIVjA5bGFGcDZNekpUTlZCWVduZElZV3R1UzBGdU5HTXdjRWxOZDB4TEsyWUtha0pMUlZsU09HcHVaeTlHYlRZeGJIUXpibmQyVjJJMmNHc3dVeTg1Um5Wck9DdEdOVGxxV1c1dVJrVkZXa2RoYUdZMlkyNXJhMmw1Vmt4TWRFRnpZUXBSVTJwclF6QnRWblZVUVV0c1VUTTVWRlpKZG1sRk5HOTRkVGxpU2xoU1drd3lWbXBYTURVM1IwOW1NVGxTUkhwdlkyVkxhakp3VmtSWVQwOTRjbVJwQ2t0R01XaENLMEZ6UlZsUGNTOTFkR1ZXWkRGdk9GSnliVWh3TUdOQ1NrNUlORzlMWkU1UVdUUklRMkpVT1hWVmNqQlpkazFRTm5oT1Vpc3JTakE0V1VjS2FrYzNWek16YjJoQmIwZENRVTE2WkVKbVppdFdVaXRNUlhsUlVtRlNaazF2Y1VVNVZHTjNhVTlHYzBnd1MzSlBWVTE1YjNwa05pOWFZMWM1Y20xeGVBcHNhRGxDWlN0WmJrcHhXVlYzVEM5UmREaHFjbEJNYVN0eFIyUTRkSEJRVW1WVWNGcFlaRXgzVHpKbmNrUkVNa2x2UWsxUVZYVjJNek14YkZWRFZuUndDbEpLWTNKMGVuZ3pTMGR0VlVSNlEwSk9lbEZtZUdobFZtaHJTVTlTVmpWeE4xZDVaVXhPWVZGYVVHZEdSRzVYYTNreEwzcERTV3hHUVc5SFFrRlBaemdLY0dJclkyVkZWM3BUT0V0MGNUZDVObTg1U21KbFMwMHZkVVZXZFhWTWNYSmlOek5aU1hwNE5tVTBUSFJFVFZKYVVreDJSVVpZTTJoV1ZFcFpNMmhOUWdwNlJUWkRXSGhEUTI1RVR6RkNRMnczWldaNGNTdFNjRlZZZEVWM1VuTkpjVlJ6TjBsUGNEaDRURVJDZDJ4MlNVdHdhV1ZWTldGWlEwNHZTbFJDTkV4dkNuUjZPRnBYVjFWek5WRnhXVFJRYVdod1UwczVWMVZVTlRsdWVFeEZVVVZRUTJ0amJrcGpOWEJCYjBkQlluWjFUMDFFZEc5bmFEUnNNRWhTWlV0eVlVSUtjRVJvUWpOVlZITnZkVkZ2T1RFcmRVSnFSM014WlRrMlozaFhkbFkzTWpsU2JFZEVabUoyV1VKRlJsbzJjRUkwUVVSRWQxSkhWMFprWjNKeFNHdHdkQXBGYkRnemNGQTNaMDFDTm1sRmRsQm9Va2hKV1hsb01FOXpjVmxGU3pkR2NuQjZibGh0Y205NUsyNDVjbVY1ZFVaaVNXVkxSMVo1TTNwNlJrMUJNSEZMQ2s1VU1qZHlUVWR6T0ZoQ1RERlJMMmd6WVd0alFuTkZRMmRaUVRKcVkwTldNRlZxUkdaemJrZE5iM1pOUzNJckt6Z3pVRlZVVjNsYVEzUm9hMHRWT1RNS1pHbFdXVEpMUkZrNFduZ3hTakE0Y0VkSVpTOHJWVmhPVEU5clJqVXZPRFZXYUVSRmVsSnRjVmc1VWxwa2EwMURhelZLZFhBdlJXRkVUa0ZwV0d4UWFRbzJWa0V3UVhoWlVsUjJSakppUWk4MU0yeFdVQ3RQWkhocGFWZFRhamswZWl0V01YaHJaV3N2TkhkbEswRkRURTVzVmswMlF6aHViVU55UVRBMGJtRlZDbTVzUzFsUFVVdENaMGMxY1RZd0syUjNWRk00ZW1ScEszVk9iVTlWWnpsWVYyUm5iVWQyV1RWVmRIbGlTbWRFZFhaTVZHZzFVR0kwZVRWWU1Wa3ZSVGtLZW1ORU1tVTNRMlpUTnpkRlZXOUNUVTFqYXpReU16Qk5ZblpLV1ZCQlFTdEVUWGRVY1dGR2FFcHdTemxsTjJOWVl6RmFhR3BuT1RselRUSm1RMUJrU0FwWVdrTlBTbUptYmt4dGF6TnFXa1JEV1V4Vk9GTklWbms1U0VWSlVVdEJTMkl3WVZwS1NuZDNhRFIwU2paU1ZEWXJOeTl2Q2kwdExTMHRSVTVFSUZKVFFTQlFVa2xXUVZSRklFdEZXUzB0TFMwdENnPT0=
---
apiVersion: v1
kind: Service
metadata:
  name: rocky-ssh-service
  labels:
    name: rocky-ssh
spec:
  type: NodePort
  ports:
    - name: rocky-ssh
      port: 22
      targetPort: 22
      nodePort: 30022
  selector:
    name: rocky-ssh
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: rocky-ssh
spec:
  replicas: 1
  strategy:
    type: RollingUpdate
  selector:
    matchLabels:
      name: rocky-ssh
  template:
    metadata:
      labels:
        name: rocky-ssh
    spec:
      volumes:
        - name: ssh
          secret:
            secretName: rocky-ssh
            defaultMode: 384
        - name: kubectl
          secret:
            secretName: rocky-kubectl
            defaultMode: 384
      containers:
        - name: rocky-ssh
          image: sjwayrhz/rocky-8.4:kubectl
          imagePullPolicy: IfNotPresent
          volumeMounts:
            - name: ssh
              mountPath: "/root/.ssh/authorized_keys"
              subPath: authorized_keys
              readOnly: true
            - name: kubectl
              mountPath: "/root/.kube/config"
              subPath: config
              readOnly: true
          resources:
            requests:
              memory: "512Mi"
              cpu: "500m"
            limits:
              memory: "1Gi"
              cpu: "1000m"
          ports:
            - containerPort: 22