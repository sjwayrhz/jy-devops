apiVersion: v1
kind: Secret
metadata:
  name: rocky-ssh
type: Opaque
data:
  authorized_keys: c3NoLXJzYSBBQUFBQjNOemFDMXljMkVBQUFBREFRQUJBQUFCQVFDdG1yQmZPRkxGOHRVQnlaTU5iUmtoQ3FyTHhQc2NJMUlBdnYvd2pKdXN0REVzdm40VzBXeHg3VUlzU0doQmJSa0JFM3BNanlOSnlseXFsa0ZpeHQ5b25HVGRTVk1kTnVBeEhTVHFWN241QjRaWFhtdVNUR25sMkRTS1lnT1NsZUNwYWtBSzE1VEJDbFBtMWFCMGMzUmh2c2Q2aXlNZlREOU1LR1hFTml0cG9rVG9PMFhTSk1VL25qcUVraEpjd1hUR0hYenRwaXRxc1ZuWEkvNEJVWXlhNlpZc21LQVNGd2FQbXBqdmpySThWMmVWVFM5YmFqRGg3QXA4WFM5ZDk2TlFZcUNVMkl1dGFZZXFNNy8wUzlWL2FDR2szTStLNXVsVkVwd2I1YnUyZmpkMUdURzBXYURQZHhaMThEYlhCWkVZcDJ3TmdZcHRSeDhEL0FNMzloVFQ=
---
apiVersion: v1
kind: Secret
metadata:
  name: rocky-kubectl
type: Opaque
data:
  config: YXBpVmVyc2lvbjogdjEKY2x1c3RlcnM6Ci0gY2x1c3RlcjoKICAgIGNlcnRpZmljYXRlLWF1dGhvcml0eS1kYXRhOiBMUzB0TFMxQ1JVZEpUaUJEUlZKVVNVWkpRMEZVUlMwdExTMHRDazFKU1VNMWVrTkRRV01yWjBGM1NVSkJaMGxDUVVSQlRrSm5hM0ZvYTJsSE9YY3dRa0ZSYzBaQlJFRldUVkpOZDBWUldVUldVVkZFUlhkd2NtUlhTbXdLWTIwMWJHUkhWbnBOUWpSWVJGUkplVTFFUlhoUFJFRjVUbFJyTVUxc2IxaEVWRTE1VFVSRmVFNXFRWGxPVkdzeFRXeHZkMFpVUlZSTlFrVkhRVEZWUlFwQmVFMUxZVE5XYVZwWVNuVmFXRkpzWTNwRFEwRlRTWGRFVVZsS1MyOWFTV2gyWTA1QlVVVkNRbEZCUkdkblJWQkJSRU5EUVZGdlEyZG5SVUpCVFdsc0NrbEpkblkyWWpGQ1VWcG1TVm9yWjBWdGJVWktUWFEyYmpCMVJWSkVVelJMVlV0TVl6bFVielJrUjNGMlNXVkpiazFPV0VkRmVFaE9jR1pMT1VsNGVWQUtWR2huU1dkdlpXOUhRMjVCY1RWeWFtcEtjR2RvTms1S2RqWlRWWHBYSzIwd2FFcDZWSGxDUzFocmFXdHJUSGxDV1ZBMFMzSXlSMnB3T0c1c05IVnRUZ3B4WlcxcFdHMDRLMjkwT1N0Q1FtZzFhamcxTUdaU01XcHJabE5KU1ZSUkwyUnNVMjVMZEd0d2NYSkxSak51UTFGUmFWVTBWelZyTTNsQlZIUnpVSEl6Q205VllsWnNNRVo2YXpoSVQzZE9WMXBpUnpVeFYwcE9RMnRLUlVObVUxZHVlRGxRUkdWb1dqbGtRekpGWm5CWVFWUm9kREJxUmpOUGJEQlFaQ3R2UzJ3S01ERkNkRnBsZVhGQ056VldZVzVSVUVWbVpXTlVPV2NyYTFoTWJFVjJRbVZaT0hrM2FEUjBOa2hqVkRscFQwaDBMM2hLTDNSMWVUaDViemc0YVZSNk9RcElUV2hUTWpGemRYQlJXalZvZW1oVk9GUnpRMEYzUlVGQllVNURUVVZCZDBSbldVUldVakJRUVZGSUwwSkJVVVJCWjB0clRVRTRSMEV4VldSRmQwVkNDaTkzVVVaTlFVMUNRV1k0ZDBoUldVUldVakJQUWtKWlJVWklNV3RCVVcxaFYweGpNbmR5VDBOb2RVSTJUa1ZIU0doUlYxWk5RVEJIUTFOeFIxTkpZak1LUkZGRlFrTjNWVUZCTkVsQ1FWRkRTbkZNUld4dk1IY3lTV3RQYzFKc2NWcFliMHRMVVVoNEwwSnpOMXA0ZDFkblJESXhTRTQwY1VsNFNFcFZNWGxXT1Fwdk5IazJRMFoxTDB0Uk1WSjFTVkp4Vnk5Vk5URTNOV1pDYVhSSVZtdDJlWGd4UTFONWNIbFNkbmhHUXl0dGFHZzBTR3RRU1dOSWVVdFdOMWg1YkM4eUNrRkdUelk1WkN0RlNEVlJUVWR3Tkc5TUwxbE5hbkZLYXpsSVNtRnBRMjl6TVVSbk9FRm5SMWRtUlRGUk1FZHpWamRLYjA1UFFWSldkemRHUzFaQlNIWUtiVTFDYm5ZdlJGZENVREF5WkRCWlZHSnNMMUZDUVdWSWNISnhiRTlYUVN0MVlrRm9VMk5OVEVrNFVURXdkaXRETVcxalJIVnZVVFVyYWpkSmMwNVhSZ28wZEVvM1pFMUZaVE53YjBNNGFWSldXV0YxUzFGNWNUZDBiV1JqT1hsUmFsTXhkMUl4Vm5CYVIxbFdNRk5yVDFGNFMzRmxkVzh2Tm5CNVRXUkJlbWhpQ2xORldtbENRMDV6YUZOcVdFcGxSMGx4VjFCV1QzbHBhVXBVYW5OaU9GY3JRamhVTndvdExTMHRMVVZPUkNCRFJWSlVTVVpKUTBGVVJTMHRMUzB0Q2c9PQogICAgc2VydmVyOiBodHRwczovLzEwLjIyMC42Mi4zMTo2NDQzCiAgbmFtZToga3ViZXJuZXRlcwpjb250ZXh0czoKLSBjb250ZXh0OgogICAgY2x1c3Rlcjoga3ViZXJuZXRlcwogICAgdXNlcjoga3ViZXJuZXRlcy1hZG1pbgogIG5hbWU6IGt1YmVybmV0ZXMtYWRtaW5Aa3ViZXJuZXRlcwpjdXJyZW50LWNvbnRleHQ6IGt1YmVybmV0ZXMtYWRtaW5Aa3ViZXJuZXRlcwpraW5kOiBDb25maWcKcHJlZmVyZW5jZXM6IHt9CnVzZXJzOgotIG5hbWU6IGt1YmVybmV0ZXMtYWRtaW4KICB1c2VyOgogICAgY2xpZW50LWNlcnRpZmljYXRlLWRhdGE6IExTMHRMUzFDUlVkSlRpQkRSVkpVU1VaSlEwRlVSUzB0TFMwdENrMUpTVVJKVkVORFFXZHRaMEYzU1VKQlowbEpVRFJ0VW0xU1JIRlRNRTEzUkZGWlNrdHZXa2xvZG1OT1FWRkZURUpSUVhkR1ZFVlVUVUpGUjBFeFZVVUtRWGhOUzJFelZtbGFXRXAxV2xoU2JHTjZRV1ZHZHpCNVRXcEJlRTFVWjNkTmFsVTFUbFJLWVVaM01IcE5ha0Y0VFZSWmQwMXFWVFZPVkdoaFRVUlJlQXBHZWtGV1FtZE9Wa0pCYjFSRWJrNDFZek5TYkdKVWNIUlpXRTR3V2xoS2VrMVNhM2RHZDFsRVZsRlJSRVY0UW5Ka1YwcHNZMjAxYkdSSFZucE1WMFpyQ21KWGJIVk5TVWxDU1dwQlRrSm5hM0ZvYTJsSE9YY3dRa0ZSUlVaQlFVOURRVkU0UVUxSlNVSkRaMHREUVZGRlFYcFpTM2RRVTJoVVlUaEJZMk5sVkc0S1YzUkdTMk5VVGxFd1dUTmxSMW80ZHpoVmRqUlNTbnAxWWswMWEyaDZZM1ozYVRSSWNXSkZkamR3VEdRMVZYUllNRUYzUnpCUmJGTk1SRFZrY1hJMWVBcFZTMFJpU2s1bk5YSlliR1ZpVVhnemQwWTBUREV2T0dSMWVHY3plbUV6TW01V01Fc3piVzVWV0cxeWRESjJZbGc1TlVwRWRtUXhTMGt3V21aWlRrMW5DbmxGWm5CWmVqUk5LMjFuUTBSbmVqTkxaRWhWZERSc1pqaDFaVEozT0ZsQmNWUnlSMGcxWjI1a2Nqa3JZazR6YzBSRVlpdHdlVmgyWkVoTVFVbDBNVU1LWTI1a01VaFVVMUpvVTFwdGJqbEdNMjVOT0VjMFFUZE9RVVprWjJOV01qbFpUM1lyVEhkRVJFeEhUelkwWVc1dFowSTFVbmxhYlZZd1dHZFRlVWg2V2dwS1VWZDJaRWxTZHpSaWFFZFpWbkprUTBOaWFtNWpaV1Y2U2s4MGVqVnRNbHBSTm1VMVQydHlZWEZhZVZvemNFWldWM1V2TjFsalUzTklkMWR3VTI5V0NsZHVjV0pvVVVsRVFWRkJRbTh4V1hkV1JFRlBRbWRPVmtoUk9FSkJaamhGUWtGTlEwSmhRWGRGZDFsRVZsSXdiRUpCZDNkRFoxbEpTM2RaUWtKUlZVZ0tRWGRKZDBSQldVUldVakJVUVZGSUwwSkJTWGRCUkVGbVFtZE9Wa2hUVFVWSFJFRlhaMEpTT1ZwQlJVcHRiR2t6VG5OTGVtZHZZbWRsYWxKQ2FEUlZSZ3BzVkVGT1FtZHJjV2hyYVVjNWR6QkNRVkZ6UmtGQlQwTkJVVVZCVm1JMmNEQkdjME13SzJSRlNscE9TMWxwUlZVd1NGZFNhRlJJUzNwV1ZIQllTMDB5Q2tOMGJuTmljWFEzTDA4d1kxUk5MMk41V0ZSVWNqWmFSRWhVUm13d1FqWnpVWGw0UkdwclNXMVFTRGxuTVRWUmNFZGFUbTVWZG5oT09HeHVZMjQyWnprS2NrMXZkMWh1TUZGak9HTlVNamRzZUdOWGRuTlhVMmhaZEhsbFIxcEthRTVOTUhaRlNWSTFWMHAwWlZwMFdEUldiMVZ6T0UxaUwwRkhkMEYyVkV0RFJBcGliVkZwY1ZoMmRHTmpiVkE0T1hGYWJsRmtVVGxpY25KbmQydEJRbmx3TWxoV2RUZGlhMFZ0VWtaSFEwdHNOWG92Y21oWGJqUm9WamhNYzFkQ1FVNHZDbFpVYjJZMmFsUllPRVo2U3paVGVFZEhVa0ZVUm1nNVFubFVPVElyVG5FeU5EZFFlVWRTTVhwbk0xVTJPSFExTDNKT1pGZGhlWEUxTDJWb1VUQkJjWFlLUjAxd2FsaENOVTlGU2tsS01DdEZlVUl5Vldkd01HNHpZMjgzTVdSck0yVjNNM1JwZG1oVE5sSkdTbkJyYUVsak4wRTlQUW90TFMwdExVVk9SQ0JEUlZKVVNVWkpRMEZVUlMwdExTMHRDZz09CiAgICBjbGllbnQta2V5LWRhdGE6IExTMHRMUzFDUlVkSlRpQlNVMEVnVUZKSlZrRlVSU0JMUlZrdExTMHRMUXBOU1VsRmNFRkpRa0ZCUzBOQlVVVkJlbGxMZDFCVGFGUmhPRUZqWTJWVWJsZDBSa3RqVkU1Uk1Ga3paVWRhT0hjNFZYWTBVa3A2ZFdKTk5XdG9lbU4yQ25kcE5FaHhZa1YyTjNCTVpEVlZkRmd3UVhkSE1GRnNVMHhFTldSeGNqVjRWVXRFWWtwT1p6VnlXR3hsWWxGNE0zZEdORXd4THpoa2RYaG5NM3BoTXpJS2JsWXdTek50YmxWWWJYSjBNblppV0RrMVNrUjJaREZMU1RCYVpsbE9UV2Q1Uldad1dYbzBUU3R0WjBORVozb3pTMlJJVlhRMGJHWTRkV1V5ZHpoWlFRcHhWSEpIU0RWbmJtUnlPU3RpVGpOelJFUmlLM0I1V0haa1NFeEJTWFF4UTJOdVpERklWRk5TYUZOYWJXNDVSak51VFRoSE5FRTNUa0ZHWkdkalZqSTVDbGxQZGl0TWQwUkVURWRQTmpSaGJtMW5RalZTZVZwdFZqQllaMU41U0hwYVNsRlhkbVJKVW5jMFltaEhXVlp5WkVORFltcHVZMlZsZWtwUE5IbzFiVElLV2xFMlpUVlBhM0poY1ZwNVdqTndSbFpYZFM4M1dXTlRjMGgzVjNCVGIxWlhibkZpYUZGSlJFRlJRVUpCYjBsQ1FVWjROMFo2ZDNWVVdIZE1jemhGT1FwT1V5dFdVakUyZUhKUmFtZFJjbHBrUVZCV1ZreHhRVko2ZFd3dk5UVldRbkpIYUVKMGIydFRhRE5PWnk5RFNWaFRZV3REUVVnNVNrcHZWbkZsTVZFckNqVXhaRlpUT0dwRk1WRXZVSE5yU2pSbVpITXZaSGw2TkZSVVZFbHlWRkZPZFZKRlVITmlhSE12TTJsT2RtZFFkbGRVYVRkNFYyaElhMUJzVjNwak1GRUtkRmwyY21OSlpVMW5UMHRsY3pJMFNGQTJTeXRJYlN0S2FtNW5UVW8wVjJ4dlN5OWpUQ3RCU21KcFUzcFZVVEo2UzI1aVJXWk9kek5hVEdWSWFYUnZTd3A0Y0dwME1YVjVjRVZUU0d4cVVWTjNNSFpQV21WdFRXY3dUM1Z6TldneEx5dE9lbVpSUXk5WlFreEhUWGhaWjFOTVQxSnpaemxPYkdzdlpXUllWbTFQQ2tzeloyUjFNM1o0TW5Od1psbzJkMHgyVjNOYVVUTTFTVUpHSzFacFZsYzNVR1J0ZURWVk1GSnphRWhhVlhkaE4zQm9ibEFyWTBSWk9VWktTRFJWUjBzS1NtTldkVVJCUlVObldVVkJOM0JRTjJoVlJ6SnhNemhOY205eVpIRkphVFpOV1VZMUswRmhhbmRpU20xVGIybExLMVJ4Ym5aYVJYTldUamgyVlVsTFZncEpTa3R0UW5CWlNXMVljbWRTZURaWWFYQm5jVk5ZWlV4WU16aHJaa3RqWm5Sck5rUkhka05XYTBoVFFWZElha0VyZVZodFZFZEdhVzlqYlRCV1pGbHhDa1psTTJGc1YxTmFjM01yZUROb1psTjRjRVZJVDJSbmVESm5hMjVLZUdwa2FtNW5ZVE5HYkVrMVFtSkZhSFp0UVZOaE4zcG1PRVZEWjFsRlFUTkpVMG9LU0dOb2NWbE1ielpMT0VOVFkyOTBNVzl1T1M5aWRqUTBSVEE1U3pWMk1HWjNkRU5FUWs1c0t6RkZhaXRPY2t0NE15dG9SWFZsWkdwVmMxRnVPVUl5ZWdwMFRWZzJXRXRNTkc5YVNUUnViMjVIZFRseVkxQnljblpXVTFKMVJFczBRbTVSVG1sQ1ZXTnhObkp5Wm5SVFVIWlFkbWc1YzFGS2EzVlZUakJQZW1Jd0NuaGpXRXh1VVdWRlVVSm1NbVpDWTBrM2RUQTRTMmRXTmpkNVRETTRSVU0yUm1admMxUk5WVU5uV1VWQmJtSlJlVk5qWWtSamFDdGphVmN2TDNvMWVqVUtkbmx1UVV4NVVuTmpUMmd4VmpSV2EyOUNVMWQwZFdSVmNqVkhUVmhEVEVaWmRTdDBWV0ZOZUdObmNsbFpRWEZ1ZWpWVFFVNHliMUJPWjFBNFdWY3llZ3AwTjFjd1ZXdFhRVU5EYjB0blVFUndWamx4V1c1b2NYUnpVbG80TXpGVFprbDZia1ZEU1dGclZuQXJWME54U1drd1QwVnFUSEZvY2xrMU5IcFNSbEJoQ21WSlpVbzRaV2RRUmpjMk5VVkRUM3BIYjBoTlRXTkZRMmRaUlVGcVNtcDNUalEwUm5wVlFsQlJTVUZoYmpJcmRHY3ZjbGxxUkUxSlJ6Y3JkRzFTVFVFS1oyaDVhSFpMUkZScVdsRjNhVlF4Y25waUwzZDFZbkl2UWpsR1RGUkJhalJCUTFaUFYwZDNUVXhETDI1aE5sZGhhMVZIWTNSV05VbHdSR1ZET1hoRGJRcDBTelZ2WlRoalFscFJTR0pEYTI5elEzcEZlVXR1TjBaTE5UUklZVWt6UldsTGFIaENkVU0xUVVscFIzWnNNazVqTlVSTmEwWndTVXBHY0dWVVRUbHZDa1puVlZrME5sVkRaMWxDZW1zd1ZEbHVXWGxJYTNKTkx6WjZTa3RLYzFaU1YxUnlWbVEzWTNkM1ZraFNNelZXT1VvMlJrRlRPRE16WVU1QlExZ3lXbFFLYWtKMVIwbE9URVZSUmtwTmVscG1kRmhtUWxsTU1YcHNPRk1yWjFkb1NraHdPWGh6Y1dKRmFuTXlSRGd2SzFaMVIzRlhabGh4Y2t0MU9GbHZSM0ZyS3dvMVFVSlJSMXA0YzFGelZFSlJSVlY1VG1kYU0wdFBNRGxJUm1jeGNUY3liVEE1TUZSdWVYRXhZVThyY1hkdU1ETjBiMkp3V0djOVBRb3RMUzB0TFVWT1JDQlNVMEVnVUZKSlZrRlVSU0JMUlZrdExTMHRMUW89
---
apiVersion: v1
kind: Service
metadata:
  name: rocky-ssh-service
  labels:
    name: rocky-ssh
spec:
  type: NodePort
  ports:
    - name: rocky-ssh
      port: 22
      targetPort: 22
      nodePort: 30022
  selector:
    name: rocky-ssh
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: rocky-ssh
spec:
  replicas: 1
  strategy:
    type: RollingUpdate
  selector:
    matchLabels:
      name: rocky-ssh
  template:
    metadata:
      labels:
        name: rocky-ssh
    spec:
      volumes:
        - name: ssh
          secret:
            secretName: rocky-ssh
            defaultMode: 384
        - name: kubectl
          secret:
            secretName: rocky-kubectl
            defaultMode: 384
      containers:
        - name: rocky-ssh
          image: sjwayrhz/rocky-8.4:kubectl
          imagePullPolicy: IfNotPresent
          volumeMounts:
            - name: ssh
              mountPath: "/root/.ssh/authorized_keys"
              subPath: authorized_keys
              readOnly: true
            - name: kubectl
              mountPath: "/root/.kube/config"
              subPath: config
              readOnly: true
          resources:
            requests:
              memory: "512Mi"
              cpu: "500m"
            limits:
              memory: "1Gi"
              cpu: "1000m"
          ports:
            - containerPort: 22