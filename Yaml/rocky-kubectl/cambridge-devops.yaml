apiVersion: v1
kind: Secret
metadata:
  name: rocky-ssh
type: Opaque
data:
  authorized_keys: c3NoLXJzYSBBQUFBQjNOemFDMXljMkVBQUFBREFRQUJBQUFCQVFDdG1yQmZPRkxGOHRVQnlaTU5iUmtoQ3FyTHhQc2NJMUlBdnYvd2pKdXN0REVzdm40VzBXeHg3VUlzU0doQmJSa0JFM3BNanlOSnlseXFsa0ZpeHQ5b25HVGRTVk1kTnVBeEhTVHFWN241QjRaWFhtdVNUR25sMkRTS1lnT1NsZUNwYWtBSzE1VEJDbFBtMWFCMGMzUmh2c2Q2aXlNZlREOU1LR1hFTml0cG9rVG9PMFhTSk1VL25qcUVraEpjd1hUR0hYenRwaXRxc1ZuWEkvNEJVWXlhNlpZc21LQVNGd2FQbXBqdmpySThWMmVWVFM5YmFqRGg3QXA4WFM5ZDk2TlFZcUNVMkl1dGFZZXFNNy8wUzlWL2FDR2szTStLNXVsVkVwd2I1YnUyZmpkMUdURzBXYURQZHhaMThEYlhCWkVZcDJ3TmdZcHRSeDhEL0FNMzloVFQ=
---
apiVersion: v1
kind: Secret
metadata:
  name: rocky-kubectl
type: Opaque
data:
  config: YXBpVmVyc2lvbjogdjEKY2x1c3RlcnM6Ci0gY2x1c3RlcjoKICAgIGNlcnRpZmljYXRlLWF1dGhvcml0eS1kYXRhOiBMUzB0TFMxQ1JVZEpUaUJEUlZKVVNVWkpRMEZVUlMwdExTMHRDazFKU1VNMWVrTkRRV01yWjBGM1NVSkJaMGxDUVVSQlRrSm5hM0ZvYTJsSE9YY3dRa0ZSYzBaQlJFRldUVkpOZDBWUldVUldVVkZFUlhkd2NtUlhTbXdLWTIwMWJHUkhWbnBOUWpSWVJGUkplRTFVUlhsTmFrbDZUbFJOTVU1c2IxaEVWRTE0VFZSRmVVMUVTWHBPVkUweFRteHZkMFpVUlZSTlFrVkhRVEZWUlFwQmVFMUxZVE5XYVZwWVNuVmFXRkpzWTNwRFEwRlRTWGRFVVZsS1MyOWFTV2gyWTA1QlVVVkNRbEZCUkdkblJWQkJSRU5EUVZGdlEyZG5SVUpCVGxWbENrNURkMEphVVhvMmMxRnZTbXR4VWpkV0sxSkNlSGxYY2pSd1N5dGFUa3gyZG1nMmFWVkxTVnAzTDBWSWNYY3pTMnM0TjI1R1FWZ3hNbHBTYUhGT1F6UUtlSEFyYWpCb2J5dEVhbFpPWm1GWVlsbHlkVk5QVHpWSGRXWktRVzFOV0UxNE9YRXJiWEZDUldNNVluRjBSaXQ2VVZKMU9XbFpXUzg1VFVsS00wcEZVUXBOV0U1bFEzTnJhVWxMSzJwcFpEQkdRWEk1Y1c4eWNHUklXbmhxU25OVFJqZGxiV1pyVTFKMWFISnhTUzh5V0RKMVYzcHVhME0zTkZveGNFUlhZMjFhQ20weFVIRTBVbE4zV0N0WFdVSnlibkJoU3pJM1ZXODFaVWRIVFVwbFUyYzVUblZDUjIxamRUWktPRmhxVWs1dlJFVmtURGd4TVRGSWJFY3ZVMHhqYzNvS00wUnRlRFV5U0V4TVFuZEtlblJXY1hWRGRYWmFRa2RxTW1kWldVMURabUowSzJOMlJqUklSR1Z0ZURaeVIwTjJTMDAxUlV0RmNYbHNTVE14WmpFM1NRcE1hMGRaUkVzNUwyWXhXRk5sVkRGekszUmpRMEYzUlVGQllVNURUVVZCZDBSbldVUldVakJRUVZGSUwwSkJVVVJCWjB0clRVRTRSMEV4VldSRmQwVkNDaTkzVVVaTlFVMUNRV1k0ZDBoUldVUldVakJQUWtKWlJVWkVhR1JzUVhSNlMyeE9SM2ROY1V3M1dVUlFVRzFsT1dneGEybE5RVEJIUTFOeFIxTkpZak1LUkZGRlFrTjNWVUZCTkVsQ1FWRkRXWFJVUVZSck9ERTNWSFpoVGxSUWJuWXhWMWxpTjJsME1IaHFOVzByVVZkaU4yUTRSRGt2U1dGM1lUTnFjV0ZUTUFwMmRsbHVhM292UzJJMFFYaHpjek40WmpOeFdUQjZOSEZyYlVSMlkyaERVekJHU21abU9EUTBSWGRJTW5oNk1tTkpSbmRaVEd4bWFXVmlXSEpTTUhsV0NrOTFWRXRUU0doMVJuWTVhblZLYTB4eGNrZEVVR1ZvU2xoNU5YQm1URU0wTlRkdFYzZFNlQ3RaYWxrd2FuQm1aRmxPVUZGWmFHaEtaSGxUZERoSVVuZ0tNR2wzTkVRMlUwZGlkRkJZZVc1VFEwUnROM1ZOZDBkQlZpdE5Ua3g0ZEUxUFIyUkxWSFZWVFhkeE1GQkRaV0ZpT1ZGYU5rSm1aRzRyVWxvMFZuUjZWd3BHT0dkQ1VESkRRMjlhY3pObFlWbFVWekZJWjBOSlRHSnlPR3czZVRsME9YZG5SVE12YVhWdVZrUnhabGh4TTBGSGJrSnlNbTFCZFdJMk4yWXJlRzh5Q2tOcVMyRTBjV2xZVVRrNU1WTnVTVTVEVTNRNE5uVkZMM2RYTkhGUFpHRjFiRkUxTXdvdExTMHRMVVZPUkNCRFJWSlVTVVpKUTBGVVJTMHRMUzB0Q2c9PQogICAgc2VydmVyOiBodHRwczovLzEwLjIyMC42Mi4zMTo2NDQzCiAgbmFtZToga3ViZXJuZXRlcwpjb250ZXh0czoKLSBjb250ZXh0OgogICAgY2x1c3Rlcjoga3ViZXJuZXRlcwogICAgdXNlcjoga3ViZXJuZXRlcy1hZG1pbgogIG5hbWU6IGt1YmVybmV0ZXMtYWRtaW5Aa3ViZXJuZXRlcwpjdXJyZW50LWNvbnRleHQ6IGt1YmVybmV0ZXMtYWRtaW5Aa3ViZXJuZXRlcwpraW5kOiBDb25maWcKcHJlZmVyZW5jZXM6IHt9CnVzZXJzOgotIG5hbWU6IGt1YmVybmV0ZXMtYWRtaW4KICB1c2VyOgogICAgY2xpZW50LWNlcnRpZmljYXRlLWRhdGE6IExTMHRMUzFDUlVkSlRpQkRSVkpVU1VaSlEwRlVSUzB0TFMwdENrMUpTVVJKVkVORFFXZHRaMEYzU1VKQlowbEpVbGxaYkN0T2VXZFZlbFYzUkZGWlNrdHZXa2xvZG1OT1FWRkZURUpSUVhkR1ZFVlVUVUpGUjBFeFZVVUtRWGhOUzJFelZtbGFXRXAxV2xoU2JHTjZRV1ZHZHpCNVRWUkZlRTFxU1hsTmVsVjZUbFJhWVVaM01IcE5WRVY0VFdwQmVVMTZWWHBPVkd4aFRVUlJlQXBHZWtGV1FtZE9Wa0pCYjFSRWJrNDFZek5TYkdKVWNIUlpXRTR3V2xoS2VrMVNhM2RHZDFsRVZsRlJSRVY0UW5Ka1YwcHNZMjAxYkdSSFZucE1WMFpyQ21KWGJIVk5TVWxDU1dwQlRrSm5hM0ZvYTJsSE9YY3dRa0ZSUlVaQlFVOURRVkU0UVUxSlNVSkRaMHREUVZGRlFYbFdNRGR0TWxFdlluRnJURTlIWkRBS05HNTBjMlpHUldGT09VdEtZVTVOT1RRd1luRmFUMWszZUVwUVMyeG1kakkwUjAxb2NESmhjM0ppY0ZsTmNFMTJlbVo0YTFoc2JtcDVaR1ZRUmk5b2RncG5TMmxETWtZeVZpOUpSbkl2SzFKQlJqSTJjME5vSzIxaVJEaGFhbXREWVZKMFEzTlJka3h6VDFOaFZEUTBiVkI1TkZOSVRFZFhia1ZQYWtaVFJFTnlDbWxVT1UxTk1tRndZbkI2UVcxblZsQnBNV00yTm5SM1JrcDZkWFUyWms1WFVFWkxheklyT1RSNmMzQnhUR0YwYkRGaE9VZEljRGhJUzB0ck5GSkpVVUlLUnpOMWRGWkxaMGhFWXpOT2QyOTFUakpQTkN0SlNqWkRkV05GVDNWM1VGZE1UalVyYVdaVFFUUXlNRGNyYmtSVFJFeG1jU3RpZEhKR2QzUlpkR2hTT1FweFdFOTZSMkZUVlRCbmVHdE5ZaXN5UkRaU2MzTkNLMVpIZGtaMFJtZHRhblpwY0ZJdmFWcHBkVmhLU0Uxd1RXOVliR2xzVTA5VlJGRndiR2w1WVVwd0NrVmlNa1F3VVVsRVFWRkJRbTh4V1hkV1JFRlBRbWRPVmtoUk9FSkJaamhGUWtGTlEwSmhRWGRGZDFsRVZsSXdiRUpCZDNkRFoxbEpTM2RaUWtKUlZVZ0tRWGRKZDBSQldVUldVakJVUVZGSUwwSkJTWGRCUkVGbVFtZE9Wa2hUVFVWSFJFRlhaMEpSTkZoYVVVeGplWEJVVW5ORVMya3JNa0Y2ZWpWdWRsbGtXZ3BKYWtGT1FtZHJjV2hyYVVjNWR6QkNRVkZ6UmtGQlQwTkJVVVZCYW1SdWVqbExWVU14UTNvMWNHazBTWEpKYm0welFTdEtNak0xU0VzNFVXdHRORTlTQ21oQ2NEVm9hV1ZKTWxaSGJGSkJhV0ZXZFdGMk9XcERZVVJHZEZsaE1qZG5NVFZCWmpOUk5HdGhSamR2Y0c5NE0yaFFNRlU1UjIwcmFYSlhaM0ZWZEZrS2NFOHdaMHg2ZVVONFUyZ3JTalF5VGxneFUwaFNWa3BEV1d4eU56QlVZMmw2Y0RaRmVHdE5OV0UwU2xKeVZrSktaRmx0VXpsbVJWaExkV2xHWm1SVFlncHhZMFprYkM5R1ZISlJLekIxVVVsSlZrMWhibU5KTkZSWlpXTkVPRlpKT0VkSE9XSnRkV2xaY1dScVFqRkNTRE41UkU1b2FtaG5XR2RCYUN0YVpVNHZDbXBUUjJ4blV6a3pSbWQzVG5sMFNXUTVUSGx1T1ZSSlVERTBiR3BXYWxsU1dHWk5PSFE1TW1Vd1JXdG1WVXBVT0dkNlZsTlJaMUYzY1hkQlozQlhjRWNLVEZobVExQXpSSE5JU0hadFNHRkNObGRCUzNWa2RISjBZMjVUWWtOV1MzVkJlUzl1VlU5SFZqTlFSakJvTVVGb1ZHYzlQUW90TFMwdExVVk9SQ0JEUlZKVVNVWkpRMEZVUlMwdExTMHRDZz09CiAgICBjbGllbnQta2V5LWRhdGE6IExTMHRMUzFDUlVkSlRpQlNVMEVnVUZKSlZrRlVSU0JMUlZrdExTMHRMUXBOU1VsRmNGRkpRa0ZCUzBOQlVVVkJlVll3TjIweVVTOWljV3RNVDBka01EUnVkSE5tUmtWaFRqbExTbUZPVFRrME1HSnhXazlaTjNoS1VFdHNabll5Q2pSSFRXaHdNbUZ6Y21Kd1dVMXdUWFo2Wm5ocldHeHVhbmxrWlZCR0wyaDJaMHRwUXpKR01sWXZTVVp5THl0U1FVWXlObk5EYUN0dFlrUTRXbXByUTJFS1VuUkRjMUYyVEhOUFUyRlVORFJ0VUhrMFUwaE1SMWR1UlU5cVJsTkVRM0pwVkRsTlRUSmhjR0p3ZWtGdFoxWlFhVEZqTmpaMGQwWktlblYxTm1aT1Z3cFFSa3RyTWlzNU5IcHpjSEZNWVhSc01XRTVSMGh3T0VoTFMyczBVa2xSUWtjemRYUldTMmRJUkdNelRuZHZkVTR5VHpRclNVbzJRM1ZqUlU5MWQxQlhDa3hPTlN0cFpsTkJOREl3Tnl0dVJGTkVUR1p4SzJKMGNrWjNkRmwwYUZJNWNWaFBla2RoVTFVd1ozaHJUV0lyTWtRMlVuTnpRaXRXUjNaR2RFWm5iV29LZG1sd1VpOXBXbWwxV0VwSVRYQk5iMWhzYVd4VFQxVkVVWEJzYVhsaFNuQkZZakpFTUZGSlJFRlJRVUpCYjBsQ1FWRkRhbUpyWXpsMFNubEVURlJLVGdwSmFreE5lWGN6WlhwR2FIbE1ReXRaV1RkTVkweDVaRFJ2ZVVOd1UwdGFjRWQxY0doaWFsQllWVlU0WmxwYWJrWXlielF6UzJZd2QxVjBZVGxqU0ZoVkNrbzNRV2RDVTFSR2FGSmxRbkpITVVOalJHWlJhazlQV0VJNU9HdENaMkYzTTFOQllVUTJNWGRZVVdRMmVubFFRM3BzYUd3dmRtUlVRVzFKV2t0RlRrOEtaSGx2VTBvNGVYQXZNRE5QTVN0NUsxWlZZMlJQWW5jMEswVkJObVZTVkUxV1RrUlNVR295Wmk5R2VreDNZaXMwTkdSVlMwRjZRazU1T1ZSNVVYWXJOUXBXWTNCSGNHVTJUMWxwWnpJMVJVZEpSell4TVZVNFdrVnhZVkJrWjBFdmJubFBXRGQxY25GV2QweFNVMDl2WjBVeU1Xb3dLMlZ6Wm1JM0wyVnpkRFJqQ2xCTk5HWTNZV2xyZWxscWJFdElNalo0Ym1sVFdqTjBMMDFET0c5dU0xcGlkRzFPTms5cWJ6aFFNbEV4V2sxMFoxQjFOREZNUTNKdlVIQmliV3BNZG5rS2MwcFpTbVJ3VnpsQmIwZENRVTE1VVdaTFVsZDRhVkZTVDNSc05uWTBSbEpJSzFoWlVVMVJNVzVETVZsTEszSmtMMVpJYkVzd1FrNW1SR016TmtwWlNRcFpOVVJyU1hSSlRrTkdTVWdyZUc1cE1tWm9SVlJoY2pobE9GUTRXRnBCVkRJemJUZHBTV05WUmtKQlNqbGlWMHRYU1haVldGUjVSVFV5ZDBaV2RIWmpDbU5IWmpOVFoycEdSa1pWVWt0YVdYSlpSbTlqTldoSVdFSXhWekkzYzNSa1JtWjRNMkprU1RWcFNFTXhiamczTlhwaldUaERSVE5JUVc5SFFrRlFkaXNLZDAxWlJHMTBTbkZ3UTJsbWNrbEVZM3B3VkhWalJWZDVXVUZVYTNrMGVURkJTSEp3TlRSdWFFcHhjelpyY2tOWVNYYzJXbTQzUTFoRVoxaFBaRzlZTWdwU1p6Rk9XbGN4ZEUxNmJpdHVkWGw1T0VwYU5VNUdkRXRRYVdWM05qTnJWUzl0Tm5aQk5qVkZjVmhWUVhaVGJGVjVlbXcxUVd4c2VuRklZMEZrZG5aaUNqbEdZVlZFYjJjdlRqRm5TRlpuYUVoQlRrMWtUMjV2Ums5VE4xUTNLemxVWkhSSlZEQjNSMjVCYjBkQlYwdFRNM3ByVEc0ME5VMTJla1JRTjNKc04yOEtSWEZLZFVac1oyY3dRMnh2UW05UGFHeFJOVmxsY1c1YVJFNXBSMU5vVm1sb09WQkZTSFlyVlhadE9VVTJWV1UzUzI1RU1uTjNVbkkwWTFZeVEyTjNRZ3BFUkZGMWFXeEplVU15TURGamVrSTNRa1ZVU0VSclYwNVFkWEpzV1RaeFdHSjNXR2x4UVVFeWRXeEpVV3RyYkVSdVIycDJZbGxYWmxsUk5DOVdhRXRHQ2xJemVUbE5lRGRLVDBGWlRVNVNWbU5xVHpGUmNqbHpRMmRaUlVGclZ5c3lWWEJLUTBOTE9FUnFNalpaV1UxalVHTXlWWEExZHk5TU1uZGplR013VVVRS2QzVjVPR1JTWXpncmFGbFZSVEZqYmtwSldVWmFRMWhMVFdjck1qSkNiMHN4UTB0WVNqRkRaa0ZDYlRCSU1tZHRPSEpIUWxKcE4xUk5TbFZ5VldaaFRBbzBaRmRuYVdwUFYyMWlRMVJtUVdNd1VYcGtWRFE0ZVdOeWFFaFhiV2RYV1ZBeEt6QkJNalUwZDNCV05WVmpNbTgzUXpoNVZVeHZla0p3VUV4S2NGWkdDbEJ1YlhscWIwVkRaMWxGUVhodWNFdHBUV3RCVTNoYVJtOTZXV1pzYjFBeE1rY3JTV0ZOUlRneE5YVnNXVEV5UlhGbFNHWTVUbTF6UmpaTk4yaExRelFLWkZOUUsyVlhTWHBEV2tWdmNHeHdPRkZWTUZRclNrdFNVMVZyYVVKSlpTdFFSa2xTZW1rMFFuZENlakoyUkdjMlVGQllRV0UxTDJaS1EwRkdkMjF1TmdwTVEwbEhMemh1TDBObFVFRnhNaTkzU25ScVJVZEpUV0V5Y0hJNVRqZEZVM05PZFRWTFRXRkdabE4yVGxSMFlYcHVVMnRhU1RCWlBRb3RMUzB0TFVWT1JDQlNVMEVnVUZKSlZrRlVSU0JMUlZrdExTMHRMUW89
---
apiVersion: v1
kind: Service
metadata:
  name: rocky-ssh-service
  labels:
    name: rocky-ssh
spec:
  type: NodePort
  ports:
    - name: rocky-ssh
      port: 22
      targetPort: 22
      nodePort: 30022
  selector:
    name: rocky-ssh
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: rocky-ssh
spec:
  replicas: 1
  strategy:
    type: RollingUpdate
  selector:
    matchLabels:
      name: rocky-ssh
  template:
    metadata:
      labels:
        name: rocky-ssh
    spec:
      volumes:
        - name: ssh
          secret:
            secretName: rocky-ssh
            defaultMode: 384
        - name: kubectl
          secret:
            secretName: rocky-kubectl
            defaultMode: 384
      containers:
        - name: rocky-ssh
          image: sjwayrhz/rocky-8.4:kubectl
          imagePullPolicy: IfNotPresent
          volumeMounts:
            - name: ssh
              mountPath: "/root/.ssh/authorized_keys"
              subPath: authorized_keys
              readOnly: true
            - name: kubectl
              mountPath: "/root/.kube/config"
              subPath: config
              readOnly: true
          resources:
            requests:
              memory: "512Mi"
              cpu: "500m"
            limits:
              memory: "1Gi"
              cpu: "1000m"
          ports:
            - containerPort: 22