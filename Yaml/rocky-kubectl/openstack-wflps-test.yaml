apiVersion: v1
kind: Secret
metadata:
  name: rocky-ssh
type: Opaque
data:
  authorized_keys: c3NoLXJzYSBBQUFBQjNOemFDMXljMkVBQUFBREFRQUJBQUFCQVFDdG1yQmZPRkxGOHRVQnlaTU5iUmtoQ3FyTHhQc2NJMUlBdnYvd2pKdXN0REVzdm40VzBXeHg3VUlzU0doQmJSa0JFM3BNanlOSnlseXFsa0ZpeHQ5b25HVGRTVk1kTnVBeEhTVHFWN241QjRaWFhtdVNUR25sMkRTS1lnT1NsZUNwYWtBSzE1VEJDbFBtMWFCMGMzUmh2c2Q2aXlNZlREOU1LR1hFTml0cG9rVG9PMFhTSk1VL25qcUVraEpjd1hUR0hYenRwaXRxc1ZuWEkvNEJVWXlhNlpZc21LQVNGd2FQbXBqdmpySThWMmVWVFM5YmFqRGg3QXA4WFM5ZDk2TlFZcUNVMkl1dGFZZXFNNy8wUzlWL2FDR2szTStLNXVsVkVwd2I1YnUyZmpkMUdURzBXYURQZHhaMThEYlhCWkVZcDJ3TmdZcHRSeDhEL0FNMzloVFQ=
---
apiVersion: v1
kind: Secret
metadata:
  name: rocky-kubectl
type: Opaque
data:
  config: YXBpVmVyc2lvbjogdjEKY2x1c3RlcnM6Ci0gY2x1c3RlcjoKICAgIGNlcnRpZmljYXRlLWF1dGhvcml0eS1kYXRhOiBMUzB0TFMxQ1JVZEpUaUJEUlZKVVNVWkpRMEZVUlMwdExTMHRDazFKU1VNMWVrTkRRV01yWjBGM1NVSkJaMGxDUVVSQlRrSm5hM0ZvYTJsSE9YY3dRa0ZSYzBaQlJFRldUVkpOZDBWUldVUldVVkZFUlhkd2NtUlhTbXdLWTIwMWJHUkhWbnBOUWpSWVJGUkplRTFVUlhsT2FrVjNUVVJKTUUxc2IxaEVWRTE0VFZSRmVVNUVSWGROUkVrd1RXeHZkMFpVUlZSTlFrVkhRVEZWUlFwQmVFMUxZVE5XYVZwWVNuVmFXRkpzWTNwRFEwRlRTWGRFVVZsS1MyOWFTV2gyWTA1QlVVVkNRbEZCUkdkblJWQkJSRU5EUVZGdlEyZG5SVUpCVFdvckNuQnpiR05KZDJNM2NqQnBkMGhwVWxWYVdIcHFhazVrU0RseVUwZ3dUVGN3T0d4WGN6RnZUR1I2Y0hOWFFXeE5WWEIwT1hwWWQwOVBOVFpvVEVKS05XY0tRVmM0U21SMFVreHpZbkoyTW0xRFQxZDJiU3Q0TUdGNk5HcHFaMVp5Vm0xcFR6VjBlbVJ0VFVJcllXWTJZV05KVlVRNFVVcEhlWEJGUlVsVGRsQmFkQXBLT0hWeVJrWlpObkJ0UlcxV1RGZHFWVVV6WjNSbGQweFhNWE5MVm5VclpFUmpWbFZZUlhBd05HdDZOR2RNU0dSQ1VYbzFaRXA0YWtwMllXRk9kbFJRQ25OaE1pdDZkekJoYkd4d1NUVXJja1F6UVZkVU0xTlJRVlJSTVZselNGZElia1JvVkdwMFZXSkpaVGhNTURoT05HNXFMMU5EUTBkRE1HNUpMek5EYkc0S1JWSkxhVXRVVERob1FuUmliM2xTVlhkTFQwWkRUVGhIZDBSbFlqSldhRnBwY2tabWRqbGtVRUpqZHpGS2ExQTJiMWs1U25GcFdIVkNVVVYyVW5ZNFF3bzNjV0V5VEd4a1pWcExPVmxQY0hWSk16bHpRMEYzUlVGQllVNURUVVZCZDBSbldVUldVakJRUVZGSUwwSkJVVVJCWjB0clRVRTRSMEV4VldSRmQwVkNDaTkzVVVaTlFVMUNRV1k0ZDBoUldVUldVakJQUWtKWlJVWk5jWEZyVDBKUFFTOUhZbE5LYlRWQlNFTkZhR3cwU2pCeWVYTk5RVEJIUTFOeFIxTkpZak1LUkZGRlFrTjNWVUZCTkVsQ1FWRkJMMVJCVEVGNVpHbHlWV1ZFZHpoVGVFRXhabmtyUWxaWk1WSlVZaXRQTUZSU09WaDRWV04yT1VVdldrWkJPV28xVGdwTU1YSlVUalZTUzJWR09DdHFjRkJsTTAxQ2RXVmtMMFZSU1VsMk5taGxTRVl5TjNWUVNqbGpPRkZaUkhKdk9XWjZRbUp3Tlhjek1VbDNkRTVNVEhOSENuTkRhRll6Y0djdldURTRPVFEwV0hKeGNtSlFSM0UyU0d4dU9USnRSRmQ0TDNwM1J6QTJWRVZDZEdWTllpdFpOVWxGU0RGcE4yOUZTRFZDTVdkbFptMEtWSE54ZEV4UE0yMHpNbVl4YzNGU01rSnRXR1UzWW1WblpEY3lTVlpaTkhGbFIxcFdTRFZhV1VsdmExbEJWazgwSzNrNFZGTnpUVmgzUVRGdVNYRlhVZ3BqZW5CTFVEZEtWM2RpT1dWbmJVOVFOMUJKTTNCMlZUUmpZMWQxTW5WeVFtUnBRVTFMVmtGMGVsZFlNbTlsYTNob2FqTndSV3BDZVVSak56TndXakEzQ21sM1p6VnpVMHRrVlZGS2JrVjJNRWhFUVdNd016RjJTV2xYT1ZWTk1UQlhVMlpoYUFvdExTMHRMVVZPUkNCRFJWSlVTVVpKUTBGVVJTMHRMUzB0Q2c9PQogICAgc2VydmVyOiBodHRwczovLzEwLjIyNS42My4yMDo2NDQzCiAgbmFtZTogY2x1c3Rlci5sb2NhbApjb250ZXh0czoKLSBjb250ZXh0OgogICAgY2x1c3RlcjogY2x1c3Rlci5sb2NhbAogICAgdXNlcjoga3ViZXJuZXRlcy1hZG1pbgogIG5hbWU6IGt1YmVybmV0ZXMtYWRtaW5AY2x1c3Rlci5sb2NhbApjdXJyZW50LWNvbnRleHQ6IGt1YmVybmV0ZXMtYWRtaW5AY2x1c3Rlci5sb2NhbApraW5kOiBDb25maWcKcHJlZmVyZW5jZXM6IHt9CnVzZXJzOgotIG5hbWU6IGt1YmVybmV0ZXMtYWRtaW4KICB1c2VyOgogICAgY2xpZW50LWNlcnRpZmljYXRlLWRhdGE6IExTMHRMUzFDUlVkSlRpQkRSVkpVU1VaSlEwRlVSUzB0TFMwdENrMUpTVVJKVkVORFFXZHRaMEYzU1VKQlowbEpaR3MzVDFseWJHZEhWV2QzUkZGWlNrdHZXa2xvZG1OT1FWRkZURUpSUVhkR1ZFVlVUVUpGUjBFeFZVVUtRWGhOUzJFelZtbGFXRXAxV2xoU2JHTjZRV1ZHZHpCNVRWUkZlRTFxV1hoTlJFRjVUa1JLWVVaM01IbE5ha1Y0VFdwWmVFMUVRWGxPUkZKaFRVUlJlQXBHZWtGV1FtZE9Wa0pCYjFSRWJrNDFZek5TYkdKVWNIUlpXRTR3V2xoS2VrMVNhM2RHZDFsRVZsRlJSRVY0UW5Ka1YwcHNZMjAxYkdSSFZucE1WMFpyQ21KWGJIVk5TVWxDU1dwQlRrSm5hM0ZvYTJsSE9YY3dRa0ZSUlVaQlFVOURRVkU0UVUxSlNVSkRaMHREUVZGRlFYWjJRbUk1TlVNclUwbHNNbUZPTTBRS1ZFRk1hV1IyV0hSa1NYcEJVSGxUTkdkSFpXRkphbFI2VWxOWFNXbzRiRzFQT0dKTE5uZHllWGs1TTJkNlVreEVVMDh5TldwV1RHSkdVekpuYld3dlR3b3pXRTRyWW5CcFdHY3hPVVp2WTI5ck5tOVlSV3BGTnpsMVFqa3JNMUJpY1c1RVYxcHdSbFZIUkVFdmNqQlBjM0ZtYzNwMlMyVmlja05xT1VRelJrVnVDbWxJV1VkUFNpdEhOWFJhZFVzd1ozWjJiV2xSVVVRMWNGZFdlVXRXWTFwWVRHVXhMMVJ3YjI5bWFtcEJSVXN6VVc5S1pteDFheXRTTmpkb1FqWkZUa2tLTm1kRFNWVjNRM1l2TkdZelpqaDViRXd2UWxkS1ExZHBVbWxTYVdGRVprTTFlVkEwSzBaaVJIRlhXVkZGTWtsQlFXdGpTbTFaTTFFd2VXdHNjblZ2UkFwTU1ucDZla2QwVEhkR2FESmpMekYwWVU0d1RrdEpSSEFyVUZKUGIxWnZVRVZoUm1KUU5ETTFlVkYyZWxCRlMxY3paVUU0WXpFNVJVWmhUek5qT1VOeENsSXpOMnhFVVVsRVFWRkJRbTh4V1hkV1JFRlBRbWRPVmtoUk9FSkJaamhGUWtGTlEwSmhRWGRGZDFsRVZsSXdiRUpCZDNkRFoxbEpTM2RaUWtKUlZVZ0tRWGRKZDBSQldVUldVakJVUVZGSUwwSkJTWGRCUkVGbVFtZE9Wa2hUVFVWSFJFRlhaMEpVUzNGd1JHZFVaMUI0YlRCcFduVlJRbmRvU1ZwbFEyUkxPQXB5UkVGT1FtZHJjV2hyYVVjNWR6QkNRVkZ6UmtGQlQwTkJVVVZCU201eVVUZ3ZOa1U0UWxVelNHbzNlVTFHYW5WMVlYQnJiMmh6Y2psUmJYRlFOMUZ0Q2xBd1ltcHdNMDFIV2twSlQxbFRPRlJwYlhFM2RrbEtUbmhLWXpGRlQyUTFSRTVXUlVWaVpYaEZkSEE1VFVjcmNra3dNMHBQWjNvMFdrdFFiRE5IUld3S2N6WnFjMUJEVHpOaWRYQmljWEZNYm1rNFlpczNVM2RWYW14VVlUbEpOM2d5TkhSdVNTdGtlbGRCUkZOaE5uSnNjSFkxT0V4RlFYTnFNVWxHWVRWVGFRcHpRVUZ0UlVOUlJHNWtSUzgzUVU5NWNWcE9OV0Z0Ym5Vd0sweFpUSGxuTWpsdWNUUkpUR3BxUm1OalJtbEpiMVpCZFhWbGVVeGhSVkJQYUVWMVpqQnBDalpCZURnMFozUlpiMHRvU1dsNmRFTTNaV2N2UjJ0UVdqTlZTbkY0VTJJNWVFOVNiWE50WjBacFpUUm1RVU55ZGtWSlZIUmtkVWR4UlM5eGVXTTNabllLVkhjMFJsSXdSSEJ3YTBodmJWQktRbkF4TW1SUVUwVlZOM1l2ZG1OWlZqYzFZVTVaTmpoMVJuWTVTV0pYVVdodVJrRTlQUW90TFMwdExVVk9SQ0JEUlZKVVNVWkpRMEZVUlMwdExTMHRDZz09CiAgICBjbGllbnQta2V5LWRhdGE6IExTMHRMUzFDUlVkSlRpQlNVMEVnVUZKSlZrRlVSU0JMUlZrdExTMHRMUXBOU1VsRmIzZEpRa0ZCUzBOQlVVVkJkblpDWWprMVF5dFRTV3d5WVU0elJGUkJUR2xrZGxoMFpFbDZRVkI1VXpSblIyVmhTV3BVZWxKVFYwbHFPR3h0Q2s4NFlrczJkM0o1ZVRrelozcFNURVJUVHpJMWFsWk1Za1pUTW1kdGJDOVBNMWhPSzJKd2FWaG5NVGxHYjJOdmF6WnZXRVZxUlRjNWRVSTVLek5RWW5FS2JrUlhXbkJHVlVkRVFTOXlNRTl6Y1daemVuWkxaV0p5UTJvNVJETkdSVzVwU0ZsSFQwb3JSelYwV25WTE1HZDJkbTFwVVZGRU5YQlhWbmxMVm1OYVdBcE1aVEV2VkhCdmIyWnFha0ZGU3pOUmIwcG1iSFZySzFJMk4yaENOa1ZPU1RablEwbFZkME4yTHpSbU0yWTRlV3hNTDBKWFNrTlhhVkpwVW1saFJHWkRDalY1VURRclJtSkVjVmRaVVVVeVNVRkJhMk5LYlZrelVUQjVhMnh5ZFc5RVRESjZlbnBIZEV4M1JtZ3lZeTh4ZEdGT01FNUxTVVJ3SzFCU1QyOVdiMUFLUldGR1lsQTBNelY1VVhaNlVFVkxWek5sUVRoak1UbEZSbUZQTTJNNVEzRlNNemRzUkZGSlJFRlJRVUpCYjBsQ1FVWk1abWhxY3pocmNYQjJTak54TmdwcWFFdEhlV1kxZVVoV09WSXlMM1JOUmpsNE4yMTRWM1oyT0hKTFZVdDRMemhMVTFCVmRrZFVZbVpDTkZoRFRVZFBjMkZFYWprMk9FVkxWSFpwWkRaWUNrdFFWa3hPU25kVFJrOXJURkl2UkVORFUxaFdZVFJ4ZFcxcllqVlFTbTU0Wm1ORVVreDBPVFZ0T0dSUFptSTNUelF3U0c0NWQwcE1NMDFaTURCWFNtd0tkM1V2YVhOcE5sQmFkMFEwU0hoalowaE5SR0pLTkd0TGVtSlVabmxzYjJwa1VWUldaM3BXYzJWS1ptMUxRbVkwY1Raa1Rta3pPVlIzTVVwelpIRjNXQXBTUzJObU9XOTJkaXN2TUdkVGRVcHRVMmR4ZEZaelJuaGthM3BEZG1adVdVUk5hRU5TYlN0QlExTmFVMjV5VFRFdlVUQnJiVWhYTW14RGIyMUdlQzlhQ2s4eWExSkpSVGx3VjNSUE5VOUlVWGRCTmpSUlEzUk5NVlppTldvNGEwaFNMMjV0YXpab1JYaEhSVE5LYkdGb1MyMXZRbWh1ZEM5NGNFNXBXakVyYTA4S01UaHlSWGRKTUVObldVVkJObWxyV1hOdFpWZGpiakJHUW5NclJuTkxaVmR5TUZrd2FGbHBOSHBhU1dVNWN6aDRRekozU1ZwTWJ6SnZPWHAwUW1KdFdRbzJRME5zWldOTlpUbHZhbGQwWW5CSlRsVXpVMnQ1ZFVkeGVITmtVVlpXUTI1dVRVdzFPVkZYVDJkTE1IUkpjVGhCTVZONVpGZHBVV2RHUjJ0WmQwWk5DbGg1TUV0Q2FpdHpOWHBaYlVGUmIwOWpTV2xqYXpoVVpVRndLMkl5TjFaVll6Z3dZbFF2VFVKaVRqSjBObFJ2U2pCNGFTdGFXbk5EWjFsRlFUQk1PVW9LWjNCMllrdElia2xtUVV0cmJpdEpkbGt5UWtSYWNrOXJiblpJZFdnMlNpOTRWR05EVm5KM1dGQldVRVY2V0VoWldHdHhOVlJaVTB3MFUzUmxPSEJPYmdwaWVWRkdNR1ZRVldoMWFVOUJZM3BhV0c0eFNHcHBWRGRZSzJsdVRVbFBaVzUyVG1KTWNVNUdUemhKZG1NdlZtUmFNR0kyVWtkc05uSmtRbTlUZUVzMUNubEtSbE5pY1hORU1VcFBZMGQ1Vm00MFUxSldZMDVKWkhoa2FrUlRVRXMzTDFCV1dXNXVZME5uV1VWQmNUQkNia2RaVERneWNuQnZVa3hVWXprelpEVUthM0pLY210M1YwMDRiblJrVUdaQlJqRkhObk5NVFRaeVV6Sm5NWGxMZDFkRmFEVmxTbmhFTW5kcFRVNTBSbUZMYmsxR1VITmxXbmhXVVRRNVpGSjVaZ296YWxsU2FsQnFiRlZKVUU5SFVWRnNkMDlJWlhGc1RsRTJlV1pMWVRoWU1WUjBORzV4U3pWR1F6aDJhMDh6Y0ZwWFVpOTNUVE52VmxSRFNHazBUM0JoQ2pJeE5EQkVWMHRTZEd0aWFDc3JTa0ZqVTNneFozVlZRMmRaUWt4S1pVaHVNVUZZYTI0eGNuVlZaVVpFT0dGQ1VISlVUREpuVVhSMFkxQnJSeXRTWmpRS1VHMUtiMHRTVWxGeWNIZ3hkbFowUVV4eVVtY3hTM1Z4Y0haMGNWcHRhR2hIVmpOREwzSnlaWGxyT1RsR1IzSlpWMnM1ZEU4MlJVaEhVRVV2VWs1TVVRcDBRbXRMVWtKeVJHUmFaWGh5WnpSMlFrNHhTbnBhVFhScFdUVlRTVWMyYWxweVZpOVJOaXRCVlhCa2NrdHNPRzlNVUZaYVVsUnpWVzgwUmtJdlMyaDVDbGQ2ZWtrMWQwdENaMEozUkhwd1lsaG1RVXBJTVVwWmJtUjNNM2h5VGl0M0swaHFTV2RHY0RWM2JqZHhNVVUzTVVaQlVtOXhORE5JT1ZwRFV6QkRSVmNLWm5nMU9FOWhOa1I1Y0hSdVFWWnVNV3cyYTBKUVRuZzVLM1ZqZG5ReE1TODBZWEIxYUdWcFNYZDBhVUZ1TlRGVlRVRlNjWGxKY0dOUFNqZG1jMmg2ZWdwQlZWVk1iMkp0VUdKUFZGQmxOR3hZVEZacU5WTkRRMGxvVkZwd2EyOW1WRTEwVVhCMFEzUnpNVnAzV1RkcVExSXdaVXh6Q2kwdExTMHRSVTVFSUZKVFFTQlFVa2xXUVZSRklFdEZXUzB0TFMwdENnPT0=
---
apiVersion: v1
kind: Service
metadata:
  name: rocky-ssh-service
  labels:
    name: rocky-ssh
spec:
  type: NodePort
  ports:
    - name: rocky-ssh
      port: 22
      targetPort: 22
      nodePort: 30022
  selector:
    name: rocky-ssh
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: rocky-ssh
spec:
  replicas: 1
  strategy:
    type: RollingUpdate
  selector:
    matchLabels:
      name: rocky-ssh
  template:
    metadata:
      labels:
        name: rocky-ssh
    spec:
      volumes:
        - name: ssh
          secret:
            secretName: rocky-ssh
            defaultMode: 384
        - name: kubectl
          secret:
            secretName: rocky-kubectl
            defaultMode: 384
      containers:
        - name: rocky-ssh
          image: sjwayrhz/rocky-8.4:kubectl
          imagePullPolicy: IfNotPresent
          volumeMounts:
            - name: ssh
              mountPath: "/root/.ssh/authorized_keys"
              subPath: authorized_keys
              readOnly: true
            - name: kubectl
              mountPath: "/root/.kube/config"
              subPath: config
              readOnly: true
          resources:
            requests:
              memory: "512Mi"
              cpu: "500m"
            limits:
              memory: "1Gi"
              cpu: "1000m"
          ports:
            - containerPort: 22