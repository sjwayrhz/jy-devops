apiVersion: v1
kind: Secret
metadata:
  name: rocky-ssh-share
type: Opaque
data:
  authorized_keys: c3NoLXJzYSBBQUFBQjNOemFDMXljMkVBQUFBREFRQUJBQUFCZ1FDeHVvUWtnWlFMZ0t1RTBRbGc5TVd5NWZHN3BzRmR6OWcrbFlCTFhIQXpKRUpOUzdmM0ZWSzVJRWV6SGVQZUVSalloODR3Szc2Ni9wSFJrUks4N2hLdGxxMjd0QUoxQjN4TCtTWHVhdEk2RFp0V1FMaXZBY1NuOENIRWxCVHBubmdyWXNpM0ZkZUdpOFVmNUc2UEhEaFdnUTRnRWxUOW1hZUFTZ2o5ZEtYUVZVVHJYK2ltcVlFdi9ZcTQ1Ty9GS3I3a2FRL2UrdTVHY1B3OUVrSWdQYTExT1ZMLzdpZFF3c3V2NllEV2xvVTZubjJPSGxTeTF6Y3g0WURDdkovNjNKVFZ0TVUybE9BYUZkbjdub2ZhVnJwUVgrUjc5UVNBVDI5dCtYUG1tOWZCY2JSYUZ6MnVUYlJxS2JSbUNmTVNqMCtURFFrcnMrNXV5N2lDbTAwTk5rYkFCQjNlK1NpU0FYRkl0cTlOWnhnNmM2aWE3dE9EVVcyRDg2U2N5Wi9UbUoyZzF1eWYrTjRrU0VESTJ0RlM5UXFHYmtSdW9nVFJ0dE0wMFVwUHpKRFpnTnRLOXMwNzlxWUw3WjdWWm5qVjRZQVBwc3FTZUE1WUd2TzEzMXVhNjhtNmQ5Mk1MM0tsbTVDTEw0R2JsMXZ1QkpTSHc3OEszaUdlMzJJaExOdHJyUzg9IHNoYXJl
---
apiVersion: v1
kind: Secret
metadata:
  name: rocky-kubectl
type: Opaque
data:
  config: YXBpVmVyc2lvbjogdjEKY2x1c3RlcnM6Ci0gY2x1c3RlcjoKICAgIGNlcnRpZmljYXRlLWF1dGhvcml0eS1kYXRhOiBMUzB0TFMxQ1JVZEpUaUJEUlZKVVNVWkpRMEZVUlMwdExTMHRDazFKU1VNMWVrTkRRV01yWjBGM1NVSkJaMGxDUVVSQlRrSm5hM0ZvYTJsSE9YY3dRa0ZSYzBaQlJFRldUVkpOZDBWUldVUldVVkZFUlhkd2NtUlhTbXdLWTIwMWJHUkhWbnBOUWpSWVJGUkplVTFFVFhsTlZFbDRUVlJyZDAweGIxaEVWRTE1VFVSTmVFOUVTWGhOVkd0M1RURnZkMFpVUlZSTlFrVkhRVEZWUlFwQmVFMUxZVE5XYVZwWVNuVmFXRkpzWTNwRFEwRlRTWGRFVVZsS1MyOWFTV2gyWTA1QlVVVkNRbEZCUkdkblJWQkJSRU5EUVZGdlEyZG5SVUpCVEZOTENtSjVkbnBEYkhkeFlrOXVWMmd6Um1oeVNrSmFkMEZtUkRCYVJGWk5ZMUoxY1VKMldGUldiV2hxU3pkaVJucFpjV2x4Tm5WWWNYUkxiRWxVWWpkSmRDc0tSMjgyZDBWaWRVdzNTMkZzTXpsWWJWSm9URWxWUlV4T1pWWklPV04zVG5CcU5qTlhNMnhyTWpoTFZtb3dlVUpsTVRKWmVISm1WRlZ1VkZwT1dHODNMd3BNT0ZZMWJ6VmpWRGRwY2l0dksxSlplVmhuYVZGNldHaExTRE01TlVWM1QxQkxRbGRpYkZkdlJqZHhOV2RGWkhWWGJUbGhka2N6ZDBaVmVuRkJjVzFOQ21wT2JHSnVVVE12Tm5NNE5UbFdjbVpOTldObUsxaGxSMVpHYTNBclJXZ3hZMHBRVnl0c2VXWmpXVnBpZGpOUFVuSm9UWEZDVjA5UGN6ZENXbmRESzJvS2VGcE9WMW95UkRWMFNtNDVTblZPWWxwRlZtUndRa2RHSzBkTVNVZGlZMGhDZGpSRVNuaGlOSGRqZFd0NVRIUXlRM28wTm14UE0wcDBLMkpGYVRBMWJBcFBiRTlOYzFoUVZFUklOR1F3ZVdoVldWSnpRMEYzUlVGQllVNURUVVZCZDBSbldVUldVakJRUVZGSUwwSkJVVVJCWjB0clRVRTRSMEV4VldSRmQwVkNDaTkzVVVaTlFVMUNRV1k0ZDBoUldVUldVakJQUWtKWlJVWlBVbXMxYkhobWNrZFFUMDVOT0dkVVVqRTNZMmxEVXprclVFbE5RVEJIUTFOeFIxTkpZak1LUkZGRlFrTjNWVUZCTkVsQ1FWRkJTemhST0dSc2RrSjFlV0ZDWlZjdmFVUXpXWHBuVmk5bFZHd3pZbXgwY1VGWFRXVjBPRFZpZURCWFozRTJWRmxIUXdwNlYxSnRjM3AwV2xkSmRqRmliSHB4V2xoS1EwaElNa0V2WlhscmVFOXJUMFZzT1dacmFqWTRSMHhHT0ZoUFFVZFVVemh3YW1WNk5HOTZWMjVoVEZSUUNuWlRkRmQzTVV4UlMydFZiMGRDTlhRMEwyNXFLM1ZXVkdsVE5XeGlVR2t5UWpZME5taG1XbnBEVjBRd1pFdzBhSHB0YUdKck1qa3JabGhtSzBKWk1VY0tkakY0VGxGWFJtZFhSVk5YY1ZSYVJrOVlVbmw1VjBVclpFTnVWRTlTZFV4RVIwMTJkbWNyZGxCRVJVcDJTV3hNUmpFMFluSTJkM0V3T0RGb1dGbGxZUXBWUVRSNEswSndXVkZVU0hKdlVWSlhSWEZYU2sxUWIyTTFVMkZPY1dZMFNIaFJjR0pHUWtsYUswMU1hM0Z4WW5sRWQxWktaMkpRVDFNeU5VSXhibU0yQ2tGTk5XYzBVMHh6UkUxUmRraG9Ta05uVlhCWllVWjRSV1pMVTFrNVdEZFhZemhWTVFvdExTMHRMVVZPUkNCRFJWSlVTVVpKUTBGVVJTMHRMUzB0Q2c9PQogICAgc2VydmVyOiBodHRwczovLzEwLjIyMC42Mi4zMDo2NDQzCiAgbmFtZToga3ViZXJuZXRlcwpjb250ZXh0czoKLSBjb250ZXh0OgogICAgY2x1c3Rlcjoga3ViZXJuZXRlcwogICAgdXNlcjoga3ViZXJuZXRlcy1hZG1pbgogIG5hbWU6IGt1YmVybmV0ZXMtYWRtaW5Aa3ViZXJuZXRlcwpjdXJyZW50LWNvbnRleHQ6IGt1YmVybmV0ZXMtYWRtaW5Aa3ViZXJuZXRlcwpraW5kOiBDb25maWcKcHJlZmVyZW5jZXM6IHt9CnVzZXJzOgotIG5hbWU6IGt1YmVybmV0ZXMtYWRtaW4KICB1c2VyOgogICAgY2xpZW50LWNlcnRpZmljYXRlLWRhdGE6IExTMHRMUzFDUlVkSlRpQkRSVkpVU1VaSlEwRlVSUzB0TFMwdENrMUpTVVJKVkVORFFXZHRaMEYzU1VKQlowbEpXRGxaYVRFNU1qSkVOVTEzUkZGWlNrdHZXa2xvZG1OT1FWRkZURUpSUVhkR1ZFVlVUVUpGUjBFeFZVVUtRWGhOUzJFelZtbGFXRXAxV2xoU2JHTjZRV1ZHZHpCNVRXcEJlazFxUlhsTlZFVTFUVVJPWVVaM01IcE5ha0Y2VFZSbmVVMVVSVFZOUkZaaFRVUlJlQXBHZWtGV1FtZE9Wa0pCYjFSRWJrNDFZek5TYkdKVWNIUlpXRTR3V2xoS2VrMVNhM2RHZDFsRVZsRlJSRVY0UW5Ka1YwcHNZMjAxYkdSSFZucE1WMFpyQ21KWGJIVk5TVWxDU1dwQlRrSm5hM0ZvYTJsSE9YY3dRa0ZSUlVaQlFVOURRVkU0UVUxSlNVSkRaMHREUVZGRlFYUjFkMXBKYW5sM1lXTjBZMnhtYzFJS1JHUm5MM0JxVWtKQ1lUVXpielpoYUdsc2RtdHZVWEV3UWtOVGFtODBjWEI2WWtWWlltNUdRWGhoVGpCM1Rtb3daMGxxWjJsSFFqQkthWHAwYVU1NGFRcERkV0ZaYmpSelQxVkJRV0kxTmxwWFRuTnlMMkZPTjBKVVkwWm1MMFJ3V1Rab1QxQTNUMFZ6VjBWU2RDczVla2hPVjBkRlRWSm9ORmMzTjB4SlJVbGtDbmhvWkdKTlNrUk1WazlOV2tWaE1EZGtaVWRXSzNwaFJrazJhbGdyZEdVMVl6RkpTazVhYkROQ2MyeFZNelJ5ZG5sS1lVeEtNMnhLUjJ4VWRHRTBXRGdLWTBaUU1EZEViWFJIWlVJNWRtdERRWEpvTmpnM1NuWXhVSGRWVWxCTWFHMUxUWFZUYTJkaFNYY3piRlIwUlM5S2MwTlVhMkZGU1ZOdVNrOXhjblZXZUFvNFR6Wm5PVzByVjNadlNpOVlZak5rYmxvNFNsWnBWbmRWTnpkUlkxTkxiRTFxSzFWVlRYVnJZVFV2U2l0QmEzWkpkVE5FUm5samNIUnZOVEZYWVVWTENuSnRUVzFvVVVsRVFWRkJRbTh4V1hkV1JFRlBRbWRPVmtoUk9FSkJaamhGUWtGTlEwSmhRWGRGZDFsRVZsSXdiRUpCZDNkRFoxbEpTM2RaUWtKUlZVZ0tRWGRKZDBSQldVUldVakJVUVZGSUwwSkJTWGRCUkVGbVFtZE9Wa2hUVFVWSFJFRlhaMEpVYTFwUFdtTllObmhxZW1wVVVFbEZNR1JsTTBsbmEzWm1hZ3A1UkVGT1FtZHJjV2hyYVVjNWR6QkNRVkZ6UmtGQlQwTkJVVVZCUWpBNFkyOU1ZeXRZUlZCelVuSm9iVGt2UldaRWFUUlBWR3c1VTA5UVNVeDNUaXRYQ2pkb01IZHhSbUl6SzNWT1kwcHVNR0Z5ZVhNMk5HYzVlRVI0T0RBNVkzRXlUV1IxTkhwUWNXTnFNa1l4YkVSd1lWcDNOV1owWVhKT1Z6aHJRWGhGTTI4S1ZISnRWbmcyUzBaWVdVRTRaVVpOWWtKR1VXUkdNbFJJYjI5bWNESTFZWFZhYnpSUE4ySmtjMDlJZERad05rbzBhR3B6U2xGSVdUTndORTVNYlUxTk5RcHBibEprTUVwb2FHTmxlVXgwTkZCd1ZtNHJPWGN4Ym1ac0wweHFZWE53ZW5aRllsZHRjVzB5TW5sNk5GSlNNbXd2ZVM5cFkwZDBOa0l5VVdKb0x6WlJDalVyVDFGUWFFNVBjV2RwTldGT2RIbEliVXhEVVhKSlRYTm5OREF5VGt4Vkt5dFhXV05qVW1KbWFHTkdheko2Vm5KdFRHbDZORVZZT0dkYWJqbHJWaThLTVc5eFpVbFVWR1lyTWtsaFZVbDNRVzFhWkhWRGFXTlBjR3hMTUU5VlowNHZkMU5LYmpsSGJsbDZUbWhSUVdGek1rRTlQUW90TFMwdExVVk9SQ0JEUlZKVVNVWkpRMEZVUlMwdExTMHRDZz09CiAgICBjbGllbnQta2V5LWRhdGE6IExTMHRMUzFDUlVkSlRpQlNVMEVnVUZKSlZrRlVSU0JMUlZrdExTMHRMUXBOU1VsRmNFRkpRa0ZCUzBOQlVVVkJkSFYzV2tscWVYZGhZM1JqYkdaelVrUmtaeTl3YWxKQ1FtRTFNMjgyWVdocGJIWnJiMUZ4TUVKRFUycHZOSEZ3Q25waVJWbGlia1pCZUdGT01IZE9hakJuU1dwbmFVZENNRXBwZW5ScFRuaHBRM1ZoV1c0MGMwOVZRVUZpTlRaYVYwNXpjaTloVGpkQ1ZHTkdaaTlFY0ZrS05taFBVRGRQUlhOWFJWSjBLemw2U0U1WFIwVk5VbWcwVnpjM1RFbEZTV1I0YUdSaVRVcEVURlpQVFZwRllUQTNaR1ZIVml0NllVWkpObXBZSzNSbE5RcGpNVWxLVGxwc00wSnpiRlV6TkhKMmVVcGhURW96YkVwSGJGUjBZVFJZT0dOR1VEQTNSRzEwUjJWQ09YWnJRMEZ5YURZNE4wcDJNVkIzVlZKUVRHaHRDa3ROZFZOcloyRkpkek5zVkhSRkwwcHpRMVJyWVVWSlUyNUtUM0Z5ZFZaNE9FODJaemx0SzFkMmIwb3ZXR0l6Wkc1YU9FcFdhVlozVlRjM1VXTlRTMndLVFdvclZWVk5kV3RoTlM5S0swRnJka2wxTTBSR2VXTndkRzgxTVZkaFJVdHliVTF0YUZGSlJFRlJRVUpCYjBsQ1FWRkRabEZzU0dweFFtdHJSWGRYU3dwSmVYaEhPVWxpSzBOeVMzUTBjV1ZTVjFGMEsweGxSMUpuU1UxWmRFWnRkMnR3UzJsWWJGUmhSekJ3T0dsSlMyNVJTREJ1ZURSU1RqSkZVbTR4UjJZckNqVXpiVWsyYUc1d2JHbFZaellyWkdaMVZXVkpjbmhpVDFaR2NsTmxkRVUyUW1kaVVucGlVbUZXWmxoSk5UbE5iVWhMVG05VE16TlFWRkJJUmxaM2Fqa0tSR1pPYTA4MFQwOWthRXBDTVhaT1JtMDJRMUZWY0dKR1VVVlBUWFJuVG0xdVEwNVZZamxZTTFkRFMxaG5RVVZLTldNNVdISjVUbWM1V1cxaGEzWk1aUXBqTWpCRU0xQTViazFQV2xreVVtbDZNRXM1TjJSMFdGbDBibk5XU0hOcFZXVkVka3c1ZEZKd01qVnRUa05EZGxFcmMxQjFlVk55TVRkRFVtVldNRWRuQ21GbmJFTnFaRXh6U0RGV1NVVmhXRlJ4TDFGVlNVUTNVakJTWVVOYU5WTTFRVGRoVEdSMVNtODVNMHhKU0hWSmRtSkxRMFZyWmtkUVdIZG1SVlVyZVRFS1NHZFhhVXR5Y1d4QmIwZENRVTFwVmsxYVVFWk1jbGR6T0RKek1UQkRhazVGUWtNNU1uUmpiM1JHTms5TWRGZHRiWEZLYzFkSGExUkRNelZaS3k5bkt3cEVWSGgyTWpkQmIwYzFUWEF3U2pjd1lsTnlUMDAyU1ZseE4ybHlNbVpPVUdGWVdHeFFLemRUUlN0U00zQnNRMWQ0YkVOUVEwcFBaMHRRTlhnd1VHaFZDbnB1UVU5VU1UZDFVa0kwZEZkRVlWcGpibko2VkdWdU1tSnFNbVIwV1hwc01ERjJSbkpQU21rNVdrUlNTVnBPVVhRMFNDdGpOR0V2UVc5SFFrRlBiREVLZWpnNVZVdzBka1JoWkdSS0wwdzNZMDVtT0dwQlQxQjZja3AzWmtkSGVUWXlTSFpFUzFFMldGUTNOazR5ZUZKS1dtb3pia3R5YzNablZYUTJRM0I0UVFveFYwZDBZV0l4UXpGd1VIcG9iRnB6YmxSRloyTmlSSFYxYVdKQ01WZHhTVEpDVUhOeVJIaG1OV1pzTmt0VGRucHBhWFptUlc0elNFSjNOV05MU25ZekNtSktNM3BIUzNkblQwTmxlakZuVERob2QxbHlXV2R5UVUxRE4zZG1XbTFOYnpkd2VGUTBaVGRCYjBkQldUWmpOelpzTm1ONGExbFhObUo2YVc1dFRFUUtRMGsxUzIwemNuUnZZM2xwUjBOUFpIb3ZVbXRQUlM5ME9XVm1abmcwVjAxeVpXOXNRekl2YUhjd2RWUkRiVmxHYkhFMk4yMUdNRXBqT0ZwMGEybFNlUXBGVGtSRk5ISkpZMm92VjJnck5HWjBTSHBxZHpKbFpFbGtjVWN4V1V0MFFuQlJjRE5DU1V3M09VMUplV2RYTTJKSmNIRmxjWGMxZWpGemFub3labmxWQ2psYVRsRlJWMnhKT1RWdWRsSklSbXgxYmk5bmFHRkZRMmRaUlVFd1FqaDFkWFV5V2pGVllraDJRakZDVEVGVE1GQnNZU3RJU0dwSGEwRmtTV2gxVjNFS2VDdHZZbFk1Tm1OUlNYWkdiV3BuTURWVmNVaFdXV1p6UVRWVmQydEZkR0kzYXk5b2VUZzRhRFkxVGxaV2QxcE5kVGxpYjJjMGNrOWxSelpyUTNVd2FncGpPU3Q0VXpoR1UwTjVNVlZPZEVwT1ozWTNRMUpWTmtGbk9WTXdabmhZTjNodVRrbHpNbTFzY0dZNGVqaHJWMlJQVjNKRVdrVkpaM05xWmtOUlNHbFpDa2hWVjFkWFRFVkRaMWxDUjNBck5sRnVhMm80VkZFclJqWnhVVE55UTJ0Q01VbEZXVkJvT1VaTk1sQkplR0ZoZFdOT1ozQkxWRmRVWjJwVlkwZ3lhVThLVEZRelUycHNjRVo0T0cxM0wzcDJWVVJDVG0xekswTlpVM2RzU1RSQ1MzQXphSGxpZWsxUFRteE1WRTVFYmxCNlUwRkZTRTFZY1RkVVZqaEVXRWxMZUFvclEwOW5WRTAwT1d0UlpsVk5TWGRVZWpoWlEzcHlZVW93WkV0dmVGZDRkMHRSZUVScUswVTJRM0pFU0ZWcUwxZE9ielZyTVhjOVBRb3RMUzB0TFVWT1JDQlNVMEVnVUZKSlZrRlVSU0JMUlZrdExTMHRMUW89
---
apiVersion: v1
kind: Service
metadata:
  name: rocky-ssh-share-service
  labels:
    name: rocky-ssh-share
spec:
  type: NodePort
  ports:
    - name: rocky-ssh-share
      port: 22
      targetPort: 22
      nodePort: 30021
  selector:
    name: rocky-ssh-share
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: rocky-ssh-share
spec:
  replicas: 1
  strategy:
    type: RollingUpdate
  selector:
    matchLabels:
      name: rocky-ssh-share
  template:
    metadata:
      labels:
        name: rocky-ssh-share
    spec:
      volumes:
        - name: ssh
          secret:
            secretName: rocky-ssh-share
            defaultMode: 384
        - name: kubectl
          secret:
            secretName: rocky-kubectl
            defaultMode: 384
      containers:
        - name: rocky-ssh-share
          image: sjwayrhz/rocky-8.4:kubectl
          imagePullPolicy: IfNotPresent
          volumeMounts:
            - name: ssh
              mountPath: "/root/.ssh/authorized_keys"
              subPath: authorized_keys
              readOnly: true
            - name: kubectl
              mountPath: "/root/.kube/config"
              subPath: config
              readOnly: true
          resources:
            requests:
              memory: "512Mi"
              cpu: "500m"
            limits:
              memory: "1Gi"
              cpu: "1000m"
          ports:
            - containerPort: 22