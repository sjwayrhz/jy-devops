apiVersion: v1
kind: Secret
metadata:
  name: rocky-ssh
type: Opaque
data:
  authorized_keys: c3NoLXJzYSBBQUFBQjNOemFDMXljMkVBQUFBREFRQUJBQUFCQVFDdG1yQmZPRkxGOHRVQnlaTU5iUmtoQ3FyTHhQc2NJMUlBdnYvd2pKdXN0REVzdm40VzBXeHg3VUlzU0doQmJSa0JFM3BNanlOSnlseXFsa0ZpeHQ5b25HVGRTVk1kTnVBeEhTVHFWN241QjRaWFhtdVNUR25sMkRTS1lnT1NsZUNwYWtBSzE1VEJDbFBtMWFCMGMzUmh2c2Q2aXlNZlREOU1LR1hFTml0cG9rVG9PMFhTSk1VL25qcUVraEpjd1hUR0hYenRwaXRxc1ZuWEkvNEJVWXlhNlpZc21LQVNGd2FQbXBqdmpySThWMmVWVFM5YmFqRGg3QXA4WFM5ZDk2TlFZcUNVMkl1dGFZZXFNNy8wUzlWL2FDR2szTStLNXVsVkVwd2I1YnUyZmpkMUdURzBXYURQZHhaMThEYlhCWkVZcDJ3TmdZcHRSeDhEL0FNMzloVFQ=
---
apiVersion: v1
kind: Secret
metadata:
  name: rocky-kubectl
type: Opaque
data:
  config: YXBpVmVyc2lvbjogdjEKY2x1c3RlcnM6Ci0gY2x1c3RlcjoKICAgIGNlcnRpZmljYXRlLWF1dGhvcml0eS1kYXRhOiBMUzB0TFMxQ1JVZEpUaUJEUlZKVVNVWkpRMEZVUlMwdExTMHRDazFKU1VNMWVrTkRRV01yWjBGM1NVSkJaMGxDUVVSQlRrSm5hM0ZvYTJsSE9YY3dRa0ZSYzBaQlJFRldUVkpOZDBWUldVUldVVkZFUlhkd2NtUlhTbXdLWTIwMWJHUkhWbnBOUWpSWVJGUkplVTFFVFhoUFJFVjRUVlJqZVU5V2IxaEVWRTE1VFVSTmVFNVVSWGhOVkdONVQxWnZkMFpVUlZSTlFrVkhRVEZWUlFwQmVFMUxZVE5XYVZwWVNuVmFXRkpzWTNwRFEwRlRTWGRFVVZsS1MyOWFTV2gyWTA1QlVVVkNRbEZCUkdkblJWQkJSRU5EUVZGdlEyZG5SVUpCVUVkVkNrMURlV1ZHTmsxUlVUWmFiWFZSY2k5WU1XTlNMMUZXYWtjdksxUkJSVmcyU1ROQldUSjVRbGxOTWk5SlZqTmhSR2Q1VlZwM2FtOXRlRU53YlVsc2R6Y0tZVkpCT1hGaE5XNTVXRFJNTW5SMWJHWnlaSFYyWkRWQmIwdGFWek5XUlZoYVJFdDNRMFZGV1VaT1dtMDVaazF6TmpsQ1pHdDJRMGhZYXpkYWMyOVdVZ3BqVmpRMk1DODNla3RLZFZONGFEQldlRGRSYlhKS2VqUXZWRXR1YXprdldVaGxZa0V6ZFRCQ2JsRXZiVE5qWm1VdlNtMTBaSGN3ZEZGeVFrUnVTRVEyQ25SRWNrRkpWMVpLUTI1TWREQXZkVEpuUmxkV1NqSnFTRzFxSzNoTmF6SjJOM0ZCYjJ0RGEzVmxUWGxaVTI5d2RYQnFXR1ZuVFc5clZXWmhkWFpCU25vS1VVNXdaRTAzVW5GbFNHMHJhMHgyUkZSRmVVcG9MMUp4YTJOUlVWVTJUWGhCU1c5amVDczVTbnAwVVZWNVVtVnBVRlEzY1ZWT04wbE5NVVkxTm5kcU53cEVhV3hJVVM5WWNWcEdUakkxYjA5WE5qSkZRMEYzUlVGQllVNURUVVZCZDBSbldVUldVakJRUVZGSUwwSkJVVVJCWjB0clRVRTRSMEV4VldSRmQwVkNDaTkzVVVaTlFVMUNRV1k0ZDBoUldVUldVakJQUWtKWlJVWlBaSFV4UkVKUFRuTTRUSGx6VDI5bGJrTldSVElyVmpGNWJWUk5RVEJIUTFOeFIxTkpZak1LUkZGRlFrTjNWVUZCTkVsQ1FWRkNOM1p3U0hWVVoyaHVkSGRLZUZKQ1ptaDRSMFpyU2xOVEsyRmxPSFZ6ZWxKb2J6RkhMMVJDWm04d1dUbFFlRzVVWndwQmFtUlpaVzFGYkZSMVZXOHhTeXRJVmxwU1FtWk1LMHhqV2xvek5FVklXWHB2VUhKM1NVZ3paMmR0YjI1SGMyZzJOME5NTkdvMlJYQnBXWHA0SzJkd0NrZEJPRTA0T0dNeU1qSkxiamhqWkdaTmExbG9RMlV5WlUxdE5WQTBOemREYkdORWQxVlFMMlJDVDB4V0swTldMMnh5TlRsUFFYbE1LMGxPUzBJM1NsVUtSVUZwZEdaUmJVeHdjRVZVTDJ0dUwwVlVSVEprUWs4MU4yZHBjVmd6V2xOcFJuUjZTSEEzZEdaallreHNSMWQyZDJaRGJsRldTbFZ5Wm1odmVuSlNSQXBVUlRkdFRqZ3djbVowZUdVNWFuRlpkRU5FZUROVk5sTnpZbE42VWxkSFVYTkpNelZwTlZGSlpqbENSMjVNVWtka1pYZG9VblEzZW5GVGF6UnZhVTlsQ2t4WGJGQXhZMHRGSzNZMFRFTkthVlJpWmpkaFJXeHFlVVZKTlVKcFlYWnBlVlJ5UndvdExTMHRMVVZPUkNCRFJWSlVTVVpKUTBGVVJTMHRMUzB0Q2c9PQogICAgc2VydmVyOiBodHRwczovLzEwLjIyMC42Mi42MDo2NDQzCiAgbmFtZToga3ViZXJuZXRlcwpjb250ZXh0czoKLSBjb250ZXh0OgogICAgY2x1c3Rlcjoga3ViZXJuZXRlcwogICAgdXNlcjoga3ViZXJuZXRlcy1hZG1pbgogIG5hbWU6IGt1YmVybmV0ZXMtYWRtaW5Aa3ViZXJuZXRlcwpjdXJyZW50LWNvbnRleHQ6IGt1YmVybmV0ZXMtYWRtaW5Aa3ViZXJuZXRlcwpraW5kOiBDb25maWcKcHJlZmVyZW5jZXM6IHt9CnVzZXJzOgotIG5hbWU6IGt1YmVybmV0ZXMtYWRtaW4KICB1c2VyOgogICAgY2xpZW50LWNlcnRpZmljYXRlLWRhdGE6IExTMHRMUzFDUlVkSlRpQkRSVkpVU1VaSlEwRlVSUzB0TFMwdENrMUpTVVJKVkVORFFXZHRaMEYzU1VKQlowbEpaalJQZWxwaFFsQXhSVWwzUkZGWlNrdHZXa2xvZG1OT1FWRkZURUpSUVhkR1ZFVlVUVUpGUjBFeFZVVUtRWGhOUzJFelZtbGFXRXAxV2xoU2JHTjZRV1ZHZHpCNVRXcEJlazFVWjNoTlZFVXpUV3BzWVVaM01IbE5la0Y2VFZSbmVFMVVSVE5OZWs1aFRVUlJlQXBHZWtGV1FtZE9Wa0pCYjFSRWJrNDFZek5TYkdKVWNIUlpXRTR3V2xoS2VrMVNhM2RHZDFsRVZsRlJSRVY0UW5Ka1YwcHNZMjAxYkdSSFZucE1WMFpyQ21KWGJIVk5TVWxDU1dwQlRrSm5hM0ZvYTJsSE9YY3dRa0ZSUlVaQlFVOURRVkU0UVUxSlNVSkRaMHREUVZGRlFYWklZekZ5VG1wdGFFSmtURWwzTVRZS01tbFJkaXRJUlVGbmJXUjJZbVp6VW5vMFNXbGhjMGRCWjBVNVJrSmpRU3N2Vm1WQ2NtWTNNMnhPYjJ0VkwzSmxNR0l2VTFKcVpHaENPRTU1U1ZFellRcGhXSE5yUjNnclVXdHJXbVJOWlVSd2JGUlpjMkozTURKWVlVaHhVbG92WlVock9EYzNMME4yY0daQlYwNXdaRlJaZVd3MVdVNVVjVXBZUkdOalVWWTBDbTB4T0hwaGMxTlFUalpTVmxwclIzRkdhV0Z3VUZSaWVVWTNjSE50TkRKNmVrRlliSEJIVFhGcldrc3ljVVJ2UVM5dVVHODBOMFF3TTFRMGFFNXVRbXNLVkZnd2JEQmlUMGRsT0VWb00xTlZURGRJZVZKS1JGUnNjbXQ0WWtSRU1HRndVRWhxTW5CbU9VZDVTelJqVTFSNVVUVm1XaXRxZVhkbWJuSXJWMnhJTlFvNVREaEJUVmxPT1ZJdmVWcGtaSFJaVVhWc2NqUllhVTVqVW01TU1FNWlRMDVyU2pWbWNYbEtUM281UTA5WmJsRjNlSFZyTkZRMFRYZzJUM2x4YkdvMENsbFZRM05DZDBsRVFWRkJRbTh4V1hkV1JFRlBRbWRPVmtoUk9FSkJaamhGUWtGTlEwSmhRWGRGZDFsRVZsSXdiRUpCZDNkRFoxbEpTM2RaUWtKUlZVZ0tRWGRKZDBSQldVUldVakJVUVZGSUwwSkJTWGRCUkVGbVFtZE9Wa2hUVFVWSFJFRlhaMEpVYm1KMFVYZFVhbUpRUXpoeVJIRkljSGRzVWs1MmJHUmpjQXByZWtGT1FtZHJjV2hyYVVjNWR6QkNRVkZ6UmtGQlQwTkJVVVZCY1cwMllrMHZhVkl2ZFVGMWNtSTJTMUZEV1dsdGVVSnVWVmd4VkdJd1FqVnRTRkIwQ2tadFREZHhZbWxEYzNjNGRIRXZlR2MzVmpRMWRUQnFiV3Q2ZVhwYWNERnRZM2RCUjA4NE9XTm1WVE5uYjJWcVQwbzJUR05yY1hsaE9FUklkbkkwYWxjS1FqRkNTaXR1V1ZwSllWRnJRaXR6TW1aSll6WmhTbTlXVmtaeGVVUkpOMFJvSzNCaVZVNUVjbXBIY0ZZcmR6WlJMMlozTkhCS1VqWm5VV3MwVVVSMFN3cGxhVkpsYTB3MWIySXdiVEJDZHpCNGMwVk9RM2xvVW05NlNVVlZaazlFVjJzM1owMHhUVXd6V1dGRFQwTlNWRzFtVkVwcU1HNUlWV0ZFUjNCT2FUTkdDbFZJYjNWRmJqSkpiRWs0UzBFMVZHOTFSRnBWVTJVclpYUnlRMlE0Y0U4ek1VSjFNQzgyVDJGdlVVWnBTa2hWY0M4NFoydGxjWEpFTkd0RFFraGFOalVLZW5oelRXazJTSEpuUTNOWFRGSXlWSGRyY0dkUWEwOUplamcxWWtrd01HNVJhMWxXZFd0c01DOUxTVzQ0WjBsUlZIYzlQUW90TFMwdExVVk9SQ0JEUlZKVVNVWkpRMEZVUlMwdExTMHRDZz09CiAgICBjbGllbnQta2V5LWRhdGE6IExTMHRMUzFDUlVkSlRpQlNVMEVnVUZKSlZrRlVSU0JMUlZrdExTMHRMUXBOU1VsRmNFRkpRa0ZCUzBOQlVVVkJka2hqTVhKT2FtMW9RbVJNU1hjeE5qSnBVWFlyU0VWQloyMWtkbUptYzFKNk5FbHBZWE5IUVdkRk9VWkNZMEVyQ2k5V1pVSnlaamN6YkU1dmExVXZjbVV3WWk5VFVtcGthRUk0VG5sSlVUTmhZVmh6YTBkNEsxRnJhMXBrVFdWRWNHeFVXWE5pZHpBeVdHRkljVkphTDJVS1NHczROemN2UTNad1prRlhUbkJrVkZsNWJEVlpUbFJ4U2xoRVkyTlJWalJ0TVRoNllYTlRVRTQyVWxaYWEwZHhSbWxoY0ZCVVlubEdOM0J6YlRReWVncDZRVmhzY0VkTmNXdGFTekp4Ukc5QkwyNVFielEzUkRBelZEUm9UbTVDYTFSWU1Hd3dZazlIWlRoRmFETlRWVXczU0hsU1NrUlViSEpyZUdKRVJEQmhDbkJRU0dveWNHWTVSM2xMTkdOVFZIbFJOV1phSzJwNWQyWnVjaXRYYkVnMU9VdzRRVTFaVGpsU0wzbGFaR1IwV1ZGMWJISTBXR2xPWTFKdVREQk9Za01LVG10S05XWnhlVXBQZWpsRFQxbHVVWGQ0ZFdzMFZEUk5lRFpQZVhGc2FqUlpWVU56UW5kSlJFRlJRVUpCYjBsQ1FVWlNSakZtYlVKVU5uQXpTa0ZFTndwclVtbHJTRGxOZFRkSVVtcFFhRGx0Y1dwTmJ6RkxlalU0TjFSelVGVm1lVU12YVV0MldrVktUbkp2V0hoVVJFMVBRVU5CYW5Nd1drUkZiRVpoZFRRckNqTktRbGxKVUVGRU9FVnBTVTFFYjFOblZVSlpXbWQzVDFVeVdWRTVZMjVIVkRkTmNqWlFhRVZ1Y2xwTWIyaE5kRWhZZERBeWVrdHBXV3RVTVhJMGVsY0tWRzVVYWxsQlJqUXZWRlkzVWxScGFGZHBXRzVwWW5VeWNYaENVMXBwUXlzcmEzb3piV2xUVVhKRlNrNDBkMXByVEhrdlpIWlBabUpaTW1aQ1JWSmhUd3BxWWk5UlEyTkxZV1pTYWxSbVprVTJPRmd6TTNGV09GbHJXRUpxWlZvdk1ucHVjRlZ1U21ONGJsWjFXSEYyWjJzek5qWlVMekUzTm1sRFRIUjBNVGt5Q21GUGNuaEJOR1phYldjeU0zaFFWR0puTVRodU9FYzNiVkpKVkhwT2RuQnNSa3B2TTJVclluTmlTM2hTTXpNMFNHaFNUVlJRZVM5bVpubFNhMGR3V0drS1JsQkljWEF4YTBObldVVkJOMVp0VldWc1UyNXVaRkUxT1VWUWVGUTRURTFaWlVwVVZVaDJSRVp0WkdoaFVWRnRRVVJxYWxCV1kzaFJkRlJYY0VGR1RRcExVVXhRVGxsck9ITkRkakIwWTI5aVZtZ3JVbmx6UzJkNVZWcDNWRWREVGxGb09YRjBOaTlVU0hJclNqa3JSRTl5U1hJMmQwSlpVelJYTldoRFRVNTBDa1UwTjBKQ2FXVkhWMFpFZVdGdWVEUjFlSGR1UkV4U1JHbDZaR1pWVTFkWFdGRmxaM05PVHpZNVdYQnNOQzlrWTI5bVpHSllSVEJEWjFsRlFYa3dXa3dLSzJweFkzWlhiSE5CWTFKVFVVOWlNR2N5YVZNdlpFSkxlV1JtUnpCbmJ6ZFZMMFpEU2s5blYxbFlMMHN4WkN0a1FWZHFlVkkxV0ZFMWQwdHljekE1Y3dwbksydFdaMU5XTkVsTlUwcEpaSFJLTkZjM1dETllhVkZaV1RRdkwwSm9WM1ZKUzBsaWRFWXlLMEk1Wmxrd1VVNURZbE5yTnlzNU5EaFpZbUZoVWxSbkNrdGxWRXN4YTFaVU1VVkxOMkk1VGtKRk5rcHFaR1pHY0daSWVYbERORkowV1ZKQlFVRTJUVU5uV1VWQk5VVlpkWEJyVkRZdlRFaGliREZGZEV0c1FXOEtOemdyVkRNMmJGbGFVbXBEZFVKVVZWVTBlR3BEVjBSMGMwOUJlRWMwVm1ZNFYxZFNWVzFWVDJGRlYzVlZjRlI1UnpZck4wMVhOV3MwTlVGTFpUTnhNUXBCVXpWclNHZDRUbTFhYjFGSlRWbHVTVUV4SzNkMlZ6TTNVR0ZUTDNKSGRVYzBlRVp0ZUhsNVpXZG9TVlJwUVhWdldUWm1RUzl1ZG5GR2NESkpkalZ4Q210cmFTdDRURXQxWTIwNVRVNWhaRE5uVWt3NE0wWlZRMmRaUlVGMldtOHpUMmhMTjNGdE1GQjNiVWxzVDNOYWVEUmlVMFZFZEhwbVRsZ3ZabmR2UTNFS2NpOVRSRGx5Y2tsVVZ6aFBaV2RzVjJkRU9ITmFXbk5ZVUV4TFowSjFUMXBYZW5wdmQzZHdOVVF3T1dsbVkwd3lSMkZFZWtadEwycGtRM1JyUVZSbFR3cG9Ra2N4VVc1Q09HOUtiR0YwZEU0NWRXTlVWMW8zY1dSMUswNUhReXRtWkRSNFZ6SkpUVU5RYmxwblZrUjNkMnRWYWxWUmQzRXhTRGhGWVRkS09GVkJDalZTTUhka2FrMURaMWxCYms5MFlrWmxZeXRRVEVRemRGTm9Uek41Ym14aGFGaHZXV0pKTXpoelJqVlNhVk5EY2tjNGMyZG5VVFJoUWtWU1VHUmhNMmtLUlhkb2FucFlPR1phY0dKdlIyZFBUVEJuUm1aeVlpc3hjaXMwYkhCUVIyWm5WSFJMYlhKaGVrUXpSbFpKTUdOS05YWllielk1Tkc1WFdESkdjMGMzUlFwb1MxbElPSFZLU20xc1JHRnNWVlY2TTNnclpVNDNWM2xwWkdWRlIzZFRSemxhVDJSdGNGRXJZMHRTYjI5ekx6Z3pPRlV2ZDNjOVBRb3RMUzB0TFVWT1JDQlNVMEVnVUZKSlZrRlVSU0JMUlZrdExTMHRMUW89
---
apiVersion: v1
kind: Service
metadata:
  name: rocky-ssh-service
  labels:
    name: rocky-ssh
spec:
  type: NodePort
  ports:
    - name: rocky-ssh
      port: 22
      targetPort: 22
      nodePort: 30022
  selector:
    name: rocky-ssh
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: rocky-ssh
spec:
  replicas: 1
  strategy:
    type: RollingUpdate
  selector:
    matchLabels:
      name: rocky-ssh
  template:
    metadata:
      labels:
        name: rocky-ssh
    spec:
      volumes:
        - name: ssh
          secret:
            secretName: rocky-ssh
            defaultMode: 384
        - name: kubectl
          secret:
            secretName: rocky-kubectl
            defaultMode: 384
      containers:
        - name: rocky-ssh
          image: sjwayrhz/rocky-8.4:kubectl
          imagePullPolicy: IfNotPresent
          volumeMounts:
            - name: ssh
              mountPath: "/root/.ssh/authorized_keys"
              subPath: authorized_keys
              readOnly: true
            - name: kubectl
              mountPath: "/root/.kube/config"
              subPath: config
              readOnly: true
          resources:
            requests:
              memory: "512Mi"
              cpu: "500m"
            limits:
              memory: "1Gi"
              cpu: "1000m"
          ports:
            - containerPort: 22