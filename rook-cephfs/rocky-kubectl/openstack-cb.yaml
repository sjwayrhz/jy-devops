apiVersion: v1
kind: Secret
metadata:
  name: rocky-ssh
type: Opaque
data:
  authorized_keys: c3NoLXJzYSBBQUFBQjNOemFDMXljMkVBQUFBREFRQUJBQUFCQVFDdG1yQmZPRkxGOHRVQnlaTU5iUmtoQ3FyTHhQc2NJMUlBdnYvd2pKdXN0REVzdm40VzBXeHg3VUlzU0doQmJSa0JFM3BNanlOSnlseXFsa0ZpeHQ5b25HVGRTVk1kTnVBeEhTVHFWN241QjRaWFhtdVNUR25sMkRTS1lnT1NsZUNwYWtBSzE1VEJDbFBtMWFCMGMzUmh2c2Q2aXlNZlREOU1LR1hFTml0cG9rVG9PMFhTSk1VL25qcUVraEpjd1hUR0hYenRwaXRxc1ZuWEkvNEJVWXlhNlpZc21LQVNGd2FQbXBqdmpySThWMmVWVFM5YmFqRGg3QXA4WFM5ZDk2TlFZcUNVMkl1dGFZZXFNNy8wUzlWL2FDR2szTStLNXVsVkVwd2I1YnUyZmpkMUdURzBXYURQZHhaMThEYlhCWkVZcDJ3TmdZcHRSeDhEL0FNMzloVFQ=
---
apiVersion: v1
kind: Secret
metadata:
  name: rocky-kubectl
type: Opaque
data:
  config: YXBpVmVyc2lvbjogdjEKY2x1c3RlcnM6Ci0gY2x1c3RlcjoKICAgIGNlcnRpZmljYXRlLWF1dGhvcml0eS1kYXRhOiBMUzB0TFMxQ1JVZEpUaUJEUlZKVVNVWkpRMEZVUlMwdExTMHRDazFKU1VNMWVrTkRRV01yWjBGM1NVSkJaMGxDUVVSQlRrSm5hM0ZvYTJsSE9YY3dRa0ZSYzBaQlJFRldUVkpOZDBWUldVUldVVkZFUlhkd2NtUlhTbXdLWTIwMWJHUkhWbnBOUWpSWVJGUkplRTFVUlhsUFZFRjNUVlJCTUU1V2IxaEVWRTE0VFZSRmVVNTZRWGROVkVFd1RsWnZkMFpVUlZSTlFrVkhRVEZWUlFwQmVFMUxZVE5XYVZwWVNuVmFXRkpzWTNwRFEwRlRTWGRFVVZsS1MyOWFTV2gyWTA1QlVVVkNRbEZCUkdkblJWQkJSRU5EUVZGdlEyZG5SVUpCVEdGcENsRTBXbUZHTDNKcVlVaGFVME01YldWUk0xbFVWeko1Y1VONlVWTlRRMmxtV1VFeWMyeFNOVXRSZDJRMWMxTTVMemxJZWl0WFJFazFOMnhpTWxWSEsxY0tNbmxXUTJSdVluSlJja3RGWTFWNU5rODRZVXhrVDFONmFHMVNLMkpIVlhaM2F6RnFSREIwYTBsUFJVTjNPVGQ2VFc1dk5GWnNiazk1ZDBwaFNGaGpTUW9yVlRaWlJuZFJabVp2WlZkWGFGbFVSMDl1YmxWRFNHODVRemQxWjJFMFZYUXhZemRsYTNObmVFSlhla3RTVXpWc1owdGFNMHRwWjJ0VEwxRkVWbTFRQ21sT1NEQndNMWt5VEZFMlp5ODROelJSY0dSemVqbEhPRmxhYVVsbWFFTXpObnBCUTNNMmFtWkpibXBHU0ZWVVZrWlFVbFZYWVhWYWFIVkJUelpEZFhNS2REWkxUV3hNTlZKaE1FZE1PR1JyWldwTE1XMXFXVWx0ZFU5bFNqRjZiVGx5VEVwQk1GaFZSM2xEVlV4b2FVUnFlbll2TTNkMVFUZGlWRkZIUzJFek9RcFhWRkJIVDFWNVIwMTRORFZDT0hoblYwTlZRMEYzUlVGQllVNURUVVZCZDBSbldVUldVakJRUVZGSUwwSkJVVVJCWjB0clRVRTRSMEV4VldSRmQwVkNDaTkzVVVaTlFVMUNRV1k0ZDBoUldVUldVakJQUWtKWlJVWkxTV0pQZFU1aFZsSnpiWE5YVkhrd1UxSTNWMFZRWWtsWGJHTk5RVEJIUTFOeFIxTkpZak1LUkZGRlFrTjNWVUZCTkVsQ1FWRkRZM1Y0VEZOR2RYSnlOVzg1YWpRdk5rOTBUV0YzTUZoRmJWSnpRbFk1YTB0Q2MwNTNUVVp1TDBGallWQnJPVEZYY0FvMFJsUllVM3BRUnpGQmIzbDBRemhwZW1ZdlNsQjBXamxwYzAxNVVrZFNNMGxoUWxSRWJYZEpjbGR5UjFSUVNVd3hXR1IwUTJwb1ZqaHBUR1pMY1V4d0NrMVRLMVJGVEdSM1FXeEZXa3BqZVRBM05YcFhaRTl3V1ZvM1ltTkNabXN4Y2taMU1ITldNMGxSTWpKMWRFbFRRMDVUTUZwTE4zbEVRak15UTJZclltRUtVa3BLYkZGamRYb3ZRMk13U1RaUk9GVjFjQzlHVkdaS1kwTXZSazlqTVcxTU5ETkpkVmczTW1aVWNuQmFiRmhITml0R2FEaERRVzltUjA1SlJtbE5kUXBsZGs5SlYwOVZiekpLYlVvd0t6STBZVTVzV0hjM2NUaFVNMEowUkRKU1VYTlJaMEpqVjAxUGJrbE9lbE5VZWt4a1FVcDJURFZUVjAwNGVIRmFRM2h1Q2l0b2RsbE1MM2xtWVdjMlVtbFlRM3BvTVdwd2IwSlZNM1JPYVVneFoweGhXRkZYTndvdExTMHRMVVZPUkNCRFJWSlVTVVpKUTBGVVJTMHRMUzB0Q2c9PQogICAgc2VydmVyOiBodHRwczovLzEwLjIyNS42My41MDo2NDQzCiAgbmFtZToga3ViZXJuZXRlcwpjb250ZXh0czoKLSBjb250ZXh0OgogICAgY2x1c3Rlcjoga3ViZXJuZXRlcwogICAgdXNlcjoga3ViZXJuZXRlcy1hZG1pbgogIG5hbWU6IGt1YmVybmV0ZXMtYWRtaW5Aa3ViZXJuZXRlcwpjdXJyZW50LWNvbnRleHQ6IGt1YmVybmV0ZXMtYWRtaW5Aa3ViZXJuZXRlcwpraW5kOiBDb25maWcKcHJlZmVyZW5jZXM6IHt9CnVzZXJzOgotIG5hbWU6IGt1YmVybmV0ZXMtYWRtaW4KICB1c2VyOgogICAgY2xpZW50LWNlcnRpZmljYXRlLWRhdGE6IExTMHRMUzFDUlVkSlRpQkRSVkpVU1VaSlEwRlVSUzB0TFMwdENrMUpTVVJKVkVORFFXZHRaMEYzU1VKQlowbEpTRmRVWmxjMU5FWldVVzkzUkZGWlNrdHZXa2xvZG1OT1FWRkZURUpSUVhkR1ZFVlVUVUpGUjBFeFZVVUtRWGhOUzJFelZtbGFXRXAxV2xoU2JHTjZRV1ZHZHpCNVRWUkZlRTFxYTNkTlJFVjNUa1JXWVVaM01IbE5ha1Y0VFdwcmQwMUVSWGRPUkdoaFRVUlJlQXBHZWtGV1FtZE9Wa0pCYjFSRWJrNDFZek5TYkdKVWNIUlpXRTR3V2xoS2VrMVNhM2RHZDFsRVZsRlJSRVY0UW5Ka1YwcHNZMjAxYkdSSFZucE1WMFpyQ21KWGJIVk5TVWxDU1dwQlRrSm5hM0ZvYTJsSE9YY3dRa0ZSUlVaQlFVOURRVkU0UVUxSlNVSkRaMHREUVZGRlFXOUZWRUpMYTJFME1WSnZXbWMzYVZJS1pYUnhaRGxqVldodk1rTmxlSFpMVW5Bd2NIVlNSV3REVEV0R1ZVcExTRWczUkdoMFlVeFdVRTFXUkZSNlJGcEhNeTl5ZUVveWNFMWliU3RHV2tjd2R3cERWa3RtWlVoaGIwbDRVR1JWTjJJcmQwRlVPSHBxWWtadVZqQkRlVUpYZVRFd1owaDFOMVZxTWxwbE1UZHRkVkphWXpoSFNsUkplREZDVVdaUVUxTXpDa1pRV25rM2FFcHdWa01yTDNrNVprWldiM2wwWWsxYWNTOWlValo1TDFKeE1pdFZXRzU2TlZWdk9VdDNRbUp5ZDNoT09YUkhUbTlxZVUxVVZUaDRURGNLTUU5d2FGUlpiRE40THk5SGFIazFWa2xSYVM4MmJHRkRWM2RKTUZoeFkwOHhNMUEwVVRsbmRWVXphMDl4ZVRrMVYyUjNhV05oZUhwalJtOVhkbThyYkFwWmRUQkhXbXhDY1ZNNGFrTk9Rakp3VFhSaGFIRlNkRWMwUnk5aFlURXpRVEp5ZW1kMVJYVXdTV2xMY3pnck9YUTBXa0ZQVTI5dFdXOVZlR0p3VEVKUENuaDRRa00zVVVsRVFWRkJRbTh4V1hkV1JFRlBRbWRPVmtoUk9FSkJaamhGUWtGTlEwSmhRWGRGZDFsRVZsSXdiRUpCZDNkRFoxbEpTM2RaUWtKUlZVZ0tRWGRKZDBSQldVUldVakJVUVZGSUwwSkJTWGRCUkVGbVFtZE9Wa2hUVFVWSFJFRlhaMEpUYVVkNmNtcFhiRlZpU25KR2F6aDBSV3RsTVdoRU1ubEdjQXBZUkVGT1FtZHJjV2hyYVVjNWR6QkNRVkZ6UmtGQlQwTkJVVVZCVUhKRVFXbFRZV2h4U0VrMVozY3pVbmw2V1ZoR1RtbGpabmhPUkdaS2Qzb3liQ3MwQ2tGeGNVUmxiek5vYmxWRVJGZElRM1pDZUc4MVdETm5hREZTT1ZObU5EVlBUak5sTVV0dmF6Qk9XbVZCTUZod04yMHlXbXRuTjBONmFWTXZZMWxaUjBFS1UwZHpVbEJITlZWVE0yaHdWMnBpWTJrek9WVmFSVmR3ZURsV1YzQXpNMkUzV1VOT1JEa3dZV3QxVDBSVWRGaEZTbE0xU3pjek1rc3hlRlpWY1dSdllncE9VRTUwUkZOTVVuVk9iemc1TmxGT1NuRjRiblJUZDJZMVRrVTNXbWxaTW1reksyZERZVlZvVTI5TmJXZFFkVWQwV0RGbFNVMVNSbWxKV0RoaVNsWkxDbGhVZDB0TVIySXZjVEkwVDBWRloyaEdhVVpQUXpVcmJYRXZNVkJHTkZOaVQwcFpOSGxrYW5SSVlUWldUeXQ1U2tkTlptdG5iMVE0ZUROV2VYUTVSSEFLYVRWUVFuaExWRFpXT1dZNVdHcFhUa2xwTm5CQk9YQmpRVmc1WlZNM1pYbzNhMHRPYjBscFVGbGhhR0ZYWkVsa2RWRTlQUW90TFMwdExVVk9SQ0JEUlZKVVNVWkpRMEZVUlMwdExTMHRDZz09CiAgICBjbGllbnQta2V5LWRhdGE6IExTMHRMUzFDUlVkSlRpQlNVMEVnVUZKSlZrRlVSU0JMUlZrdExTMHRMUXBOU1VsRmIyZEpRa0ZCUzBOQlVVVkJiMFZVUWt0cllUUXhVbTlhWnpkcFVtVjBjV1E1WTFWb2J6SkRaWGgyUzFKd01IQjFVa1ZyUTB4TFJsVktTMGhJQ2pkRWFIUmhURlpRVFZaRVZIcEVXa2N6TDNKNFNqSndUV0p0SzBaYVJ6QjNRMVpMWm1WSVlXOUplRkJrVlRkaUszZEJWRGg2YW1KR2JsWXdRM2xDVjNrS01UQm5TSFUzVldveVdtVXhOMjExVWxwak9FZEtWRWw0TVVKUlpsQlRVek5HVUZwNU4yaEtjRlpES3k5NU9XWkdWbTk1ZEdKTlduRXZZbEkyZVM5U2NRb3lLMVZZYm5vMVZXODVTM2RDWW5KM2VFNDVkRWRPYjJwNVRWUlZPSGhNTnpCUGNHaFVXV3d6ZUM4dlIyaDVOVlpKVVdrdk5teGhRMWQzU1RCWWNXTlBDakV6VURSUk9XZDFWVE5yVDNGNU9UVlhaSGRwWTJGNGVtTkdiMWQyYnl0c1dYVXdSMXBzUW5GVE9HcERUa0l5Y0UxMFlXaHhVblJITkVjdllXRXhNMEVLTW5KNlozVkZkVEJKYVV0ek9DczVkRFJhUVU5VGIyMVpiMVY0WW5CTVFrOTRlRUpETjFGSlJFRlJRVUpCYjBsQ1FVZG9aWFpuYWtKRE5tUkViWFpCVEFvMWVtNUNWM1pNZEd0Tk1YSnZOWEprTlhaeGVETjNUVGRLUmpWaFNsbHFRbXB2WlVnMk9FRjJjWE5ZY2pWRVNIUXJkRkJ6UVU1WWVGSktjalp3ZW5wVENsZHRSVWd6U0VFdmJscHNVMWN5Vld0SE9YbERiM1oyVERoWU9XTlVaVFYwUzNjeFJtcEVkWGxoUVd4Uk5HaHlSa1pIWm1adVVtNXRRMVZ6WVZjMGJXVUtLMnhrT1dONlZWVTJiVVF6ZHpScFJrZExPRmhhS3pCYVptZ3hMMUJuYjNwQlJYQlZMMU5qVkVNdmJWcFdlVXh3VUdaTWFWa3lXazVXZUVaSlZrNUJVd3A0WlZJMGR6UTVUV0Z0V0dselJUTnFjRlpPVjJGdmFpdEtLMmwyVTNSWlZrMVRiR0ZPTXpORVduVmFjM2h2Vmt4bU1XZHBOVUptVEZaWWFIazNVRkIzQ2tadWRrOVVkVVkwWTAwM1VHaDFOak55ZGsxRE9FZDBiRTFpVlZSNVUySTRaSEF4TlZWa05ISnlhRlZ3YTJadlkzRllSbUo0U214dE4wSXJWVEVyTW5nS1ZsSkVWMU5KVlVObldVVkJkMWRITkU1NVNEaHBkMUl2TjI5eU1UaFVRalI1TWxCM2VUTk9UMUJFUjNoVlFTOWthSFpoV1RGR1VFVkVPVVJaWkU4emRBcExUWFp5ZURjdlFXOVlXbXBVYjBVellVSTVaRFZSTDJoWldXUnlSMFIwUzBwa1ltVTRUVUZIZVhSRGMwOWhVazAyUlhoRlRFVnVaVzF1TjNscVdUTnFDbUZwUWlzM2VYSnFWV2QzVm10VlFXUnJNRGhCYVZsTFYwMURjWFZDTDBWWFNVSlJOVkJ3YjFjd2NFTjZTRFJWWm5Sb2NtdFpjMDFEWjFsRlFURkRiMm9LVERkVFZFRjBVakZPY2s1NFJrRklSVGRXVEROV2RHRlJNMjVoUzBST01teEhTekJPVUVoeFJFWmpiVk5tY0M5S1pVaElVR1F6UkhOVFRISm5jREV6YlFwdVVXUlVkV1ZQVVZod09EVjBkRE15ZDA1ek1GRmlPVWhWYjJGcU1rSjBZVXBpWlVoUlIyZHZjRXRwTjB4a1VITnpLMjV2Y2pCMFFUZGtNRzUxV2pCcENqRnFaWEp1ZUdOUWFFcHFkVmRVYzJVMlVsRXZNVkZ1YmxGalNWRlFPV2hUV2xaUFRrTkpPRU5uV1VGclZsSkVRVkYzUm05MVVVc3dUbUZXTlcxRGNrb0tkemxCYXpKV1oxVnNVakpGVG10aVpuRlpjMVJOVmpJdmRuWlJPRWM0ZFZsQk5rRmlNbXh1T1hVdmJIbGpXRXRSWmtoM2RXOXBiM1JKWWpCelVUQTVkUXBDYnpORFZ6aEhjVGN3VHpoWVRFMWhXR1ZJWkVaRkwyWmFVVkkzVG1aS1NrdFRkbEZGV2xjNUx6UnJOWHBtYzBGb2VrcEtielpDUjBWdE5qWkVWVU5xQ2pkRmFrcERlbWhKWmxkck5TOWpMekJpWkRoRk9IZExRbWRETDJadmFtcDBaMmMyZEdGb1YwSjNRVFZJY0N0Mk1WRkxTbnB2UWxSVGIzRjJjMmcwYUdRS05VSkxNV2RyWVRCVFZEUlNVME5FU21KWmMwTkVRVGhPVUVGM1NVRkVWMGR3WW01WlVUUmtWMWh0ZFVwQmJHcGhTRnA1U1ZWTmRYRllaVmw0Y0dSSVJRbzJPWFkwY0U1TmFYbzNiWHBxUlVjNGEybHBZbnB1WW1RMVJYcGFla1JoVTAxVlQyZHlTSFUzUm0weFJVUmxSME5HUkZVMlIzUnBXSFJhY25salVWVXdDa3RUY1RWQmIwZEJUVlJHY3pBemVHUjRkRXRHYmxFeVdXOVNlV0o1WWpBeVZXMXBhMFpuTUd3MmN6UTBNVmRzWTB3NGVsZDZZM0ZSWldwS1dIbzBNRkFLYUdKUWVTdE5ZMGh2Y2t4TVFURnlUMWg1V0ZjNGExUTRUWGxzUjBOWWFGSlFjREl4WlhwS05ta3JkM2RuU1RCc2JXRlpTbVZOUTNreFEwSm1NMHQxTWdwcldVVk5VbW94Y0hoU01uWXJURVpRUlhWbk1XVmpUVTkyVkRkT2NEaHRhM1Z0V0VKU05HOHdjbEpvUjBaQ1lXeFROalE5Q2kwdExTMHRSVTVFSUZKVFFTQlFVa2xXUVZSRklFdEZXUzB0TFMwdENnPT0=
---
apiVersion: v1
kind: Service
metadata:
  name: rocky-ssh-service
  labels:
    name: rocky-ssh
spec:
  type: NodePort
  ports:
    - name: rocky-ssh
      port: 22
      targetPort: 22
      nodePort: 30022
  selector:
    name: rocky-ssh
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: rocky-ssh
spec:
  replicas: 1
  strategy:
    type: RollingUpdate
  selector:
    matchLabels:
      name: rocky-ssh
  template:
    metadata:
      labels:
        name: rocky-ssh
    spec:
      volumes:
        - name: ssh
          secret:
            secretName: rocky-ssh
            defaultMode: 384
        - name: kubectl
          secret:
            secretName: rocky-kubectl
            defaultMode: 384
      containers:
        - name: rocky-ssh
          image: sjwayrhz/rocky-8.4:kubectl
          imagePullPolicy: IfNotPresent
          volumeMounts:
            - name: ssh
              mountPath: "/root/.ssh/authorized_keys"
              subPath: authorized_keys
              readOnly: true
            - name: kubectl
              mountPath: "/root/.kube/config"
              subPath: config
              readOnly: true
          resources:
            requests:
              memory: "512Mi"
              cpu: "500m"
            limits:
              memory: "1Gi"
              cpu: "1000m"
          ports:
            - containerPort: 22