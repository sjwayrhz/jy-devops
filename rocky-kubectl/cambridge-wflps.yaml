apiVersion: v1
kind: Secret
metadata:
  name: rocky-ssh
type: Opaque
data:
  authorized_keys: c3NoLXJzYSBBQUFBQjNOemFDMXljMkVBQUFBREFRQUJBQUFCQVFDdG1yQmZPRkxGOHRVQnlaTU5iUmtoQ3FyTHhQc2NJMUlBdnYvd2pKdXN0REVzdm40VzBXeHg3VUlzU0doQmJSa0JFM3BNanlOSnlseXFsa0ZpeHQ5b25HVGRTVk1kTnVBeEhTVHFWN241QjRaWFhtdVNUR25sMkRTS1lnT1NsZUNwYWtBSzE1VEJDbFBtMWFCMGMzUmh2c2Q2aXlNZlREOU1LR1hFTml0cG9rVG9PMFhTSk1VL25qcUVraEpjd1hUR0hYenRwaXRxc1ZuWEkvNEJVWXlhNlpZc21LQVNGd2FQbXBqdmpySThWMmVWVFM5YmFqRGg3QXA4WFM5ZDk2TlFZcUNVMkl1dGFZZXFNNy8wUzlWL2FDR2szTStLNXVsVkVwd2I1YnUyZmpkMUdURzBXYURQZHhaMThEYlhCWkVZcDJ3TmdZcHRSeDhEL0FNMzloVFQ=
---
apiVersion: v1
kind: Secret
metadata:
  name: rocky-kubectl
type: Opaque
data:
  config: YXBpVmVyc2lvbjogdjEKY2x1c3RlcnM6Ci0gY2x1c3RlcjoKICAgIGNlcnRpZmljYXRlLWF1dGhvcml0eS1kYXRhOiBMUzB0TFMxQ1JVZEpUaUJEUlZKVVNVWkpRMEZVUlMwdExTMHRDazFKU1VNMWVrTkRRV01yWjBGM1NVSkJaMGxDUVVSQlRrSm5hM0ZvYTJsSE9YY3dRa0ZSYzBaQlJFRldUVkpOZDBWUldVUldVVkZFUlhkd2NtUlhTbXdLWTIwMWJHUkhWbnBOUWpSWVJGUkplRTFVUlhsTmFrRTBUVlJuZDAxc2IxaEVWRTE0VFZSRmVVMUVRVFJOVkdkM1RXeHZkMFpVUlZSTlFrVkhRVEZWUlFwQmVFMUxZVE5XYVZwWVNuVmFXRkpzWTNwRFEwRlRTWGRFVVZsS1MyOWFTV2gyWTA1QlVVVkNRbEZCUkdkblJWQkJSRU5EUVZGdlEyZG5SVUpCVGxwb0NrZG1NSEkwVVhaVE9EZG1SR2xxYW0xNGNWVXlPSGwwUjB4bVUwOUROV05OUVRGR1JFWjFNR2RUTDJwU2JtWXpZVmRtYmtaV2RVNW1XRmxxWTJ0Q0wwWUtMM2xKZDBSV1JuaG1iekZrY0M5RE0xUnVTVWx1ZEd4Rk5uWlBXVXM1TVV0YWRXOHZObm95VFc0MGExWXlSRVoxVW1adVlWbFJaMlJWWW5sek5taG1ZUXBMVUdSVU4xWjNSMmx1UzIxSGNIcFViM2Q0VjFWWGVqWm1aV2MwWm5oTlowWnBka1JCWm14TlNHWnRPRnBzYkcxcE1FNTVSMjFFVmtaRVpGTXhkMUpSQ25GSFkwTlZZVW8wTUV3MFRFaEhjSEowVmt4WFYyUTBZM1EzZFhGS01uWTRhbGhHVG1ad1FXRktPWFJyTmtwa01sRTVhako2YzJaWWQydHlOR0poZDFNS1FrVm5kRmhTTW05Vk9IcE1aMlZTVUZFd2JtZHBNakJuUm1NMVRGcHhielZ1YUVsaVptdExWelJNTXpOcFNYZGtXakY1WTJKM2FWVnVTbUl6WnpOU2RBcGtiMlpRYldwQ2EySmtURlYwYmxkNlZrdHpRMEYzUlVGQllVNURUVVZCZDBSbldVUldVakJRUVZGSUwwSkJVVVJCWjB0clRVRTRSMEV4VldSRmQwVkNDaTkzVVVaTlFVMUNRV1k0ZDBoUldVUldVakJQUWtKWlJVWlBhbTA0TDBoWWFVRkJVVzk1UnpONFFtdHZjbGhoYzNCNE5EZE5RVEJIUTFOeFIxTkpZak1LUkZGRlFrTjNWVUZCTkVsQ1FWRkJVVUZ4TkhweFVtVkJZVEI2TXpFNFkyRmhjMU01T0RFMlNYaFVSMEpHWkZGQ2RrWlJNbXQ0Y1ZCeFdGSktWVUo1YXdwT01qTnRUQzkyUTJoc1YxRjZkMWxNTVd0dGRVWklTaTkyVUd0ekwyNTBUbFJqY1ZKeVluaFJiVUp6S3poSUwwWk9OVXhVYkc5dGMwTXhha2RrU0RGcUNpdHFiM1JwY0ZaQlR6Vk5LMU5wYjJ4TFV5OUhkMVZwU1c5VWVVbG9NMUpvSzBORFJHWkNaRzFpVVZSUVVHWnVRVXRNTURReGFVRlNZMWxIYWpkNlJtNEtPRWhIYmxKMVQwZFBjSFp5U0VKRFdpdERORTAyWkZOWGFHazBiVXR2Wm1GeVkyRjVWRXhHUWl0b1kwbEhUMUpXYWtKVlozcE9iR3BMU3pob2JIWXJUUXBMTTFBMGMxWlFaR1J6VmtoUEwyOVFla3A1YVRjck1tbGtWbmcxZUZoM1NEWm9XbmhVU2pkVWRrNUxOMU5wZUdKWVkyUjNNQzlaWjBwV0wwUXZObkZhQ21wSWNEWlNTMWhuYURWSFpsbzVibEI1VFVSNVZ5dDJkaTloVTBvNU1IUXJkMVJDVmdvdExTMHRMVVZPUkNCRFJWSlVTVVpKUTBGVVJTMHRMUzB0Q2c9PQogICAgc2VydmVyOiBodHRwczovLzEwLjIyMC42Mi4xMDo2NDQzCiAgbmFtZToga3ViZXJuZXRlcwpjb250ZXh0czoKLSBjb250ZXh0OgogICAgY2x1c3Rlcjoga3ViZXJuZXRlcwogICAgdXNlcjoga3ViZXJuZXRlcy1hZG1pbgogIG5hbWU6IGt1YmVybmV0ZXMtYWRtaW5Aa3ViZXJuZXRlcwpjdXJyZW50LWNvbnRleHQ6IGt1YmVybmV0ZXMtYWRtaW5Aa3ViZXJuZXRlcwpraW5kOiBDb25maWcKcHJlZmVyZW5jZXM6IHt9CnVzZXJzOgotIG5hbWU6IGt1YmVybmV0ZXMtYWRtaW4KICB1c2VyOgogICAgY2xpZW50LWNlcnRpZmljYXRlLWRhdGE6IExTMHRMUzFDUlVkSlRpQkRSVkpVU1VaSlEwRlVSUzB0TFMwdENrMUpTVVJKVkVORFFXZHRaMEYzU1VKQlowbEpZM2RPU1ZBMmFUaHhObTkzUkZGWlNrdHZXa2xvZG1OT1FWRkZURUpSUVhkR1ZFVlVUVUpGUjBFeFZVVUtRWGhOUzJFelZtbGFXRXAxV2xoU2JHTjZRV1ZHZHpCNVRWUkZlRTFxU1hkUFJFVTBUVVJLWVVaM01IcE5WRVY0VFdwQmQwOUVTVEJOUkd4aFRVUlJlQXBHZWtGV1FtZE9Wa0pCYjFSRWJrNDFZek5TYkdKVWNIUlpXRTR3V2xoS2VrMVNhM2RHZDFsRVZsRlJSRVY0UW5Ka1YwcHNZMjAxYkdSSFZucE1WMFpyQ21KWGJIVk5TVWxDU1dwQlRrSm5hM0ZvYTJsSE9YY3dRa0ZSUlVaQlFVOURRVkU0UVUxSlNVSkRaMHREUVZGRlFYaGxhblJ0YUd0aVoxQjFOM2hpWmxZS05FUXhVMHhMZDFwNU4zZFBVbEpPTXpoSllVZ3pkazkwZFhGR1NtVmFjazlHVFN0WFRrdEpRazQwTVZwRVFVcDFTbmQxYVd0U1YyUkdWRkJwYUVkTVZBcHJSbTFCWVZVeFdsWlRRMnRVTlM5Q1NtVTNWamRFWlhWUlJEZ3JhVlJoUkhBdkszQkpkM3BQWTNKelduRTRRbmMwVTJFNGQyZGpUM0F5YzI1R01XWk9Da1YwUms5QldGUTBjSFZGVG0wdlYySmpRekI0TWtOR1ZESnRla0ZvU1ZoUFVuUlRiWGM0ZEZsNWQxRlFRV2hHZFVKbFFXZ3ZXR3gwZVhnMFkyRTViMWtLUzJaSU5uRnRLelJqYzJaUmVHbEJTbXBpZGpobFVFbHJkQ3M0TkhsVFdXdEdUWGxLTmpGSmVraFdjMjlSZEVSVWRUVjZaSFU1ZFVneVdGZDVURlI0ZEFvMGRuWlFNMng0V2xwMVFucGxRVmQxVVhwb2FVTTFjM0Y1WkRGUmJXSlRjbU5QTUdSUGIyUjVZM2hFWTA1MlFVSnJUVzlLU0RWSFVVdzJVbUY2TDJacENrOXFUQzk2ZDBsRVFWRkJRbTh4V1hkV1JFRlBRbWRPVmtoUk9FSkJaamhGUWtGTlEwSmhRWGRGZDFsRVZsSXdiRUpCZDNkRFoxbEpTM2RaUWtKUlZVZ0tRWGRKZDBSQldVUldVakJVUVZGSUwwSkJTWGRCUkVGbVFtZE9Wa2hUVFVWSFJFRlhaMEpVYnpWMlVIZ3hOR2RCUlV0TmFIUTRVVnBMU3pFeWNrdGpaUXBQZWtGT1FtZHJjV2hyYVVjNWR6QkNRVkZ6UmtGQlQwTkJVVVZCY21ack9XZHZXV2RXV0ZsVkwzVjJPWGhLTTBwTGRFNTBUME56YWtrMmIwSjBiRlZtQ2xoclpUTldVbmR6YVRSc2VrTlZNbTE2UWpBME5WcG5halUxYlRoeGFHaG5kR1ZzWm1WMFdVcHNNRVJ6YUdrd1oxaG1aVkpSVVdsaGFXcHBLMHRrTTBrS09XVlZhbTQ0ZFVGT1lXNVBVV1ExVmpJMkwyWjVZbmxPTUZWWlJsbGhkMHBzY1V0bVEyWTVSSHA2VTJ4eFlYY3ZkRU5PVUU1alNtTlJWRXRUYVV0TlNncFJURzFPUWs1VFZYZ3pNbk5OWkRGRVdHeDNXWEF6Y21oSWNWTnNOM2xsWm5KMVVFOVhTUzg1YzJjdlRIWjFMMkZpUkc4clNWVTFWVFpxYzNwVGJ6Z3JDbXhvV0ZGQlYxSlVhMlZSYlZWNWExSnBTemwyVDFCb1NtbzNRVWQxWWpSRVJWSmxlbUZEVm5SQkwxQnhiM0JwZDFKaWVDOTJURkZqUjJOd2JYSldRVlFLTDNSdVVHZE1Uall3Y2pCdGVERkNTVTQxY0Vaa056WnRZMFJXZGxoWGRWUlJPV3h5V0ZoTFNYVk1RVmQ0VVRWUlRuYzlQUW90TFMwdExVVk9SQ0JEUlZKVVNVWkpRMEZVUlMwdExTMHRDZz09CiAgICBjbGllbnQta2V5LWRhdGE6IExTMHRMUzFDUlVkSlRpQlNVMEVnVUZKSlZrRlVSU0JMUlZrdExTMHRMUXBOU1VsRmIzZEpRa0ZCUzBOQlVVVkJlR1ZxZEcxb2EySm5VSFUzZUdKbVZqUkVNVk5NUzNkYWVUZDNUMUpTVGpNNFNXRklNM1pQZEhWeFJrcGxXbkpQQ2taTksxZE9TMGxDVGpReFdrUkJTblZLZDNWcGExSlhaRVpVVUdsb1IweFVhMFp0UVdGVk1WcFdVME5yVkRVdlFrcGxOMVkzUkdWMVVVUTRLMmxVWVVRS2NDOHJjRWwzZWs5amNuTmFjVGhDZHpSVFlUaDNaMk5QY0RKemJrWXhaazVGZEVaUFFWaFVOSEIxUlU1dEwxZGlZME13ZURKRFJsUXliWHBCYUVsWVR3cFNkRk50ZHpoMFdYbDNVVkJCYUVaMVFtVkJhQzlZYkhSNWVEUmpZVGx2V1V0bVNEWnhiU3MwWTNObVVYaHBRVXBxWW5ZNFpWQkphM1FyT0RSNVUxbHJDa1pOZVVvMk1VbDZTRlp6YjFGMFJGUjFOWHBrZFRsMVNESllWM2xNVkhoME5IWjJVRE5zZUZwYWRVSjZaVUZYZFZGNmFHbEROWE54ZVdReFVXMWlVM0lLWTA4d1pFOXZaSGxqZUVSalRuWkJRbXROYjBwSU5VZFJURFpTWVhvdlptbFBha3d2ZW5kSlJFRlJRVUpCYjBsQ1FWRkRTVlZKZEROWVJuWktWalZ3V2dvNFQyeHlZbXhGZGxjNGNsbDJWWEpITkZWWU0yTllTV05oY0V3MmRsTlRlV3RoU0c5VE5rMVdNVnBCY0VKNk5sTlBkM0JNT0c5UGFXdDBVMFJUYURFekNrOWxjVzEyYWpkdlUwNUxSRUU1ZVc5NU1IaHhTMFIwU1ZoSlJ6QXhkSEp1THpWb2JrZHVNRkpIZWpCSVdWUXJjRkZRT1NzeFVVOXRWVTQwVkVOdllpc0tWMUZrZWsxd09HSXJZMnhoYVVORGNtb3hkbXQzTDNoVk9WZ3JaMHhhYVhGRU9FeGlTVEpDZGpSdlFUZE9aRVU1Y0VKeFpqUmphQ3R5UTJOV2VHRnRjUXBvY2t3cmIxbE1USHBJWVRCcFVEWm9SekkxT1ZOelUxSlFRWFZDV1V0dE9IVlpWVlpWZUdGcWNHa3pOSEF6S3k5RFowdEdNVGRtZUZGR2VsaEJRbWR6Q201VVEySlhORkV3U1hKdVJsZG9PVkpYWldzMFEzbFVTbmRVTUZoRlZsaDRRVUpOTlV0cFNHZFZSVkZwV0RCemJXTTFNRWd5Wlhod2VWbDJiMEpwUVU0S1dXYzBhR0ZwUlVKQmIwZENRVTAyTlZOVVFuaE5WM1o1Y0hWYWRrcFBURzlQY2s0eVFqRmFSVzQxWlVrNVZ6WmlRWFF6VUVoUU5DdEJWSFV2VUhkd1V3cGFObE5LVmtWNlNtbzViMjVuTVVsNWRFUndkRGN4TW1KVE1YY3ZXRmRPZG5aNFlrc3haWGd3V0dwdlVrazFhVEZhV1d0dFpTOVpVRkoyYkV0SFJYWnpDbGhxWkRsMlRubEViV0ZhWlRCbU5GQktSWFl6U21kcVVEQm5TbmMyYlZGT1kxbDNkVTB5TTFkRlVGRnhWelZJVm1ZclV6Z3JURTEyUVc5SFFrRlFWVllLZWsxWkswbHVhbXBKZW1sWU0wdGlWV0ZyVlRKaE5YaG5VRlkxYUZSU1pIWnVSaTlsVWtKRU15OXRhVGR1UzBWYWQzb3lSWFk1THpkUVZFb3lPR1k0YkFwNU5uRTJPRWMzVUU0ek1VdGpTbXRUZW1SelVrdEtaRnAxWm14eWMxWkJhV2xWU1hsQlkxVnhOVlYxVUU1S2RVcGlTVGhzYWxOVGFtWlNZa0l5U1hjekNsSnhWUzlhYzIxWFowWlNXRW96VmpWelZVUk9ObkpwVkU0MmNuRmlOM2RaYlhWbE1qYzVWbWhCYjBkQlZqVjRhRXd4TWxwdk0xWkpWa3h5Wml0RFlWSUtNR3ROUVZsM2FHTldjakprZG5NeVJsUnViMkpuU1dwSmRuZHBWR05CTVhscVYwbERWSHBVVW1WYVVuSmlSMlVyZVVaRFZrNUxaUzlNV1RWU1VuWlplUXBHZW1aS2NVSmxPVmswUTIxQ1J6bEZXUzlpYVdKSGMxaEhhMjVVZFVWSGNIZEllbE5yVDFwYVRsSkNWV3RSWW1KNlJFbHVaRmMyVjFFMlExWlNaV2RKQ25GdE9XVk1iblZrTTJNd2FERTVSMVJFVmpoc1V6bE5RMmRaUVdkTFJEaGFSamxuUVVWd1ZuaG1TVTlKU2tWRVdsZG1NbVZ3UVZsS1ZubDZPVlZVYVhNS1dEUmhRWG96YkVSR2NreEVaRXBVYjJkdU1rZHFkbTFHYjBwUE5rUmhVaXRtTURkRGVUQXJWbXRsYm1GUE9YaHJlbEZwVG1Fd2JEWnFORmhTV2s5aGNncHNPVWxvYnpkSk5GTnpOekZTV0M5SUwwZzFZbVV4VVZSWk1WaGtaQzlqSzBGWFlXdE9jVzlhTlhWSFdHbFhUVmhvU3pCNWEwdGFlVTQxV2pOclMySnhDbXhzWXpkdlVVdENaMFZ3YTNwdk5FTlRlR2RLTTNaUVQzaEtjMFF3U0hWa2F5dEVNSHBXYkd4aU1FMXJZa2hNVUVwaFoxTm9hVGhQYkhrNEsyUlRNbFlLZDJsVVpXNW1TMFJoSzJKM1VXSlRhM2cyVlVkQmNtVmxabEZVYlc5NldsZGFVVFJMTHl0blVGaEZUbWhMT1VOWFdUUmFRVlpOZUdkMFlrczBSRFIxYlFwVlJISkdNbXhHTW1SclZqWTBZMGRuWWpSWldYUnhNakowY21OUUx6WlRla2MwTXpOMlluQTBWR0V5T0RGSVZWWmlXamhRQ2kwdExTMHRSVTVFSUZKVFFTQlFVa2xXUVZSRklFdEZXUzB0TFMwdENnPT0=
---
apiVersion: v1
kind: Service
metadata:
  name: rocky-ssh-service
  labels:
    name: rocky-ssh
spec:
  type: NodePort
  ports:
    - name: rocky-ssh
      port: 22
      targetPort: 22
      nodePort: 30022
  selector:
    name: rocky-ssh
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: rocky-ssh
spec:
  replicas: 1
  strategy:
    type: RollingUpdate
  selector:
    matchLabels:
      name: rocky-ssh
  template:
    metadata:
      labels:
        name: rocky-ssh
    spec:
      volumes:
        - name: ssh
          secret:
            secretName: rocky-ssh
            defaultMode: 384
        - name: kubectl
          secret:
            secretName: rocky-kubectl
            defaultMode: 384
      containers:
        - name: rocky-ssh
          image: sjwayrhz/rocky-8.4:kubectl
          imagePullPolicy: IfNotPresent
          volumeMounts:
            - name: ssh
              mountPath: "/root/.ssh/authorized_keys"
              subPath: authorized_keys
              readOnly: true
            - name: kubectl
              mountPath: "/root/.kube/config"
              subPath: config
              readOnly: true
          resources:
            requests:
              memory: "512Mi"
              cpu: "500m"
            limits:
              memory: "1Gi"
              cpu: "1000m"
          ports:
            - containerPort: 22